<!DOCTYPE html>
<html lang="en"><head>
<script src="slides-1-2_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides-1-2_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides-1-2_files/libs/quarto-html/popper.min.js"></script>
<script src="slides-1-2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides-1-2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides-1-2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides-1-2_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="slides-1-2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<title>slides-1-2</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="slides-1-2_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="slides-1-2_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="slides-1-2_files/libs/revealjs/dist/theme/quarto.css">
<link href="slides-1-2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="slides-1-2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="slides-1-2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="slides-1-2_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="slides-1-2_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="slides-1-2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2"><h1>
Lecture 1.2: Conditional models for correlated data
</h1>
<h2>
PHS 651: Advanced regression methods
</h2>
<hr>
<h3>
Mary Ryan Baumann, PhD
</h3>
<h3>
September 11, 2025
</h3>
<p><br></p>
<div style="font-size: 75%;">
<p><strong>Recording disclosure</strong></p>
<p><em>This class is being conducted in person, as well as over <span class="alert">Zoom</span>. As the instructor, I will be <span class="alert">recording</span> this session. I have disabled the recording feature for others so that no one else will be able to record this session. I will be posting this session to the course’s website.</em></p>
<p><em>If you have privacy concerns and do not wish to appear in the recording, you may turn video off (click “stop video”) so that Zoom does not record you.</em></p>
<p><em>The chat box is always open for discussion and questions to the entire class. You may also send messages privately to the instructor. Please note that Zoom saves all chat transcripts.</em></p>
</div>
<div class="absolute" style="left: 260px; bottom: 50px; width: 1500px; ">
<p>Slides found at: <a href="https://maryryan.github.io/PHS-651-slides/F25/lec-1-2/slides-1-2" class="uri">https://maryryan.github.io/PHS-651-slides/F25/lec-1-2/slides-1-2</a></p>
</div>
<div class="absolute" style="left: 100px; bottom: 0px; width: 150px; ">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-1-2_files/figure-revealjs/qr%20code-1.png" width="192"></p>
</div>
</div>
</div>
</section><section id="recap-correlatedclustered-data" class="slide level2"><h2>Recap: correlated/clustered data</h2>
<p>What do we mean by correlated data or data that is clustered?</p>
<ul>
<li><p><u>Independent data</u>: data where each observation of a variable are not meaningfully correlated with other observations of the same variable</p></li>
<li>
<p><u>Clustered/Correlated data</u>: data where each observation of a variable has some kind of relationship to another set of observations of that variable</p>
<ul>
<li><p>AKA: nested/multilevel/hierarchical data</p></li>
<li><p>Might expect measurements on <span class="alert">units within a cluster are more similar</span> than measurements on units in different clusters</p></li>
</ul>
</li>
</ul></section><section id="recap-correlatedclustered-data-1" class="slide level2"><h2>Recap: correlated/clustered data</h2>
<p><span class="alert">Is it a clustering variable or is it an exposure/adjustment variable?</span></p>
<ul>
<li>
<p>Clusters tend to be physical/structural (geography, time, a body/being, etc) or hierarchical (social/family hierarchy, institutional hierarchy, etc)</p>
<ul>
<li><p>Often no obvious reference group for cluster</p></li>
<li><p>Often many, many clusters in population (though we may not have data on all of them)</p></li>
</ul>
</li>
<li>
<p>Exposure/adjustment variables tend to have a <span class="alert">limited</span> number of groups</p>
<ul>
<li><p>e.g., diagnosis groups</p></li>
<li><p>Many groups means fewer degrees of freedom to spend on estimating coefficients</p></li>
</ul>
</li>
<li><p>This boundary can sometimes be fuzzy! See Clark &amp; Linzer (2014) or McNeish &amp; Kelley (2019) for more discussion</p></li>
</ul></section><section id="recap-correlatedclustered-data-2" class="slide level2"><h2>Recap: correlated/clustered data</h2>
<p>The ICC is a way to measure the “clustered-ness” of the outcome</p>
<p><span class="math display">\[\text{ICC} = \frac{\text{variation in cluster means}}{\text{total variation}} = \frac{\text{variation in cluster means}}{\text{variation in cluster means } + \text{individual-level variation}}\]</span></p>
<div class="fragment">
<p>Clustering may impact analysis in several ways</p>
<ul>
<li><p>Groups/clusters may not be the same size</p></li>
<li><p>May affect variance/break the homoskedasticity assumption of OLS</p></li>
<li><p>May impact average outcome/exposure</p></li>
<li><p>Reduces the amount of information we get from each individual data point</p></li>
</ul>
</div>
</section><section id="recap-correlatedclustered-data-3" class="slide level2"><h2>Recap: correlated/clustered data</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><span class="alert">How do we account for this clustering in analysis?</span></p>
<div class="fragment">
<ul>
<li><p>Could fit <span class="alert">separate regressions</span> for each group… no “global” estimate of exposure effect</p></li>
<li><p>Could <span class="alert">add group as covariate</span> in model… violates parameters vs data size assumptions</p></li>
<li><p>Could do <span class="alert">cluster-level model</span>… we lose a lot of individual-level information</p></li>
<li><p>… Something else?</p></li>
</ul>
</div>
</div><div class="column" style="width:40%;">
<div class="fragment">
<p><span class="alert">Some new approaches</span></p>
<p>Two main “classes”:</p>
<ul>
<li><p>“Conditional” models (today’s focus)</p></li>
<li><p>“Marginal” models (we’ll get to these later)</p></li>
</ul>
</div>
</div>
</div>
</section><section id="conditional-models" class="slide level2"><h2>Conditional models</h2>
<p>Basic idea: some clusters will <span class="alert">randomly</span> having higher/lower means than other</p>
<ul>
<li><p>This means we might assume to have one population-level mean <span class="math inline">\(\beta_0\)</span></p></li>
<li>
<p>And that each cluster <span class="math inline">\(i\)</span> will have a <span class="alert">cluster-specific mean</span> a little bit above/below this: <span class="math inline">\(\beta_0 \pm b_{0i}\)</span></p>
<ul>
<li>Can think of <span class="math inline">\(b_{0i}\)</span> as the cluster-specific deviation – we’ll add this to our regression model</li>
</ul>
</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="hoffman-cluster-means.png"></p>
<figcaption>Figure via Lesa Hoffman’s F23 PSQF 6272 lecture slides: <a href="https://www.lesahoffman.com/PSQF6272/PSQF6272_Lecture2_Empty_Level2Pred.pdf" class="uri">https://www.lesahoffman.com/PSQF6272/PSQF6272_Lecture2_Empty_Level2Pred.pdf</a> – link may be broken as Lesa is updating her slides</figcaption></figure>
</div>
</section><section id="conditional-models-1" class="slide level2"><h2>Conditional models</h2>
<p>Basic idea: some clusters will <span class="alert">randomly</span> having higher/lower means than other</p>
<ul>
<li><p>This means we might assume to have one population-level mean <span class="math inline">\(\beta_0\)</span></p></li>
<li>
<p>And that each cluster <span class="math inline">\(i\)</span> will have a <span class="alert">cluster-specific mean</span> a little bit above/below this: <span class="math inline">\(\beta_0 \pm b_{0i}\)</span></p>
<ul>
<li>Can think of <span class="math inline">\(b_{0i}\)</span> as the cluster-specific deviation – we’ll add this to our regression model</li>
</ul>
</li>
</ul>
<p>Model is <span class="alert">conditional</span> because the interpretation of <span class="math inline">\(\beta_1\)</span> assumes we’re comparing individuals <em>in the same cluster</em> (conditional on group membership/that cluster-specific bump)</p>
<ul>
<li><p>Just like how interpretation of <span class="math inline">\(\beta_1\)</span> assumes we’re comparing individuals who have the same value for all other covariates</p></li>
<li><p>We’ll dig into this more later</p></li>
</ul>
<div class="fragment">
<p>We tried this (somewhat informally) last week by adding cluster membership as a covariate</p>
<ul>
<li>Ran into issues around # parameters increasing with data size</li>
</ul>
</div>
<div class="fragment">
<p>We can fix some of those issues by using a <span class="alert">linear mixed effects</span> model framework</p>
</div>
</section><section id="the-linear-mixed-effects-model" class="slide level2"><h2>The linear mixed effects model</h2>
<p>Say we have <span class="math inline">\(m\)</span> clusters that each have <span class="math inline">\(n_i\)</span> individuals, which can vary from cluster to cluster</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:55%;">
<p>The linear mixed effects (LME) model takes the form:</p>
<p><span class="math display">\[Y_{ij} = \beta_0 + U_{ij}\beta_1 + Z_ib_{0i}+\epsilon_{ij}\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_{ij}\)</span> is the response/outcome observation for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\beta_0\)</span> is the population-level (<span class="alert">fixed effect</span>) intercept</p></li>
<li><p><span class="math inline">\(U_{ij}\)</span> is the exposure variable for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\beta_1\)</span> is the population-averaged (fixed) effect of exposure on the outcome</p></li>
<li><p><span class="math inline">\(Z_i\)</span> is the random effects indicator for cluster <span class="math inline">\(i\)</span> (sometimes we omit this and just have <span class="math inline">\(b_{0i}\)</span> on its own)</p></li>
<li><p><span class="math inline">\(b_{0i}\)</span> is the <span class="alert">random intercept</span> for cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span> is the random error term for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
</ul>
</div><div class="column" style="width:45%;">
<div class="fragment">
<p>Or in matrix/vector notation:</p>
<p><span class="math display">\[\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<ul>
<li><p><span class="math inline">\(\vec{Y}_i\)</span> is the response vector for cluster <span class="math inline">\(i\)</span> (dimensions: <span class="math inline">\(n_i \text{ individuals} \times 1 \text{ variable}\)</span>)</p></li>
<li><p><span class="math inline">\(\boldsymbol{X}_i\)</span> is the <span class="alert">fixed effects</span> design matrix for cluster <span class="math inline">\(i\)</span> (dimensions: <span class="math inline">\(n_i \times p\)</span>)</p></li>
<li><p><span class="math inline">\(\vec{\beta}\)</span> is the fixed effects parameter vector (dimensions: <span class="math inline">\(p \times 1\)</span>)</p></li>
<li><p><span class="math inline">\(\vec{Z}_i\)</span> is the <span class="alert">random effects</span> vector for cluster <span class="math inline">\(i\)</span> (dimensions: <span class="math inline">\(n_i \times 1\)</span>)</p></li>
<li><p><span class="math inline">\(\vec{\epsilon}_i\)</span> is the vector of error terms (dimensions: <span class="math inline">\(n_i \times 1\)</span>)</p></li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="interpreting-lmes" class="slide level2"><h2>Interpreting LMEs</h2>
<p>Consider a simple LME with 1 exposure variable <span class="math inline">\(U\)</span>: <span class="math display">\[Y_{ij} = \beta_0 + U_{ij}\beta_1 + Z_ib_{0i} + \epsilon_{ij}\]</span></p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span>: the (sample) population-level mean in <span class="math inline">\(Y\)</span> when <span class="math inline">\(u=0\)</span></p></li>
<li><p><span class="math inline">\(\beta_0 + b_{0i}\)</span>: the mean in <span class="math inline">\(Y\)</span> for cluster <span class="math inline">\(i\)</span> when <span class="math inline">\(u=0\)</span></p></li>
<li><p><span class="math inline">\(\beta_1\)</span>: the change in <span class="math inline">\(Y\)</span> for increasing <span class="math inline">\(U\)</span> by one unit, comparing 2 individuals <span class="alert">in the same cluster</span></p></li>
</ul>
<div class="fragment">
<p>We can get (potentially) 2 types of interpretations out of this model</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<p>Conditional mean: <span class="math display">\[E[Y_{ij}|\boldsymbol{X}_i, b_{0i}] = \boldsymbol{X}_i\vec{\beta} + b_{0i}\]</span></p>
<ul>
<li>Mean outcome for an individual cluster</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>Marginal mean: <span class="math display">\[E[Y_{ij}|\boldsymbol{X}_i] = \boldsymbol{X}_i\vec{\beta}\]</span></p>
<ul>
<li>Mean outcome averaged over the entire sample (weighted by cluster size)</li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="breaking-down-lmes" class="slide level2"><h2>Breaking down LMEs</h2>
<p>Can also represent an LME model as:</p>
<p><span class="math display">\[\vec{Y}_i = \color{green}{\boldsymbol{X}_i\vec{\beta}} + \color{blue}{\vec{\xi}_i}\]</span></p>
<ul>
<li>Allows us to break down an LME into 2 main components:</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<ol type="1">
<li>Mean response (as function of <span class="alert">fixed</span> covariates)</li>
</ol>
<p><span class="math display">\[\color{green}{\boldsymbol{X}_i\vec{\beta}}\]</span></p>
<ul>
<li><p>Think of this as a function of the variables we need to <u>isolate the causal effect</u> of our exposure of interest</p></li>
<li><p>Usually variables that we care about for testing hypotheses</p></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<ol start="2" type="1">
<li>Systematic variation (of the response/outcome) <span class="math display">\[\color{blue}{\vec{\xi}_i} = \color{red}{\vec{Z}_ib_{0i}}+\color{BlueViolet}{\vec{\epsilon}_i}\]</span> made up of:
<ol type="i">
<li>
<p>Random effects</p>
<ul>
<li>Random between-cluster variation: <span class="math inline">\(\color{red}{\vec{Z}_i b_{0i}}\)</span>
</li>
</ul>
</li>
<li><p>Within-cluster variation: <span class="math inline">\(\color{BlueViolet}{\vec{\epsilon}_i}\)</span></p></li>
</ol>
<ul>
<li>The systematic variation is what we’re <span class="alert">making assumptions about</span>
</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
</section><section id="systematic-variation" class="slide level2 smaller"><h2>Systematic variation</h2>
<!-- $$\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i$$ -->
<p><span class="math display">\[\vec{\xi}_i = \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>We typically assume random intercepts follow a distribution with a common variance:</p>
<p><span class="math display">\[b_{0i} \sim N(0, \sigma^2_b)\]</span></p>
<ul>
<li>Instead of estimating all the cluster-level effects separately, we assume they come from a <span class="alert">common distribution</span> and borrow information between clusters to come up with variance estimates</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>This is similar to how we’ve assumed individual-level errors follow a distribution:</p>
<p><span class="math display">\[\vec{\epsilon}_i \sim N(\vec{0}, \sigma^2_\epsilon \boldsymbol{I})\]</span></p>
<ul>
<li>
<p><span class="math inline">\(\sigma^2_\epsilon \boldsymbol{I}\)</span> is the covariance matrix of the individual-level errors: <span class="math inline">\(Cov[\epsilon_{ij}, \epsilon_{ik}] = \sigma^2_\epsilon \boldsymbol{I}\)</span></p>
<ul>
<li>
<p>Assumes all observations in cluster <span class="math inline">\(i\)</span> are <em>conditionally independent</em> given <span class="math inline">\(b_{0i}\)</span></p>
<ul>
<li>Given cluster membership, all members of cluster are independent</li>
</ul>
</li>
<li><p>Also known as an <span class="alert">independence model</span> of within-cluster variation</p></li>
<li><p>Let’s call this <span class="math inline">\(\boldsymbol{R}_i\)</span> <span class="math inline">\(\rightarrow\)</span> we’ll look at other forms of <span class="math inline">\(\boldsymbol{R}_i\)</span> later in the term</p></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="fragment absolute" style="top: 50px; right: 100px; width: 30%; ">
<p>Also assume (for now) that <span class="math inline">\(b_{0i}\)</span> and <span class="math inline">\(\vec{\epsilon}_i\)</span> are <em>independent</em> (<span class="math inline">\(b_{0i}\perp \vec{\epsilon}_i\)</span>)</p>
</div>
</section><section id="the-linear-mixed-effects-model-cont." class="slide level2"><h2>The linear mixed effects model (cont.)</h2>
<p>What’s “mixed” about this model?</p>
<p><span class="math display">\[\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<ul>
<li>Named because it uses <span class="alert">fixed effects</span> (effects for covariates <span class="math inline">\(\vec{\beta}\)</span>) as well as <span class="alert">random effects</span> (cluster-specific intercepts <span class="math inline">\(b_{0i}\)</span>)</li>
</ul>
<div class="fragment">
<p>How is this different from adding groups as covariates?</p>
<ul>
<li>By estimating a global <span class="math inline">\(\sigma^2_b\)</span>, this allows clusters with fewer observations to be more influenced by the rest of the data (“borrow” information), and clusters with more observations to be less influenced</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>“… we can learn about one cluster’s coefficients by understanding the variability in coefficients across the population. <span class="alert">When there is little variability, we should rely on the population average coefficients to estimate those for a cluster. When there’s substantial variation, we must rely more heavily on the data from each cluster in estimating its own coefficients</span>.” (Analysis of Longitudinal Data [Diggle et al] pg. 173)</li>
</ul>
<!-- What's "conditional" about this model? --><!-- - Because the mean of the outcome variable is [conditional]{.alert} on both the fixed effects (always true in regressions) *and* the random effects: --><!-- $$E[\vec{Y}_i|\boldsymbol{X}_i,\vec{b}_{0i}] = \boldsymbol{X}_i\vec{\beta}$$ -->
</div>
</section><section id="breaking-down-systematic-variation" class="slide level2 smaller"><h2>Breaking down systematic variation</h2>
<p>Random effects: <span class="math display">\[b_{0i} \sim N(0, \sigma^2_b)\]</span></p>
<ul>
<li>
<p>Assumes that <span class="alert">clusters</span> are <em>randomly</em> varying around the population mean response: <span class="math inline">\(E[b_{0i}]=0\)</span></p>
<ul>
<li>If you added groups as covariates instead, those would assume nothing about this</li>
</ul>
</li>
<li><p>The typical cluster-to-cluster deviation in the overall level of the response is <span class="math inline">\(\sqrt{\sigma^2_b}\)</span></p></li>
</ul>
<div class="fragment">
<p>Within-cluster variation: <span class="math display">\[\vec{\epsilon}_i \sim N(0, \boldsymbol{R}_i)\]</span></p>
<ul>
<li><p>Assumes that <span class="alert">cluster members</span> are <em>randomly</em> varying around the cluster-specific mean response: <span class="math inline">\(E[\vec{\epsilon}_i]=0\)</span></p></li>
<li><p>The typical member-to-member deviation in the cluster-specific level of the response is <span class="math inline">\(\sqrt{\sigma^2_\epsilon}\)</span></p></li>
</ul>
</div>
</section><section id="variancecovariance-of-the-outcome" class="slide level2"><h2>Variance/covariance of the outcome</h2>
<p><span class="math display">\[\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<p>Then the variance of a single outcome measure is: <span class="math display">\[\begin{align*}Var[Y_{ij}] &amp;= Var[\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\epsilon_{ij}]\\
&amp;= Var[\vec{Z}_ib_{0i}+\epsilon_{ij}]\\
&amp;= \sigma^2_b + \sigma^2_{\epsilon}\end{align*}\]</span></p>
<div class="alert fragment absolute" style="top: 450px; right: 450px; ">
<p>(total variation!)</p>
</div>
<div class="fragment">
<p>And the covariance between 2 outcome measures in the same cluster is: <span class="math display">\[\begin{align*}Cov[Y_{ij}, Y_{ik}] &amp;= Cov[\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\epsilon_{ij}, \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\epsilon_{ik}]\\
&amp;= Cov[\vec{Z}_ib_{0i}+\epsilon_{ij}, \vec{Z}_ib_{0i}+\epsilon_{ik}]\\
&amp;= Cov[\vec{Z}_ib_{0i}, \vec{Z}_ib_{0i}] + Cov[\epsilon_{ij}, \vec{Z}_ib_{0i}] + Cov[\vec{Z}_ib_{0i}, \epsilon_{ik}] + Cov[\epsilon_{ij}, \epsilon_{ik}]\\
&amp;= \sigma^2_b + 0 + 0 + 0\\
&amp;= \sigma^2_b\end{align*}\]</span></p>
<div class="alert fragment absolute" style="left: 650px; bottom: 75px; ">
<p>In 552, we were used to seeing <span class="math inline">\(Cov[Y_{ij}, Y_{ik}]=0\)</span>!</p>
</div>
</div>
</section><section id="what-does-this-covariance-matrix-look-like" class="slide level2"><h2>What does this covariance matrix look like?</h2>
<p><span class="math display">\[\begin{align*}Cov[\vec{Y}_i] &amp;= \vec{Z}_i\sigma^2_b\boldsymbol{1}\vec{Z}_i^T + \sigma^2_\epsilon \boldsymbol{I}\\
&amp;= [\text{cluster-to-cluster variation}] + [\text{within-cluster member-to-member variation}]\\
&amp;=\begin{bmatrix}
\sigma^2_b &amp; \sigma^2_b &amp; \dots &amp; \sigma^2_b\\
\sigma^2_b &amp; \ddots &amp; \dots &amp; \sigma^2_b\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2_b &amp; \dots &amp; \sigma^2_b &amp; \sigma^2_b
\end{bmatrix} + \begin{bmatrix}
\sigma^2_\epsilon &amp; 0 &amp; \dots &amp; 0\\
0 &amp; \ddots &amp; \dots &amp; 0\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
0&amp; \dots &amp; 0 &amp; \sigma^2_\epsilon
\end{bmatrix}\\
&amp;=\begin{bmatrix}
\sigma^2_b + \sigma^2_\epsilon &amp; \sigma^2_b &amp; \dots &amp; \sigma^2_b\\
\sigma^2_b &amp; \ddots &amp; \dots &amp; \sigma^2_b\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2_b &amp; \dots &amp; \sigma^2_b &amp; \sigma^2_b + \sigma^2_\epsilon
\end{bmatrix}\end{align*}\]</span></p>
<ul>
<li>Known as a <span class="alert">block exchangeable</span> matrix or <span class="alert">compound symmetry</span>
</li>
</ul>
<div class="absolute" style="bottom: 100px; right: 100px; width: 500px; ">
<p><img data-src="panda_combo.png"></p>
</div>
</section><section id="inference-for-widehatbeta" class="slide level2"><h2>Inference for <span class="math inline">\(\widehat{\beta}\)</span>
</h2>
<p>Estimation of <span class="math inline">\(\beta\)</span> is done by (restricted) maximum likelihood estimation – the formula looks a lot like it did for weighted least squares (WLS)</p>
<p><span class="math display">\[\widehat{\beta} = \left(\sum_{i=1}^n \boldsymbol{X}^T \left\{Cov[\vec{Y}_i]\right\}^{-1}\boldsymbol{X}_i\right)^{-1}\sum_{i=1}^n \boldsymbol{X}^T \left\{Cov[\vec{Y}_i]\right\}^{-1}\vec{Y}_i\]</span></p>
<div class="fragment">
<ul>
<li><p>In OLS and WLS, we used <span class="alert">maximum likelihood</span> to estimate <span class="math inline">\(\beta\)</span>’s and variance components</p></li>
<li><p>In LMEs, we use <span class="alert">restricted maximum likelihood (REML)</span> estimation because MLE gives us biased estimates of the covariance components in small samples</p></li>
<li>
<p>This means that we <span class="alert">cannot</span> perform likelihood ratio test-based inference for <span class="math inline">\(\vec{\beta}\)</span> when using REML!</p>
<ul>
<li>Wald-based inference (z/t-tests and confidence intervals) are still fine, though</li>
</ul>
</li>
</ul>
</div>
</section><section id="inference-for-widehatbeta-1" class="slide level2"><h2>Inference for <span class="math inline">\(\widehat{\beta}\)</span>
</h2>
<p>Estimation of <span class="math inline">\(\beta\)</span> is done by (restricted) maximum likelihood estimation – the formula looks a lot like it did for weighted least squares (WLS)</p>
<p><span class="math display">\[\widehat{\beta} = \left(\sum_{i=1}^n \boldsymbol{X}^T \left\{Cov[\vec{Y}_i]\right\}^{-1}\boldsymbol{X}_i\right)^{-1}\sum_{i=1}^n \boldsymbol{X}^T \left\{Cov[\vec{Y}_i]\right\}^{-1}\vec{Y}_i\]</span></p>
<p>The “model-based” covariance matrix for <span class="math inline">\(\widehat{\beta}\)</span> is <span class="math display">\[Cov[\widehat{\beta}]=\left(\sum_{i=1}^n \boldsymbol{X}_i^T\left\{Cov[\vec{Y}_i]\right\}^{-1}\boldsymbol{X}_i^T\right)^{-1}\]</span></p>
<div class="fragment">
<p>The confidence intervals for <span class="math inline">\(\vec{\beta}\)</span> will take the form:</p>
<p><span class="math display">\[\widehat{\beta} \pm Z_{\alpha/2} \text{diag}\left(\sum_{i=1}^n \boldsymbol{X}_i^T\left\{Cov[\vec{Y}_i]\right\}^{-1}\boldsymbol{X}_i^T\right)^{-1}\]</span></p>
</div>
</section><section id="inference-for-widehatbeta-2" class="slide level2"><h2>Inference for <span class="math inline">\(widehat{\beta}\)</span>
</h2>
<p><span class="math display">\[\widehat{\beta} \pm Z_{\alpha/2} \text{diag}\left(\sum_{i=1}^n \boldsymbol{X}_i^T\left\{Cov[\vec{Y}_i]\right\}^{-1}\boldsymbol{X}_i^T\right)^{-1}\]</span></p>
<p>Wait, I thought we usually like to use a <span class="math inline">\(t\)</span>-distribution critical value for confidence intervals?</p>
<ul>
<li><p>Generally, yes</p></li>
<li><p>This gets complicated in correlated data when we try to calculate the degrees of freedom: each observation doesn’t contribute fully independent information, so what is <span class="math inline">\(n\)</span> really?</p></li>
<li><p>Often we can just use a standard normal Z critical value</p></li>
<li>
<p>For small sample sizes, we can use a Satterthwaite or Kenward-Roger approximation of the degrees of freedom</p>
<ul>
<li><p>Available in SAS via <code>PROC GLIMMIX</code></p></li>
<li><p>Available in R via <code>model_parameters()</code> function in the <code>parameters</code> package</p></li>
</ul>
</li>
</ul></section><section id="icc-in-lmes" class="slide level2"><h2>ICC in LMEs</h2>
<p>LMEs also make it very intuitive to calculate the ICC</p>
<p><span class="math display">\[\vec{\xi}_i = \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<p><span class="math display">\[b_{i0} \sim N(0, \sigma^2_b)\]</span></p>
<p><span class="math display">\[\epsilon_{ij} \sim N(0, \sigma^2_\epsilon)\]</span></p>
<p><span class="math display">\[\begin{align*}\text{ICC} &amp;= \frac{\text{variation in cluster means}}{\text{variation in cluster means } + \text{individual-level variation}}\\
&amp;= \frac{\sigma^2_b}{\sigma^2_b + \sigma^2_{\epsilon}}\end{align*}\]</span></p>
<!-- --- -->
<!-- ## Distributional assumptions -->
<!-- LMEs assume that the outcome follows a [multivariate normal]{.alert} distribution -->
</section><section id="confounding-by-cluster-membership-in-lmes" class="slide level2"><h2>Confounding by cluster membership in LMEs</h2>
<p>The chief purpose of LMEs is to account for correlations between observations</p>
<ul>
<li>They assume cluster membership adds an additional level of variation to the outcome that isn’t accounted for by OLS modeling strategies</li>
</ul>
<div class="fragment">
<p>Also assumes the random effects are independent of the fixed effect variables</p>
<ul>
<li>i.e., Cluster membership is affecting the outcome distribution, but not (meaningfully) impacting the exposure distribution</li>
</ul>
</div>
<div class="fragment">
<p>This means that <span class="alert">adding random intercepts does not account for confounding by cluster membership</span></p>
<ul>
<li>To account for confounding, we need to add additional (cluster-level) fixed effect variables to the mean model <span class="fragment">… BUT this will not work if we already have a cluster-level covariate in the fixed portion of our model</span>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>See Clark &amp; Linzer (2014) or McNeish (2023) in the suggested readings!</li>
</ul>
</div>
</section><section id="example-radon-measurements-in-minnesota" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s fit an LME model for the effect of measurement floor on log-radon measurements in Minnesota houses. What would our model equation look like?</p>
<div class="fragment">
<p><span class="math display">\[Y_{ij} = \beta_0 + \beta_1 (\text{floor}_{ij}) + b_{0i} + \epsilon_{ij}\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_{ij}\)</span> is the log radon for house <span class="math inline">\(j\)</span> in county <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\text{floor}_{ij}\)</span> is whether the lowest floor of house <span class="math inline">\(j\)</span> in county <span class="math inline">\(i\)</span> was the basement (0) or the ground floor (1)</p></li>
<li><p><span class="math inline">\(b_{0i}\)</span> is the county-level random intercept</p></li>
</ul>
</div>
</section><section id="example-radon-measurements-in-minnesota-1" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>What would the output/estimates of this model look like?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># run an LME with random intercepts for county #</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>radon_lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>(log_radon <span class="sc">~</span> floor <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> county), <span class="at">data=</span>radon.mn)</span>
<span id="cb1-5"><a href="#cb1-5"></a>radon_lme_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(radon_lme)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">summary</span>(radon_lme)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error   t value
(Intercept)  1.4923932 0.04955304 30.117088
floor       -0.6628887 0.06765334 -9.798315</code></pre>
</div>
</div>
<ul>
<li>
<p>LME <span class="math inline">\(\beta_1\)</span>: -0.6629</p>
<ul>
<li><p>95% CI (standard normal Z): (-0.7954, -0.5296)</p></li>
<li><p>How would we interpret this?</p></li>
</ul>
</li>
</ul>
</div>
</section><section id="example-radon-measurements-in-minnesota-2" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>How would these results differ if we calculated the 95% CI using a Satterthwaite approximation?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">model_parameters</span>(radon_lme, <span class="at">df_method=</span><span class="st">"satterthwaite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |   SE |         95% CI | t(915) |      p
-------------------------------------------------------------------
(Intercept) |        1.49 | 0.05 | [ 1.40,  1.59] |  30.12 | &lt; .001
floor       |       -0.66 | 0.07 | [-0.80, -0.53] |  -9.80 | &lt; .001

# Random Effects

Parameter              | Coefficient
------------------------------------
SD (Intercept: county) |        0.32
SD (Residual)          |        0.73</code></pre>
</div>
</div>
<ul>
<li><p>Previous standard normal 95% CI: (-0.7954, -0.5296)</p></li>
<li><p>Really no difference here!</p></li>
</ul></section><section id="example-radon-measurements-in-minnesota-3" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s compare the LME results to adding county as a regression coefficient</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>radon_cty_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_radon <span class="sc">~</span> floor <span class="sc">+</span> <span class="fu">factor</span>(county) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data=</span>radon.mn)</span>
<span id="cb5-2"><a href="#cb5-2"></a>radon_cty_lm_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(radon_cty_lm)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">summary</span>(radon_cty_lm)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  Estimate Std. Error   t value     Pr(&gt;|t|)
floor                           -0.6892278 0.07061897 -9.759812 2.222631e-21
factor(county)AITKIN             0.8872421 0.36369889  2.439496 1.491544e-02
factor(county)ANOKA              0.9306117 0.10083535  9.229023 2.203248e-19
factor(county)BECKER             1.5494936 0.42210194  3.670899 2.570958e-04
factor(county)BELTRAMI           1.5871474 0.27755558  5.718305 1.499191e-08
factor(county)BENTON             1.4545448 0.36369889  3.999311 6.917153e-05
factor(county)BIG STONE          1.5367889 0.41946822  3.663660 2.643561e-04
factor(county)BLUE EARTH         2.0248774 0.19443795 10.414003 5.870367e-24
factor(county)BROWN              1.9960661 0.36498212  5.468942 5.987929e-08
factor(county)CARLTON            1.0456783 0.22986071  4.549182 6.185498e-06
factor(county)CARVER             1.5660075 0.29870312  5.242689 2.007501e-07
factor(county)CASS               1.4280874 0.32491868  4.395215 1.249659e-05
factor(county)CHIPPEWA           1.7558540 0.36327013  4.833466 1.597428e-06
factor(county)CHISAGO            1.0847226 0.29660882  3.657081 2.711205e-04
factor(county)CLAY               2.0059394 0.19522153 10.275196 2.120006e-23
factor(county)CLEARWATER         1.3683042 0.36498212  3.748962 1.898351e-04
factor(county)COOK               0.7175423 0.51374155  1.396699 1.628761e-01
factor(county)COTTONWOOD         1.2670113 0.36711088  3.451304 5.859629e-04
factor(county)CROW WING          1.1600049 0.21047586  5.511344 4.749648e-08
factor(county)DAKOTA             1.3720234 0.09164522 14.971031 4.734256e-45
factor(county)DODGE              1.8168268 0.41946822  4.331262 1.663238e-05
factor(county)DOUGLAS            1.7505574 0.24230717  7.224538 1.136034e-12
factor(county)FARIBAULT          0.7784693 0.29684225  2.622502 8.888117e-03
factor(county)FILLMORE           1.4193309 0.51495353  2.756231 5.974945e-03
factor(county)FREEBORN           2.1129118 0.24268801  8.706288 1.667422e-17
factor(county)GOODHUE            1.9648086 0.19443795 10.105067 1.004852e-22
factor(county)HENNEPIN           1.3927949 0.07128800 19.537579 2.860795e-70
factor(county)HOUSTON            1.7869554 0.29754144  6.005736 2.842769e-09
factor(county)HUBBARD            1.2759202 0.32766978  3.893921 1.065318e-04
factor(county)ISANTI             1.0908814 0.41946822  2.600629 9.470233e-03
factor(county)ITASCA             0.9698884 0.21906013  4.427498 1.080220e-05
factor(county)JACKSON            2.0365007 0.32491868  6.267724 5.872878e-10
factor(county)KANABEC            1.2688809 0.36327013  3.492940 5.028983e-04
factor(county)KANDIYOHI          2.0758292 0.36327013  5.714285 1.533684e-08
factor(county)KITTSON            1.6168074 0.42210194  3.830372 1.375560e-04
factor(county)KOOCHICHING        0.8691291 0.27755558  3.131370 1.800686e-03
factor(county)LAC QUI PARLE      2.9508302 0.51495353  5.730285 1.400800e-08
factor(county)LAKE               0.4866605 0.24230717  2.008445 4.491841e-02
factor(county)LAKE OF THE WOODS  1.8762089 0.36498212  5.140550 3.415587e-07
factor(county)LE SUEUR           1.7635332 0.32522551  5.422493 7.703984e-08
factor(county)LINCOLN            2.3219365 0.36369889  6.384228 2.858738e-10
factor(county)LYON               1.9790587 0.25702241  7.699946 3.857267e-14
factor(county)MAHNOMEN           1.3862944 0.72654027  1.908076 5.672488e-02
factor(county)MARSHALL           1.6386869 0.24533733  6.679321 4.385706e-11
factor(county)MARTIN             1.1068214 0.27479166  4.027857 6.143028e-05
factor(county)MCLEOD             1.3196430 0.20267417  6.511155 1.287875e-10
factor(county)MEEKER             1.2464035 0.32491868  3.836047 1.344715e-04
factor(county)MILLE LACS         0.9681301 0.51495353  1.880034 6.045223e-02
factor(county)MORRISON           1.1807517 0.24230717  4.872954 1.316118e-06
factor(county)MOWER              1.7267952 0.20179869  8.557019 5.525492e-17
factor(county)MURRAY             2.5014360 0.72654027  3.442942 6.041184e-04
factor(county)NICOLLET           2.1778805 0.36327013  5.995209 3.025038e-09
factor(county)NOBLES             1.9425600 0.41946822  4.631006 4.220247e-06
factor(county)NORMAN             1.2848728 0.42012820  3.058288 2.297266e-03
factor(county)OLMSTED            1.3411333 0.15177389  8.836390 5.789065e-18
factor(county)OTTER TAIL         1.6395504 0.25823225  6.349131 3.555422e-10
factor(county)PENNINGTON         1.1907061 0.42210194  2.820897 4.902809e-03
factor(county)PINE               0.8128171 0.29684225  2.738212 6.309244e-03
factor(county)PIPESTONE          1.8778367 0.36369889  5.163163 3.038837e-07
factor(county)POLK               1.7393671 0.36498212  4.765623 2.221064e-06
factor(county)POPE               1.3068698 0.51374155  2.543827 1.114414e-02
factor(county)RAMSEY             1.1964756 0.12860591  9.303426 1.170948e-19
factor(county)REDWOOD            1.9980864 0.32522551  6.143695 1.248089e-09
factor(county)RENVILLE           1.6869754 0.42012820  4.015383 6.470618e-05
factor(county)RICE               1.8640322 0.21915418  8.505574 8.317691e-17
factor(county)ROCK               1.3353472 0.51374155  2.599259 9.507820e-03
factor(county)ROSEAU             1.6822959 0.19832489  8.482525 9.984029e-17
factor(county)SCOTT              1.8226588 0.20267417  8.993049 1.592678e-18
factor(county)SHERBURNE          1.1250834 0.25687077  4.379959 1.338305e-05
factor(county)SIBLEY             1.2748666 0.36327013  3.509418 4.731732e-04
factor(county)ST LOUIS           0.9230634 0.06815719 13.543156 6.518505e-38
factor(county)STEARNS            1.5181320 0.14574669 10.416236 5.749724e-24
factor(county)STEELE             1.6039799 0.22975221  6.981347 5.973271e-12
factor(county)STEVENS            1.8089602 0.51374155  3.521148 4.530203e-04
factor(county)SWIFT              1.0267329 0.36327013  2.826362 4.820722e-03
factor(county)TODD               1.7391651 0.42012820  4.139606 3.833099e-05
factor(county)TRAVERSE           2.0202557 0.36369889  5.554748 3.740823e-08
factor(county)WABASHA            1.8425616 0.27479166  6.705304 3.705476e-11
factor(county)WADENA             1.3211396 0.32614426  4.050783 5.581559e-05
factor(county)WASECA             0.7061443 0.36369889  1.941563 5.252692e-02
factor(county)WASHINGTON         1.3633839 0.10739718 12.694783 6.958128e-34
factor(county)WATONWAN           2.7001154 0.42210194  6.396833 2.642693e-10
factor(county)WILKIN             2.2407097 0.72654027  3.084082 2.109193e-03
factor(county)WINONA             1.6562790 0.20216393  8.192752 9.577664e-16
factor(county)WRIGHT             1.6664711 0.20157922  8.267078 5.395861e-16
factor(county)YELLOW MEDICINE    1.2168067 0.51374155  2.368519 1.808678e-02</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:60%;">
<div class="fragment">
<ul>
<li>
<p>OLS <span class="math inline">\(\beta_1\)</span>: -0.6892</p>
<ul>
<li>95% CI: (-0.8278, -0.5506)</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<p>What differences can you see compared to the previous LME?</p>
<ul>
<li>
<p>LME <span class="math inline">\(\beta_1\)</span>: -0.6629</p>
<ul>
<li>95% CI: (-0.7954, -0.5296)</li>
</ul>
</li>
</ul>
</div>
</div><div class="column" style="width:40%;">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-1-2_files/figure-revealjs/radon%20CI%20plot-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
<div class="fragment absolute" style="top: 400px; right: 25px; width: 30%; ">
<p><span class="alert">If county affects both % houses with basements and radon levels, what variables could we include to control for this confounding?</span></p>
</div>
</div>
</section><section id="marginal-effects-in-lmes" class="slide level2"><h2>Marginal effects in LMEs</h2>
<p>The default interpretation of LMEs is <span class="alert">conditional</span>… but we can sometimes extract <span class="alert">marginal</span> effects out of them</p>
<div class="fragment">
<ul>
<li>For continuous outcomes (like we’ve been talking about), or outcomes that we <strong>do not</strong> transform, <span class="alert">the conditional and marginal effects will be identical</span>
</li>
</ul>
<p><span class="math display">\[\begin{align*}E[\vec{Y}_i] &amp;= E\left\{E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}]\right\}\\
&amp;=E[\boldsymbol{X}_i\vec{\beta} + \vec{Z}_i b_{0i}]\\
&amp;=\boldsymbol{X}_i\vec{\beta} + \vec{Z}_i E[b_{0i}]\\
&amp;=\boldsymbol{X}_i\vec{\beta}\end{align*}\]</span></p>
</div>
<div class="fragment">
<ul>
<li>For non-continuous outcomes or outcomes we do need to transform, the above will not hold and the marginal and conditional effects with be different… more on this next week</li>
</ul>
</div>
</section><section id="a-note-on-terminology" class="slide level2"><h2>A note on terminology</h2>
<p>Throughout this lecture we’ve referred to <span class="math inline">\(\vec{\beta}\)</span> as “fixed effects” and <span class="math inline">\(b_{0i}\)</span> as “random effects”</p>
<ul>
<li>This is standard terminology within statistics</li>
</ul>
<div class="fragment">
<p>In parts of the social sciences (*cough* economics *cough*), “fixed effects” refer to adjusting for cluster membership as covariates</p>
<ul>
<li><p>These types of models are referred to in econ as “fixed effect models”</p></li>
<li><p>This is done to adjust for the (potentially) confounding effect of cluster membership, not so much to deal with correlated data</p></li>
</ul>
</div>
<div class="fragment">
<p>This terminology has lead to many an argument between researchers until everyone realizes there was a miscommunication</p>
<ul>
<li>Just an FYI in case you’re ever reading about random/fixed effects online</li>
</ul>
<p><img src="POPUHEALSMPH_color-flush.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="slides-1-2_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="slides-1-2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/notes/notes.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/search/search.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="slides-1-2_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': true,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>