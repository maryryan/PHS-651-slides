<!DOCTYPE html>
<html lang="en"><head>
<script src="slides-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides-1_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides-1_files/libs/quarto-html/popper.min.js"></script>
<script src="slides-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides-1_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides-1_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="slides-1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<title>slides-1</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="slides-1_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="slides-1_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="slides-1_files/libs/revealjs/dist/theme/quarto.css">
<link href="slides-1_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="slides-1_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="slides-1_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="slides-1_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="slides-1_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="slides-1_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2"><h1>
Lecture 1: Correlated data
</h1>
<h2>
PHS 651: Advanced regression methods
</h2>
<hr>
<h3>
Mary Ryan Baumann, PhD
</h3>
<h3>
September 9, 2025
</h3>
<p><br></p>
<div style="font-size: 75%;">
<p><strong>Recording disclosure</strong></p>
<p><em>This class is being conducted in person, as well as over <span class="alert">Zoom</span>. As the instructor, I will be <span class="alert">recording</span> this session. I have disabled the recording feature for others so that no one else will be able to record this session. I will be posting this session to the course’s website.</em></p>
<p><em>If you have privacy concerns and do not wish to appear in the recording, you may turn video off (click “stop video”) so that Zoom does not record you.</em></p>
<p><em>The chat box is always open for discussion and questions to the entire class. You may also send messages privately to the instructor. Please note that Zoom saves all chat transcripts.</em></p>
</div>
<div class="absolute" style="left: 260px; bottom: 50px; width: 1500px; ">
<p>Slides found at: <a href="https://maryryan.github.io/PHS-651-slides/F25/lec-1/slides-1" class="uri">https://maryryan.github.io/PHS-651-slides/F25/lec-1/slides-1</a></p>
</div>
<div class="absolute" style="left: 100px; bottom: 0px; width: 150px; ">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-1_files/figure-revealjs/qr%20code-1.png" width="192"></p>
</div>
</div>
</div>
</section><section id="what-is-clusteredcorrelated-data" class="slide level2"><h2>What is clustered/correlated data?</h2>
<p>When we talk about “correlated” or “clustered” data, we’re most often talking about correlated/clustered <span class="alert">outcomes</span></p>
<ul>
<li>This stems from one of our regression assumptions: that the <em>outcome values</em> for 2 observations will be independent</li>
</ul>
<div class="fragment">
<p>Informal definitions</p>
<ul>
<li><p><u>Independent data</u>: data where each observation of an outcome are not meaningfully correlated with other observations of the same outcome (given other covariates <span class="math inline">\(\boldsymbol{X}\)</span>)</p></li>
<li><p><u>Clustered/Correlated data</u>: data where each observation of an outcome has some kind of relationship to another set of observations of that outcome (given other covariates <span class="math inline">\(\boldsymbol{X}\)</span>)</p></li>
</ul>
</div>
</section><section id="what-is-clusteredcorrelated-data-1" class="slide level2"><h2>What is clustered/correlated data?</h2>
<p>When we talk about “correlated” or “clustered” data, we’re most often talking about correlated/clustered <span class="alert">outcomes</span></p>
<ul>
<li>This stems from one of our regression assumptions: that the <em>outcome values</em> for 2 observations will be independent</li>
</ul>
<p>In other words…</p>
<ul>
<li><p>Outcomes are <span class="alert">independent</span> if we can identify and adjust for all the covariates that would drive correlations between outcome observations to 0</p></li>
<li><p>Outcomes are <span class="alert">clustered/correlated</span> if, for some reason or another, we <em>can’t</em> identify or adjust for all the necessary covariates</p></li>
</ul></section><section id="what-is-clusteredcorrelated-data-2" class="slide level2"><h2>What is clustered/correlated data?</h2>
<p>Some more informal definitions/descriptions</p>
<ul>
<li><p>“Clustered data arise when the data from the whole study <span class="alert">can be classified</span> into a number of different groups, referred to as clusters. <span class="alert">Each cluster contains multiple observations, giving the data a “nested” or “hierarchical” structure</span>, with individual observations nested within the cluster.” (Galbraith et al, 2010, <a href="https://doi.org/10.1523/JNEUROSCI.0362-10.2010">“A Study of Clustered Data and Approaches to Its Analysis”</a>)</p></li>
<li><p>“…we might reasonably expect that measurements on <span class="alert">units within a cluster are more similar</span> than measurements on units in different clusters.” (Applied Longitudinal Analysis pg. 4)</p></li>
<li><p>AKA: nested/multilevel/hierarchical data</p></li>
</ul></section><section id="what-is-clusteredcorrelated-data-3" class="slide level2"><h2>What is clustered/correlated data?</h2>
<p>Remember in OLS where we assumed that observations were independent?</p>
<ul>
<li>This meant that we assumed <span class="math inline">\(Cov[Y_i, Y_j|\boldsymbol{X}]=0\)</span> and:</li>
</ul>
<p><span class="math display">\[Cov[\vec{Y}|\boldsymbol{X}] = \sigma^2\boldsymbol{I} =  \begin{bmatrix}\sigma^2 &amp; 0 &amp; \dots &amp; 0 \\
0 &amp; \ddots &amp; \dots &amp; 0 \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
0 &amp; \dots &amp; 0 &amp; \sigma^2\end{bmatrix} \text{ or   } Cov[\vec{Y}|\boldsymbol{X}] = \sigma_i^2\boldsymbol{I} =  \begin{bmatrix}\sigma_1^2 &amp; 0 &amp; \dots &amp; 0 \\
0 &amp; \ddots &amp; \dots &amp; 0 \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
0 &amp; \dots &amp; 0 &amp; \sigma_n^2\end{bmatrix}\]</span></p>
<div class="fragment">
<p>When data are <span class="alert">clustered</span>, at least some <span class="math inline">\(Cov[Y_i, Y_j|\boldsymbol{X}]\ne0\)</span></p>
<ul>
<li><p>This is like saying that some observations have <span class="alert">shared information</span></p></li>
<li><p>This impacts our variance estimates for <span class="math inline">\(\widehat{\beta}\)</span> and our inference</p></li>
</ul>
</div>
</section><section id="why-is-data-clusteredcorrelated" class="slide level2"><h2>Why is data clustered/correlated?</h2>
<p>Several potential reasons</p>
<ul>
<li>
<p>Natural group membership</p>
<ul>
<li><p>Physical/structural grouping</p></li>
<li><p>e.g., Household members, classroom students, eyes in a person’s head</p></li>
<li><p>Things may be “done similarly” within each natural group</p></li>
</ul>
</li>
</ul>
<div class="fragment">
<ul>
<li>
<p>Clustered by design</p>
<ul>
<li>
<p>Exposure applied to entire group based on single characteristic</p>
<ul>
<li><p>e.g., All residents of City X are exposed to a new policy</p></li>
<li><p>Exposure can be randomized or not</p></li>
</ul>
</li>
<li>
<p>Cluster/multi-stage sampling</p>
<ul>
<li>e.g., NHANES</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section><section id="how-does-clustering-affect-outcomes" class="slide level2"><h2>How does clustering affect outcomes?</h2>
<p>“Clustered data” usually has cluster membership that could impact just the distribution of outcome, …</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="slides-1_files/figure-revealjs/cluster%20DAG1.5-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section><section id="how-does-clustering-affect-outcomes-1" class="slide level2"><h2>How does clustering affect outcomes?</h2>
<p>… wholly dictate who receives exposure, …</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="slides-1_files/figure-revealjs/cluster%20DAG2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section><section id="how-does-clustering-affect-outcomes-2" class="slide level2"><h2>How does clustering affect outcomes?</h2>
<p>… or potentially be a <span class="alert">confounding variable</span> (affects both exposure and outcome distributions)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="slides-1_files/figure-revealjs/cluster%20DAG3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section><section id="how-does-clustering-affect-outcomes-3" class="slide level2"><h2>How does clustering affect outcomes?</h2>
<p>If observations belong to a group but that doesn’t affect the distribution of the outcome in any way, it’s usually not “clustered data” with respect to that outcome</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="slides-1_files/figure-revealjs/cluster%20DAG1-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<!-- Seaman S, Pavlou M, Copas A. Review of methods for handling confounding by cluster and informative cluster size in clustered data. Stat Med. 2014 Dec 30;33(30):5371-87. doi: 10.1002/sim.6277. Epub 2014 Aug 4. PMID: 25087978; PMCID: PMC4320764. -->
</section><section id="other-issues-from-correlated-data" class="slide level2"><h2>Other issues from correlated data</h2>
<p>Even if clustering has no impact on the overall outcome or exposure averages:</p>
<ul>
<li><p>Groups/clusters may not be the same size (informative cluster size)</p></li>
<li>
<p>“Clustering” of data may also affect variance</p>
<ul>
<li><p>Some groups have higher/lower variation than others</p></li>
<li><p>Some groups may have higher/lower measurement error than others</p></li>
<li>
<p>This all breaks the <u>homoskedasticity</u> assumption of OLS</p>
<ul>
<li>Recall PHS 552!</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Clustering also reduces the amount of <span class="alert">information</span> we get from each individual data point</p>
<ul>
<li>Means that we will need more data to draw conclusion with same level of precision</li>
</ul></section><section id="measuring-clustered-ness" class="slide level2"><h2>Measuring “clustered-ness”</h2>
<p>How can we tell if data are clustered?</p>
<div class="fragment">
<ul>
<li>
<p>Regular Pearson correlation only looks at variances between variables</p>
<ul>
<li>Doesn’t account for group means in any way</li>
</ul>
</li>
<li><p>Another metric we can use?</p></li>
</ul>
</div>
<div class="fragment">
<p><u>Intracluster correlation coefficient</u> (ICC): measure of within- vs.&nbsp;between-cluster variation</p>
<ul>
<li><p>Cluster-specific mean: <span class="math inline">\(\bar{y}_i = \frac{1}{n_i} \sum_{j=1}^{n_i} y_{ij}\)</span></p></li>
<li><p>Variation in cluster means: <span class="math inline">\(\gamma^2 = \text{var}(\bar{y}_i)\)</span></p></li>
<li><p>Individual-level variation: <span class="math inline">\(\sigma^2 = \text{var}(y_{ij})\)</span></p></li>
<li><p>ICC: <span class="math display">\[\rho = \frac{\gamma^2}{\gamma^2 + \sigma^2}\]</span></p></li>
</ul>
</div>
</section><section id="measuring-clustered-ness-1" class="slide level2"><h2>Measuring “clustered-ness”</h2>
<p><u>Intracluster correlation coefficient</u> (ICC): measure of within- vs.&nbsp;between-cluster variation</p>
<ul>
<li><p>Cluster-specific mean: <span class="math inline">\(\bar{y}_i = \frac{1}{n_i} \sum_{j=1}^{n_i} y_{ij}\)</span></p></li>
<li><p>Variation in cluster means: <span class="math inline">\(\gamma^2 = \text{var}(\bar{y}_i)\)</span></p></li>
<li><p>Individual-level variation: <span class="math inline">\(\sigma^2 = \text{var}(y_{ij})\)</span></p></li>
<li><p>ICC: <span class="math display">\[\rho = \frac{\gamma^2}{\gamma^2 + \sigma^2}\]</span></p></li>
</ul>
<p>In words: <span class="math display">\[\text{ICC} = \frac{\text{variation in cluster means}}{\text{total variation}}= \frac{\text{variation in cluster means}}{\text{variation in cluster means } + \text{individual-level variation}}\]</span></p>
</section><section id="clustering-in-data-analysis" class="slide level2"><h2>Clustering in data analysis</h2>
<p>What are some ideas about how we could handle clustering in an analysis?</p>
</section><section id="clustering-in-individual-level-data-analysis" class="slide level2"><h2>Clustering in individual-level data analysis</h2>
<p>What is a way to handle clustering in an (individual-level) analysis?</p>
<p><span class="alert">Could ignore it and perform regular regression/t-test</span></p>
<p><span class="math display">\[Y_{j} = \beta_0 + \beta_1 U_{j} + \epsilon_{j}\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_{j}\)</span> is outcome for individual <span class="math inline">\(j\)</span></p></li>
<li><p><span class="math inline">\(U_{j}\)</span> is exposure for individual <span class="math inline">\(j\)</span></p></li>
</ul>
<div class="fragment">
<p>Do we see any issues with this approach?</p>
</div>
</section><section id="clustering-in-individual-level-data-analysis-1" class="slide level2"><h2>Clustering in individual-level data analysis</h2>
<p>What is a way to handle clustering in an (individual-level) analysis?</p>
<p><span class="alert">Could perform separate regressions/t-tests for each cluster</span></p>
<p><span class="math display">\[Y_{ij} = \beta_{0i} + \beta_{1i} U_{ij} + \epsilon_{ij}\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_{ij}\)</span> is outcome for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(U_{ij}\)</span> is exposure for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
</ul>
<div class="fragment">
<p>Do we see any issues with this approach?</p>
</div>
</section><section id="clustering-in-individual-level-data-analysis-2" class="slide level2"><h2>Clustering in individual-level data analysis</h2>
<p>What is a way to handle clustering in an (individual-level) regression?</p>
<p><span class="alert">Could add cluster membership as model covariate</span></p>
<p><span class="math display">\[Y_{ij} = \beta_0 + \beta_1 U_{ij} + \gamma_i C^{(i)}_{ij} + \epsilon_{ij}\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_{ij}\)</span> is outcome for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(U_{ij}\)</span> is exposure for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(C^{(i)}_{ij}\)</span> is whether individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span> is a member of cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\gamma_i\)</span> is the effect of being in cluster <span class="math inline">\(i\)</span> on the outcome <span class="alert">compared to the reference group</span>, for two individuals with the same level of exposure</p></li>
</ul>
<div class="fragment">
<p>Do we see any issues with this approach?</p>
</div>
</section><section id="clustering-in-individual-level-data-analysis-3" class="slide level2"><h2>Clustering in individual-level data analysis</h2>
<p>What is a way to handle clustering in an (individual-level) regression?</p>
<p><span class="alert">Could add cluster membership as model covariate (modified)</span></p>
<p><span class="math display">\[Y_{ij} = \beta_1 U_{ij} + \gamma_i C^{(i)}_{ij} + \epsilon_{ij}\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_{ij}\)</span> is outcome for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(U_{ij}\)</span> is exposure for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(C^{(i)}_{ij}\)</span> is whether individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span> is a member of cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\gamma_i\)</span> is the mean outcome of cluster <span class="math inline">\(i\)</span> for those with exposure <span class="math inline">\(=0\)</span></p></li>
</ul></section><section id="clustering-in-cluster-level-data-analysis" class="slide level2"><h2>Clustering in cluster-level data analysis</h2>
<p>Another approach is to conduct the data analysis at the cluster level</p>
<ul>
<li>Instead of individual-level outcomes/predictors, roll these up to <span class="alert">cluster-level averages</span>
</li>
</ul>
<p><span class="math display">\[\bar{Y}_{i} = \beta_1 \bar{U}_{i} + \epsilon_{i}\]</span></p>
<ul>
<li><p><span class="math inline">\(\bar{Y}_{i}\)</span> is the mean outcome in cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\bar{U}_{i}\)</span> is mean exposure in cluster <span class="math inline">\(i\)</span></p></li>
</ul>
<div class="fragment">
<p>Do we see any issues with this approach?</p>
</div>
<div class="fragment">
<ul>
<li>Downside: removes ability of individual covariates to predict individual outcomes</li>
</ul>
</div>
</section><section id="simpsons-paradox" class="slide level2"><h2>Simpson’s paradox</h2>
<p>Another issue with cluster-level analyses is the possibility for <span class="alert">Simpson’s paradox</span> (<a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-multilevelintro.html#multinecessary">BMLR 8.11</a>)</p>
<ul>
<li><p>When trends seen among smaller groups disappear when groups are combined due to differences in group sizes</p></li>
<li><p>We can’t get a sense of the full picture if we only do an analysis at the cluster level</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure><p><a href="https://en.wikipedia.org/wiki/File:Simpson%27s_paradox_continuous.svg"><img data-src="Simpson's_paradox_continuous.svg" style="width:30.0%"></a></p>
<figcaption><em>Illustration of Simpson’s paradox, via Wikipedia</em></figcaption></figure>
</div>
</section><section id="example-radon-measurements-in-minnesota" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s see how these approaches differ with some actual data</p>
<div class="fragment">
<p>Say we’re taking radon measurements in Minnesota houses and want to estimate whether the lowest floor we can measure on affects our readings</p>
<ul>
<li>Basement measurements coded as <code>floor=0</code>; 1st floor measurements coded as <code>floor=1</code>
</li>
</ul>
<p><span class="alert">Can we think of some ways in which this data might be clustered?</span></p>
</div>
</section><section id="example-radon-measurements-in-minnesota-1" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s see how these approaches differ with some actual data</p>
<p>Say we’re taking radon measurements in Minnesota houses and want to estimate whether the lowest floor we can measure on affects our readings</p>
<ul>
<li><p>Basement measurements coded as <code>floor=0</code>; 1st floor measurements coded as <code>floor=1</code></p></li>
<li><p>Individual houses can be grouped in a number of ways, including <span class="alert">by county</span></p></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># find number of observations, mean/sd log_radon, and proportion without basements by county #</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>radon.mn <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3"></a>   <span class="fu">group_by</span>(county) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4"></a>   <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="at">mean_log_radon=</span><span class="fu">mean</span>(log_radon, <span class="at">na.rm=</span>T),</span>
<span id="cb1-5"><a href="#cb1-5"></a>             <span class="at">sd_log_radon=</span><span class="fu">sd</span>(log_radon, <span class="at">na.rm=</span>T), </span>
<span id="cb1-6"><a href="#cb1-6"></a>             <span class="at">pct_no_basement =</span> <span class="fu">mean</span>(floor, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7"></a>   <span class="fu">print</span>(<span class="at">n=</span><span class="dv">85</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 85 × 5
   county                n mean_log_radon sd_log_radon pct_no_basement
   &lt;chr&gt;             &lt;int&gt;          &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
 1 AITKIN                4          0.715       0.432           0.25  
 2 ANOKA                52          0.891       0.718           0.0577
 3 BECKER                3          1.09        0.717           0.667 
 4 BELTRAMI              7          1.19        0.894           0.571 
 5 BENTON                4          1.28        0.415           0.25  
 6 BIG STONE             3          1.54        0.504           0     
 7 BLUE EARTH           14          1.93        0.542           0.143 
 8 BROWN                 4          1.65        0.595           0.5   
 9 CARLTON              10          0.977       0.585           0.1   
10 CARVER                6          1.22        1.90            0.5   
11 CASS                  5          1.43        0.490           0     
12 CHIPPEWA              4          1.76        0.907           0     
13 CHISAGO               6          1.08        0.808           0     
14 CLAY                 14          1.81        0.984           0.286 
15 CLEARWATER            4          1.02        0.701           0.5   
16 COOK                  2          0.718       0.441           0     
17 COTTONWOOD            4          0.750       2.12            0.75  
18 CROW WING            12          0.988       0.639           0.25  
19 DAKOTA               63          1.33        0.724           0.0635
20 DODGE                 3          1.82        0.150           0     
21 DOUGLAS               9          1.67        0.344           0.111 
22 FARIBAULT             6          0.664       1.21            0.167 
23 FILLMORE              2          1.07        0.169           0.5   
24 FREEBORN              9          1.96        0.795           0.222 
25 GOODHUE              14          1.87        0.702           0.143 
26 HENNEPIN            105          1.32        0.681           0.105 
27 HOUSTON               6          1.56        0.540           0.333 
28 HUBBARD               5          0.862       0.675           0.6   
29 ISANTI                3          1.09        0.240           0     
30 ITASCA               11          0.970       0.564           0     
31 JACKSON               5          2.04        0.678           0     
32 KANABEC               4          1.27        0.615           0     
33 KANDIYOHI             4          2.08        0.503           0     
34 KITTSON               3          1.16        1.02            0.667 
35 KOOCHICHING           7          0.475       0.352           0.571 
36 LAC QUI PARLE         2          2.61        0.244           0.5   
37 LAKE                  9          0.410       0.772           0.111 
38 LAKE OF THE WOODS     4          1.53        0.551           0.5   
39 LE SUEUR              5          1.63        0.520           0.2   
40 LINCOLN               4          2.15        0.664           0.25  
41 LYON                  8          1.89        0.318           0.125 
42 MAHNOMEN              1          1.39       NA               0     
43 MARSHALL              9          1.26        1.46            0.556 
44 MARTIN                7          1.01        1.19            0.143 
45 MCLEOD               13          1.11        1.39            0.308 
46 MEEKER                5          1.25        0.479           0     
47 MILLE LACS            2          0.624       1.60            0.5   
48 MORRISON              9          1.10        0.374           0.111 
49 MOWER                13          1.62        0.915           0.154 
50 MURRAY                1          2.50       NA               0     
51 NICOLLET              4          2.18        0.550           0     
52 NOBLES                3          1.94        0.302           0     
53 NORMAN                3          1.06        0.908           0.333 
54 OLMSTED              23          1.25        0.730           0.130 
55 OTTER TAIL            8          1.38        0.805           0.375 
56 PENNINGTON            3          0.731       1.44            0.667 
57 PINE                  6          0.698       0.471           0.167 
58 PIPESTONE             4          1.71        0.862           0.25  
59 POLK                  4          1.39        0.865           0.5   
60 POPE                  2          1.31        0.0765          0     
61 RAMSEY               32          1.13        0.641           0.0938
62 REDWOOD               5          1.86        0.884           0.2   
63 RENVILLE              3          1.46        0.579           0.333 
64 RICE                 11          1.80        0.556           0.0909
65 ROCK                  2          1.34        1.14            0     
66 ROSEAU               14          1.29        0.659           0.571 
67 SCOTT                13          1.61        0.951           0.308 
68 SHERBURNE             8          1.13        0.364           0     
69 SIBLEY                4          1.27        0.545           0     
70 ST LOUIS            116          0.828       0.756           0.138 
71 STEARNS              25          1.41        0.680           0.16  
72 STEELE               10          1.60        0.583           0     
73 STEVENS               2          1.81        0.400           0     
74 SWIFT                 4          1.03        0.465           0     
75 TODD                  3          1.51        0.627           0.333 
76 TRAVERSE              4          1.85        0.818           0.25  
77 WABASHA               7          1.74        0.809           0.143 
78 WADENA                5          1.05        0.742           0.4   
79 WASECA                4          0.534       1.25            0.25  
80 WASHINGTON           46          1.29        0.770           0.109 
81 WATONWAN              3          2.24        0.444           0.667 
82 WILKIN                1          2.24       NA               0     
83 WINONA               13          1.50        0.991           0.231 
84 WRIGHT               13          1.61        0.586           0.0769
85 YELLOW MEDICINE       2          1.22        0.167           0     </code></pre>
</div>
</div>
</div>
</section><section id="example-radon-measurements-in-minnesota-2" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s look at the observations for a random sample of counties</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># pick 8 random counties #</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>counties <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">unique</span>(radon.mn<span class="sc">$</span>county), <span class="at">size=</span><span class="dv">8</span> )</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># create density plots for selected counties by floor#</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>radon.mn <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>( county <span class="sc">%in%</span> counties ) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>log_radon,<span class="at">x=</span><span class="fu">factor</span>(floor)),</span>
<span id="cb3-9"><a href="#cb3-9"></a>              <span class="at">size=</span><span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>   <span class="fu">facet_grid</span>(<span class="at">cols=</span><span class="fu">vars</span>(county))<span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>   <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="slides-1_files/figure-revealjs/radon%20plot-1.png" width="4800"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>How do we think county membership might affect analysis of our question of interest?</li>
</ul></section><section id="example-radon-measurements-in-minnesota-3" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s see if we have any clustering…</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(ICC)</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># find ICC of log_radon by county #</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">ICCest</span>(county,log_radon, <span class="at">data=</span>radon.mn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ICC
[1] 0.130029

$LowerCI
[1] 0.07938507

$UpperCI
[1] 0.199242

$N
[1] 85

$k
[1] 10.43246

$varw
[1] 0.5875166

$vara
[1] 0.08781233</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>Breaking the output down:</p>
<ul>
<li><p>Variation in cluster means (<code>vara</code>): 0.0878</p></li>
<li><p>Individual-level (within-cluster) variation (<code>varw</code>): 0.5875</p></li>
<li><p>Total variation: 0.6753</p></li>
<li><p>ICC = cluster mean variation/total variation: 0.130029</p></li>
<li>
<p>95% confidence interval: (0.0794, 0.1992)</p>
<ul>
<li>Not trivial…</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</section><section id="example-radon-measurements-in-minnesota-4" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>We’ll first fit without accounting for counties</p>
<ul>
<li>AKA: “complete pooling” of data</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># run OLS regression #</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>radon_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_radon <span class="sc">~</span> floor, <span class="at">data=</span>radon.mn)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#get regression summary #</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="fu">summary</span>(radon_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_radon ~ floor, data = radon.mn)

Residuals:
     Min       1Q   Median       3Q      Max 
-3.07857 -0.52950  0.02388  0.53970  2.51502 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.36241    0.02855  47.725   &lt;2e-16 ***
floor       -0.58642    0.06996  -8.382   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7901 on 917 degrees of freedom
Multiple R-squared:  0.07116,   Adjusted R-squared:  0.07015 
F-statistic: 70.25 on 1 and 917 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="fragment">
<ul>
<li>How would we interpret this result?</li>
</ul>
</div>
</div>
</div>
</section><section id="example-radon-measurements-in-minnesota-5" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Next we’ll fit a separate regression for each county</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># stratify dataset by county #</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>radon.cty <span class="ot">&lt;-</span> <span class="fu">split</span>(radon.mn, radon.mn<span class="sc">$</span>county)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># run linear regression on each county dataset separately #</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>radon_seg_lm <span class="ot">&lt;-</span> <span class="fu">lapply</span>(radon.cty, <span class="cf">function</span>(x){</span>
<span id="cb8-6"><a href="#cb8-6"></a>   <span class="fu">lm</span>(log_radon <span class="sc">~</span> floor, <span class="at">data=</span>x)</span>
<span id="cb8-7"><a href="#cb8-7"></a>   })</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co"># get regression summary from each counties #</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="fu">lapply</span>(radon_seg_lm, <span class="cf">function</span>(x){</span>
<span id="cb8-11"><a href="#cb8-11"></a>   <span class="fu">summary</span>(x)<span class="sc">$</span>coef</span>
<span id="cb8-12"><a href="#cb8-12"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$AITKIN
             Estimate Std. Error  t value  Pr(&gt;|t|)
(Intercept) 0.6756105  0.3001172 2.251156 0.1532281
floor       0.1572986  0.6002343 0.262062 0.8177961

$ANOKA
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  0.9531413 0.09684019  9.842414 2.736102e-13
floor       -1.0797404 0.40317786 -2.678075 9.992676e-03

$BECKER
              Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.4816045  0.8935652  1.6580822 0.3454939
floor       -0.5873943  1.0943894 -0.5367324 0.6864011

$BELTRAMI
              Estimate Std. Error   t value   Pr(&gt;|t|)
(Intercept)  1.7205728  0.4715133  3.649044 0.01476303
floor       -0.9227223  0.6237535 -1.479306 0.19912380

$BENTON
              Estimate Std. Error    t value   Pr(&gt;|t|)
(Intercept)  1.3434464  0.2800397  4.7973429 0.04080952
floor       -0.2448341  0.5600794 -0.4371418 0.70468061

$`BIG STONE`
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 1.536789  0.2908201 5.284328 0.03399571

$`BLUE EARTH`
             Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept) 1.8773039  0.1584174 11.8503637 5.560907e-08
floor       0.3437863  0.4191331  0.8202319 4.280765e-01

$BROWN
             Estimate Std. Error   t value   Pr(&gt;|t|)
(Intercept)  2.119655  0.2155980  9.831517 0.01018785
floor       -0.936406  0.3049016 -3.071174 0.09167506

$CARLTON
             Estimate Std. Error  t value    Pr(&gt;|t|)
(Intercept) 0.8918988  0.1839039 4.849810 0.001272162
floor       0.8485674  0.5815551 1.459135 0.182646699

$CARVER
             Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.789234   1.160499  1.5417808 0.1979857
floor       -1.135682   1.641193 -0.6919856 0.5270168

$CASS
            Estimate Std. Error  t value    Pr(&gt;|t|)
(Intercept) 1.428087  0.2191087 6.517714 0.002860964

$CHIPPEWA
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 1.755854  0.4534927 3.871846 0.03048953

$CHISAGO
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 1.084723  0.3297764 3.289267 0.02173109

$CLAY
             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  2.114389  0.2788823  7.581653 6.487465e-06
floor       -1.068800  0.5217410 -2.048526 6.303556e-02

$CLEARWATER
              Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.2527630  0.5618795  2.2295937 0.1555471
floor       -0.4581454  0.7946176 -0.5765608 0.6224786

$COOK
             Estimate Std. Error  t value  Pr(&gt;|t|)
(Intercept) 0.7175423  0.3120772 2.299246 0.2611715

$COTTONWOOD
             Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.931521   2.415650  0.7995865 0.5078269
floor       -1.575241   2.789353 -0.5647337 0.6291482

$`CROW WING`
               Estimate Std. Error    t value   Pr(&gt;|t|)
(Intercept) 0.987181235  0.2235146 4.41662953 0.00130092
floor       0.002066844  0.4470292 0.00462351 0.99640192

$DAKOTA
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.3852197 0.09057044 15.294390 1.522958e-22
floor       -0.8970692 0.35944029 -2.495739 1.528947e-02

$DODGE
            Estimate Std. Error t value    Pr(&gt;|t|)
(Intercept) 1.816827 0.08688712 20.9102 0.002279276

$DOUGLAS
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.7163485  0.1206615 14.224491 2.016270e-06
floor       -0.3813474  0.3619845 -1.053491 3.271161e-01

$FARIBAULT
              Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  0.7290231  0.5990652  1.2169346 0.2905179
floor       -0.3925509  1.4674040 -0.2675139 0.8023008

$FILLMORE
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  1.193922        NaN     NaN      NaN
floor       -0.238411        NaN     NaN      NaN

$FREEBORN
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  2.1520536  0.2817105  7.639239 0.0001222323
floor       -0.8653659  0.5975982 -1.448073 0.1908603074

$GOODHUE
             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept) 1.8242016  0.2084881 8.7496690 1.485725e-06
floor       0.2950208  0.5516076 0.5348383 6.025314e-01

$HENNEPIN
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.4040499 0.06586418 21.317352 1.479895e-39
floor       -0.7966622 0.20349211 -3.914954 1.626364e-04

$HOUSTON
              Estimate Std. Error   t value    Pr(&gt;|t|)
(Intercept)  1.7302831  0.2619879  6.604439 0.002723847
floor       -0.5192109  0.4537763 -1.144200 0.316358219

$HUBBARD
              Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.0087831  0.5404969  1.8663993 0.1588190
floor       -0.2439993  0.6977785 -0.3496802 0.7496864

$ISANTI
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 1.090881  0.1387304 7.863319 0.01579085

$ITASCA
             Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept) 0.9698884  0.1699772 5.705991 0.0001966818

$JACKSON
            Estimate Std. Error  t value    Pr(&gt;|t|)
(Intercept) 2.036501  0.3032216 6.716213 0.002558856

$KANABEC
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 1.268881  0.3074932 4.126534 0.02580796

$KANDIYOHI
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 2.075829  0.2515057 8.253608 0.00372436

$KITTSON
             Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.945910   1.079085  1.8032968 0.3223346
floor       -1.182882   1.321604 -0.8950354 0.5352259

$KOOCHICHING
             Estimate Std. Error   t value  Pr(&gt;|t|)
(Intercept) 0.3628540  0.2125598 1.7070679 0.1485174
floor       0.1967536  0.2811902 0.6997174 0.5153111

$`LAC QUI PARLE`
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  2.7788193        NaN     NaN      NaN
floor       -0.3452059        NaN     NaN      NaN

$LAKE
               Estimate Std. Error     t value  Pr(&gt;|t|)
(Intercept)  0.41928058  0.2916028  1.43784806 0.1936387
floor       -0.08280834  0.8748085 -0.09465882 0.9272385

$`LAKE OF THE WOODS`
              Estimate Std. Error    t value   Pr(&gt;|t|)
(Intercept)  1.7730816  0.4113441  4.3104578 0.04983239
floor       -0.4829732  0.5817285 -0.8302381 0.49372856

$`LE SUEUR`
              Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.6674557  0.2952783  5.6470648 0.0109907
floor       -0.2088407  0.6602624 -0.3162996 0.7725055

$LINCOLN
             Estimate Std. Error   t value   Pr(&gt;|t|)
(Intercept)  2.439195  0.2302042 10.595787 0.00878978
floor       -1.158261  0.4604084 -2.515725 0.12829396

$LYON
              Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept) 1.88533311  0.1295680 14.5509141 6.608367e-06
floor       0.06057704  0.3664737  0.1652971 8.741389e-01

$MAHNOMEN
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.386294        NaN     NaN      NaN

$MARSHALL
             Estimate Std. Error   t value    Pr(&gt;|t|)
(Intercept)  2.561063  0.4109894  6.231458 0.000431844
floor       -2.349505  0.5514002 -4.260980 0.003742063

$MARTIN
             Estimate Std. Error   t value   Pr(&gt;|t|)
(Intercept)  1.261558  0.4379149  2.880829 0.03455463
floor       -1.772384  1.1586140 -1.529745 0.18663165

$MCLEOD
            Estimate Std. Error   t value    Pr(&gt;|t|)
(Intercept)  1.41660  0.4532044  3.125743 0.009650643
floor       -1.00434  0.8170259 -1.229263 0.244619864

$MEEKER
            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept) 1.246403  0.2144073 5.81325 0.00435826

$`MILLE LACS`
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  1.757858        NaN     NaN      NaN
floor       -2.268684        NaN     NaN      NaN

$MORRISON
              Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept) 1.10076696  0.1414329 7.78296087 0.0001086026
floor       0.03063515  0.4242988 0.07220182 0.9444609721

$MOWER
             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.868281  0.2164616  8.631003 3.151241e-06
floor       -1.608884  0.5518709 -2.915326 1.405449e-02

$MURRAY
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 2.501436        NaN     NaN      NaN

$NICOLLET
            Estimate Std. Error  t value    Pr(&gt;|t|)
(Intercept)  2.17788  0.2747919 7.925561 0.004188265

$NOBLES
            Estimate Std. Error  t value    Pr(&gt;|t|)
(Intercept)  1.94256   0.174375 11.14013 0.007961754

$NORMAN
             Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.317381   0.786753  1.6744535 0.3427340
floor       -0.786753   1.362696 -0.5773503 0.6666667

$OLMSTED
             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.418247  0.1332929 10.640079 6.466793e-10
floor       -1.280436  0.3690715 -3.469345 2.292105e-03

$`OTTER TAIL`
              Estimate Std. Error    t value    Pr(&gt;|t|)
(Intercept)  1.5072678  0.3796730  3.9699101 0.007367719
floor       -0.3364741  0.6200035 -0.5426972 0.606892873

$PENNINGTON
             Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  1.774952   1.591904  1.1149873 0.4654224
floor       -1.565597   1.949676 -0.8030038 0.5692823

$PINE
              Estimate Std. Error   t value   Pr(&gt;|t|)
(Intercept)  0.7850621  0.2099590  3.739121 0.02013646
floor       -0.5226978  0.5142924 -1.016344 0.36694149

$PIPESTONE
              Estimate Std. Error    t value   Pr(&gt;|t|)
(Intercept)  1.7801715  0.6005495  2.9642376 0.09745551
floor       -0.2985669  1.2010990 -0.2485781 0.82688267

$POLK
             Estimate Std. Error   t value   Pr(&gt;|t|)
(Intercept)  2.109018  0.2260994  9.327834 0.01129872
floor       -1.428530  0.3197529 -4.467605 0.04662535

$POPE
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept)  1.30687 0.05410679 24.15352 0.02634218

$RAMSEY
             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept) 1.1138555  0.1205031 9.2433774 2.766508e-10
floor       0.1920534  0.3935614 0.4879884 6.291057e-01

$REDWOOD
            Estimate Std. Error  t value  Pr(&gt;|t|)
(Intercept) 1.566563  0.3420360 4.580111 0.0195396
floor       1.468390  0.7648158 1.919926 0.1506485

$RENVILLE
             Estimate Std. Error   t value  Pr(&gt;|t|)
(Intercept) 1.2983731  0.5099157 2.5462504 0.2382405
floor       0.4765793  0.8831999 0.5396052 0.6849830

$RICE
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.8898836  0.1572914 12.015175 7.617432e-07
floor       -0.9735929  0.5216765 -1.866277 9.485992e-02

$ROCK
            Estimate Std. Error  t value Pr(&gt;|t|)
(Intercept) 1.335347   0.804719 1.659396 0.345271

$ROSEAU
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.6160405  0.2504941  6.451412 0.0000315381
floor       -0.5732809  0.3313725 -1.730019 0.1092370690

$SCOTT
             Estimate Std. Error   t value    Pr(&gt;|t|)
(Intercept) 1.5803090  0.3306398 4.7795487 0.000571829
floor       0.0984088  0.5960694 0.1650962 0.871863195

$SHERBURNE
            Estimate Std. Error t value     Pr(&gt;|t|)
(Intercept) 1.125083  0.1285304 8.75344 5.108578e-05

$SIBLEY
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 1.274867   0.272449 4.679285 0.01844028

$`ST LOUIS`
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  0.9006432 0.07373615 12.214406 1.910043e-22
floor       -0.5266817 0.19854065 -2.652765 9.122062e-03

$STEARNS
              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.5621387  0.1285913 12.148094 1.729603e-11
floor       -0.9642701  0.3214781 -2.999489 6.398007e-03

$STEELE
            Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept)  1.60398  0.1843442 8.701003 1.124659e-05

$STEVENS
            Estimate Std. Error  t value  Pr(&gt;|t|)
(Intercept)  1.80896  0.2829039 6.394257 0.0987612

$SWIFT
            Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 1.026733  0.2326495 4.413218 0.02158921

$TODD
             Estimate Std. Error   t value  Pr(&gt;|t|)
(Intercept) 1.3599894  0.5715320 2.3795506 0.2532717
floor       0.4482994  0.9899225 0.4528631 0.7292887

$TRAVERSE
              Estimate Std. Error   t value  Pr(&gt;|t|)
(Intercept)  2.0977276  0.4577005  4.583189 0.0444558
floor       -0.9991153  0.9154009 -1.091451 0.3890259

$WABASHA
             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  2.004397  0.1900894 10.544496 0.0001324981
floor       -1.822075  0.5029293 -3.622925 0.0151728276

$WADENA
              Estimate Std. Error   t value   Pr(&gt;|t|)
(Intercept)  1.4188211  0.3587093  3.955351 0.02884234
floor       -0.9334317  0.5671692 -1.645773 0.19836248

$WASECA
              Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)  0.7117831  0.8491977  0.8381829 0.4901389
floor       -0.7117831  1.6983955 -0.4190915 0.7158710

$WASHINGTON
             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.397728  0.1109225 12.600947 3.384577e-16
floor       -1.005195  0.3364445 -2.987699 4.583376e-03

$WATONWAN
              Estimate Std. Error   t value   Pr(&gt;|t|)
(Intercept)  2.6318888  0.4060815  6.481184 0.09745733
floor       -0.5868879  0.4973462 -1.180039 0.44754367

$WILKIN
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  2.24071        NaN     NaN      NaN

$WINONA
             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.955606  0.1563315 12.509352 7.579221e-08
floor       -1.986311  0.3254300 -6.103651 7.697271e-05

$WRIGHT
              Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept)  1.6749524  0.1636470 10.23515 5.857872e-07
floor       -0.7994836  0.5900377 -1.35497 2.025996e-01

$`YELLOW MEDICINE`
            Estimate Std. Error  t value  Pr(&gt;|t|)
(Intercept) 1.216807  0.1181944 10.29496 0.0616446</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="fragment">
<ul>
<li>Is this helpful for us?</li>
</ul>
</div>
</div>
</div>
</section><section id="example-radon-measurements-in-minnesota-6" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s visualize the point estimates and confidence intervals from all these models…</p>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="slides-1_files/figure-revealjs/radon%20forest%20plot-1.png" width="1920"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section id="example-radon-measurements-in-minnesota-7" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Now we’ll look at fitting with counties, but without removing the intercept</p>
<ul>
<li>AKA: “no pooling” of data</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># run OLS regression with county as covariate #</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>radon_cty_int_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_radon <span class="sc">~</span> floor <span class="sc">+</span> <span class="fu">factor</span>(county), <span class="at">data=</span>radon.mn)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">summary</span>(radon_cty_int_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_radon ~ floor + factor(county), data = radon.mn)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1794 -0.4449 -0.0065  0.4406  2.6083 

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      0.88724    0.36370   2.439  0.01492 *  
floor                           -0.68923    0.07062  -9.760  &lt; 2e-16 ***
factor(county)ANOKA              0.04337    0.37723   0.115  0.90850    
factor(county)BECKER             0.66225    0.55568   1.192  0.23369    
factor(county)BELTRAMI           0.69991    0.45595   1.535  0.12515    
factor(county)BENTON             0.56730    0.51374   1.104  0.26980    
factor(county)BIG STONE          0.64955    0.55519   1.170  0.24235    
factor(county)BLUE EARTH         1.13764    0.41198   2.761  0.00588 ** 
factor(county)BROWN              1.10882    0.51404   2.157  0.03129 *  
factor(county)CARLTON            0.15844    0.42996   0.368  0.71260    
factor(county)CARVER             0.67877    0.46931   1.446  0.14847    
factor(county)CASS               0.54085    0.48770   1.109  0.26776    
factor(county)CHIPPEWA           0.86861    0.51404   1.690  0.09145 .  
factor(county)CHISAGO            0.19748    0.46931   0.421  0.67402    
factor(county)CLAY               1.11870    0.41192   2.716  0.00675 ** 
factor(county)CLEARWATER         0.48106    0.51404   0.936  0.34963    
factor(county)COOK              -0.16970    0.62945  -0.270  0.78753    
factor(county)COTTONWOOD         0.37977    0.51495   0.737  0.46104    
factor(county)CROW WING          0.27276    0.41947   0.650  0.51570    
factor(county)DAKOTA             0.48478    0.37486   1.293  0.19628    
factor(county)DODGE              0.92958    0.55519   1.674  0.09443 .  
factor(county)DOUGLAS            0.86332    0.43671   1.977  0.04838 *  
factor(county)FARIBAULT         -0.10877    0.46902  -0.232  0.81666    
factor(county)FILLMORE           0.53209    0.62945   0.845  0.39817    
factor(county)FREEBORN           1.22567    0.43660   2.807  0.00511 ** 
factor(county)GOODHUE            1.07757    0.41198   2.616  0.00907 ** 
factor(county)HENNEPIN           0.50555    0.37027   1.365  0.17250    
factor(county)HOUSTON            0.89971    0.46902   1.918  0.05541 .  
factor(county)HUBBARD            0.38868    0.48800   0.796  0.42599    
factor(county)ISANTI             0.20364    0.55519   0.367  0.71386    
factor(county)ITASCA             0.08265    0.42458   0.195  0.84571    
factor(county)JACKSON            1.14926    0.48770   2.356  0.01868 *  
factor(county)KANABEC            0.38164    0.51404   0.742  0.45804    
factor(county)KANDIYOHI          1.18859    0.51404   2.312  0.02101 *  
factor(county)KITTSON            0.72957    0.55568   1.313  0.18957    
factor(county)KOOCHICHING       -0.01811    0.45595  -0.040  0.96832    
factor(county)LAC QUI PARLE      2.06359    0.62945   3.278  0.00109 ** 
factor(county)LAKE              -0.40058    0.43671  -0.917  0.35926    
factor(county)LAKE OF THE WOODS  0.98897    0.51404   1.924  0.05471 .  
factor(county)LE SUEUR           0.87629    0.48739   1.798  0.07255 .  
factor(county)LINCOLN            1.43469    0.51374   2.793  0.00535 ** 
factor(county)LYON               1.09182    0.44500   2.454  0.01435 *  
factor(county)MAHNOMEN           0.49905    0.81249   0.614  0.53923    
factor(county)MARSHALL           0.75144    0.43713   1.719  0.08598 .  
factor(county)MARTIN             0.21958    0.45545   0.482  0.62985    
factor(county)MCLEOD             0.43240    0.41544   1.041  0.29825    
factor(county)MEEKER             0.35916    0.48770   0.736  0.46167    
factor(county)MILLE LACS         0.08089    0.62945   0.129  0.89778    
factor(county)MORRISON           0.29351    0.43671   0.672  0.50171    
factor(county)MOWER              0.83955    0.41547   2.021  0.04363 *  
factor(county)MURRAY             1.61419    0.81249   1.987  0.04728 *  
factor(county)NICOLLET           1.29064    0.51404   2.511  0.01224 *  
factor(county)NOBLES             1.05532    0.55519   1.901  0.05767 .  
factor(county)NORMAN             0.39763    0.55494   0.717  0.47386    
factor(county)OLMSTED            0.45389    0.39368   1.153  0.24927    
factor(county)OTTER TAIL         0.75231    0.44500   1.691  0.09129 .  
factor(county)PENNINGTON         0.30346    0.55568   0.546  0.58514    
factor(county)PINE              -0.07443    0.46902  -0.159  0.87396    
factor(county)PIPESTONE          0.99059    0.51374   1.928  0.05417 .  
factor(county)POLK               0.85212    0.51404   1.658  0.09776 .  
factor(county)POPE               0.41963    0.62945   0.667  0.50518    
factor(county)RAMSEY             0.30923    0.38546   0.802  0.42264    
factor(county)REDWOOD            1.11084    0.48739   2.279  0.02291 *  
factor(county)RENVILLE           0.79973    0.55494   1.441  0.14992    
factor(county)RICE               0.97679    0.42436   2.302  0.02159 *  
factor(county)ROCK               0.44811    0.62945   0.712  0.47673    
factor(county)ROSEAU             0.79505    0.41253   1.927  0.05429 .  
factor(county)SCOTT              0.93542    0.41544   2.252  0.02460 *  
factor(county)SHERBURNE          0.23784    0.44526   0.534  0.59337    
factor(county)SIBLEY             0.38762    0.51404   0.754  0.45102    
factor(county)ST LOUIS           0.03582    0.36957   0.097  0.92281    
factor(county)STEARNS            0.63089    0.39131   1.612  0.10728    
factor(county)STEELE             0.71674    0.43019   1.666  0.09607 .  
factor(county)STEVENS            0.92172    0.62945   1.464  0.14348    
factor(county)SWIFT              0.13949    0.51404   0.271  0.78618    
factor(county)TODD               0.85192    0.55494   1.535  0.12512    
factor(county)TRAVERSE           1.13301    0.51374   2.205  0.02770 *  
factor(county)WABASHA            0.95532    0.45545   2.098  0.03625 *  
factor(county)WADENA             0.43390    0.48749   0.890  0.37369    
factor(county)WASECA            -0.18110    0.51374  -0.353  0.72455    
factor(county)WASHINGTON         0.47614    0.37887   1.257  0.20920    
factor(county)WATONWAN           1.81287    0.55568   3.262  0.00115 ** 
factor(county)WILKIN             1.35347    0.81249   1.666  0.09612 .  
factor(county)WINONA             0.76904    0.41542   1.851  0.06449 .  
factor(county)WRIGHT             0.77923    0.41560   1.875  0.06115 .  
factor(county)YELLOW MEDICINE    0.32956    0.62945   0.524  0.60071    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7265 on 833 degrees of freedom
Multiple R-squared:  0.2865,    Adjusted R-squared:  0.2137 
F-statistic: 3.936 on 85 and 833 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>What changed from the last regression? The first regression?</li>
</ul>
</div>
</section><section id="example-radon-measurements-in-minnesota-8" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Finally we’ll fit with counties, and without an intercept</p>
<ul>
<li>Another example of a “no pooling” analysis</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># run OLS regression with county as covariate and removing global intercept #</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>radon_cty_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_radon <span class="sc">~</span> floor <span class="sc">+</span> <span class="fu">factor</span>(county) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data=</span>radon.mn)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">summary</span>(radon_cty_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_radon ~ floor + factor(county) - 1, data = radon.mn)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1794 -0.4449 -0.0065  0.4406  2.6083 

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
floor                           -0.68923    0.07062  -9.760  &lt; 2e-16 ***
factor(county)AITKIN             0.88724    0.36370   2.439 0.014915 *  
factor(county)ANOKA              0.93061    0.10084   9.229  &lt; 2e-16 ***
factor(county)BECKER             1.54949    0.42210   3.671 0.000257 ***
factor(county)BELTRAMI           1.58715    0.27756   5.718 1.50e-08 ***
factor(county)BENTON             1.45454    0.36370   3.999 6.92e-05 ***
factor(county)BIG STONE          1.53679    0.41947   3.664 0.000264 ***
factor(county)BLUE EARTH         2.02488    0.19444  10.414  &lt; 2e-16 ***
factor(county)BROWN              1.99607    0.36498   5.469 5.99e-08 ***
factor(county)CARLTON            1.04568    0.22986   4.549 6.19e-06 ***
factor(county)CARVER             1.56601    0.29870   5.243 2.01e-07 ***
factor(county)CASS               1.42809    0.32492   4.395 1.25e-05 ***
factor(county)CHIPPEWA           1.75585    0.36327   4.833 1.60e-06 ***
factor(county)CHISAGO            1.08472    0.29661   3.657 0.000271 ***
factor(county)CLAY               2.00594    0.19522  10.275  &lt; 2e-16 ***
factor(county)CLEARWATER         1.36830    0.36498   3.749 0.000190 ***
factor(county)COOK               0.71754    0.51374   1.397 0.162876    
factor(county)COTTONWOOD         1.26701    0.36711   3.451 0.000586 ***
factor(county)CROW WING          1.16000    0.21048   5.511 4.75e-08 ***
factor(county)DAKOTA             1.37202    0.09165  14.971  &lt; 2e-16 ***
factor(county)DODGE              1.81683    0.41947   4.331 1.66e-05 ***
factor(county)DOUGLAS            1.75056    0.24231   7.225 1.14e-12 ***
factor(county)FARIBAULT          0.77847    0.29684   2.623 0.008888 ** 
factor(county)FILLMORE           1.41933    0.51495   2.756 0.005975 ** 
factor(county)FREEBORN           2.11291    0.24269   8.706  &lt; 2e-16 ***
factor(county)GOODHUE            1.96481    0.19444  10.105  &lt; 2e-16 ***
factor(county)HENNEPIN           1.39279    0.07129  19.538  &lt; 2e-16 ***
factor(county)HOUSTON            1.78696    0.29754   6.006 2.84e-09 ***
factor(county)HUBBARD            1.27592    0.32767   3.894 0.000107 ***
factor(county)ISANTI             1.09088    0.41947   2.601 0.009470 ** 
factor(county)ITASCA             0.96989    0.21906   4.427 1.08e-05 ***
factor(county)JACKSON            2.03650    0.32492   6.268 5.87e-10 ***
factor(county)KANABEC            1.26888    0.36327   3.493 0.000503 ***
factor(county)KANDIYOHI          2.07583    0.36327   5.714 1.53e-08 ***
factor(county)KITTSON            1.61681    0.42210   3.830 0.000138 ***
factor(county)KOOCHICHING        0.86913    0.27756   3.131 0.001801 ** 
factor(county)LAC QUI PARLE      2.95083    0.51495   5.730 1.40e-08 ***
factor(county)LAKE               0.48666    0.24231   2.008 0.044918 *  
factor(county)LAKE OF THE WOODS  1.87621    0.36498   5.141 3.42e-07 ***
factor(county)LE SUEUR           1.76353    0.32523   5.422 7.70e-08 ***
factor(county)LINCOLN            2.32194    0.36370   6.384 2.86e-10 ***
factor(county)LYON               1.97906    0.25702   7.700 3.86e-14 ***
factor(county)MAHNOMEN           1.38629    0.72654   1.908 0.056725 .  
factor(county)MARSHALL           1.63869    0.24534   6.679 4.39e-11 ***
factor(county)MARTIN             1.10682    0.27479   4.028 6.14e-05 ***
factor(county)MCLEOD             1.31964    0.20267   6.511 1.29e-10 ***
factor(county)MEEKER             1.24640    0.32492   3.836 0.000134 ***
factor(county)MILLE LACS         0.96813    0.51495   1.880 0.060452 .  
factor(county)MORRISON           1.18075    0.24231   4.873 1.32e-06 ***
factor(county)MOWER              1.72680    0.20180   8.557  &lt; 2e-16 ***
factor(county)MURRAY             2.50144    0.72654   3.443 0.000604 ***
factor(county)NICOLLET           2.17788    0.36327   5.995 3.03e-09 ***
factor(county)NOBLES             1.94256    0.41947   4.631 4.22e-06 ***
factor(county)NORMAN             1.28487    0.42013   3.058 0.002297 ** 
factor(county)OLMSTED            1.34113    0.15177   8.836  &lt; 2e-16 ***
factor(county)OTTER TAIL         1.63955    0.25823   6.349 3.56e-10 ***
factor(county)PENNINGTON         1.19071    0.42210   2.821 0.004903 ** 
factor(county)PINE               0.81282    0.29684   2.738 0.006309 ** 
factor(county)PIPESTONE          1.87784    0.36370   5.163 3.04e-07 ***
factor(county)POLK               1.73937    0.36498   4.766 2.22e-06 ***
factor(county)POPE               1.30687    0.51374   2.544 0.011144 *  
factor(county)RAMSEY             1.19648    0.12861   9.303  &lt; 2e-16 ***
factor(county)REDWOOD            1.99809    0.32523   6.144 1.25e-09 ***
factor(county)RENVILLE           1.68698    0.42013   4.015 6.47e-05 ***
factor(county)RICE               1.86403    0.21915   8.506  &lt; 2e-16 ***
factor(county)ROCK               1.33535    0.51374   2.599 0.009508 ** 
factor(county)ROSEAU             1.68230    0.19832   8.483  &lt; 2e-16 ***
factor(county)SCOTT              1.82266    0.20267   8.993  &lt; 2e-16 ***
factor(county)SHERBURNE          1.12508    0.25687   4.380 1.34e-05 ***
factor(county)SIBLEY             1.27487    0.36327   3.509 0.000473 ***
factor(county)ST LOUIS           0.92306    0.06816  13.543  &lt; 2e-16 ***
factor(county)STEARNS            1.51813    0.14575  10.416  &lt; 2e-16 ***
factor(county)STEELE             1.60398    0.22975   6.981 5.97e-12 ***
factor(county)STEVENS            1.80896    0.51374   3.521 0.000453 ***
factor(county)SWIFT              1.02673    0.36327   2.826 0.004821 ** 
factor(county)TODD               1.73917    0.42013   4.140 3.83e-05 ***
factor(county)TRAVERSE           2.02026    0.36370   5.555 3.74e-08 ***
factor(county)WABASHA            1.84256    0.27479   6.705 3.71e-11 ***
factor(county)WADENA             1.32114    0.32614   4.051 5.58e-05 ***
factor(county)WASECA             0.70614    0.36370   1.942 0.052527 .  
factor(county)WASHINGTON         1.36338    0.10740  12.695  &lt; 2e-16 ***
factor(county)WATONWAN           2.70012    0.42210   6.397 2.64e-10 ***
factor(county)WILKIN             2.24071    0.72654   3.084 0.002109 ** 
factor(county)WINONA             1.65628    0.20216   8.193 9.58e-16 ***
factor(county)WRIGHT             1.66647    0.20158   8.267 5.40e-16 ***
factor(county)YELLOW MEDICINE    1.21681    0.51374   2.369 0.018087 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7265 on 833 degrees of freedom
Multiple R-squared:  0.7892,    Adjusted R-squared:  0.7675 
F-statistic: 36.27 on 86 and 833 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>What changed from the last regression?</li>
</ul>
</div>
</section><section id="example-radon-measurements-in-minnesota-9" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s look at the estimated effects for Cook (very insignificant county effect) and Hennepin (Minneapolis) counties</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># get regression summary just for effects of floor, Cook county, and Hennepin county #</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">summary</span>(radon_cty_lm)<span class="sc">$</span>coeff[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">17</span>,<span class="dv">27</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Estimate Std. Error   t value     Pr(&gt;|t|)
floor                  -0.6892278 0.07061897 -9.759812 2.222631e-21
factor(county)COOK      0.7175423 0.51374155  1.396699 1.628761e-01
factor(county)HENNEPIN  1.3927949 0.07128800 19.537579 2.860795e-70</code></pre>
</div>
</div>
<div class="cell columns column-output-location" data-layout-align="center">
<div class="column">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># create density plot of log radon for Cook and Hennepin counties by floor #</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>radon.mn <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>( county <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"COOK"</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>                                <span class="st">"HENNEPIN"</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>floor,<span class="at">y=</span>log_radon))<span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>   <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>   <span class="fu">facet_grid</span>(<span class="at">cols=</span><span class="fu">vars</span>(county))<span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>   <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="slides-1_files/figure-revealjs/radon%20cook%20plots-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Should we put the same level of trust in those county-specific effects?</li>
</ul>
</div>
</section><section id="example-radon-measurements-in-minnesota-10" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Now let’s do a county-level analysis</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># find county-level average log radon and floor variables, create new dataset just at the county level #</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>radon.mn.ctylvl <span class="ot">&lt;-</span> radon.mn <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3"></a>   <span class="fu">group_by</span>(county) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4"></a>   <span class="fu">mutate</span>(<span class="at">log_radon_mean =</span> <span class="fu">mean</span>(log_radon, <span class="at">na.rm=</span>T),</span>
<span id="cb17-5"><a href="#cb17-5"></a>          <span class="at">floor_prop =</span> <span class="fu">mean</span>(floor, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6"></a>   <span class="fu">select</span>(<span class="fu">c</span>(county, log_radon_mean, floor_prop)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7"></a>   unique</span>
<span id="cb17-8"><a href="#cb17-8"></a></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co"># run county-level OLS regression #</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>radon_ctylvl_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_radon_mean <span class="sc">~</span> floor_prop, <span class="at">data=</span>radon.mn.ctylvl)</span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="fu">summary</span>(radon_ctylvl_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_radon_mean ~ floor_prop, data = radon.mn.ctylvl)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.01708 -0.32299 -0.03405  0.33096  1.35077 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.47622    0.07139  20.677   &lt;2e-16 ***
floor_prop  -0.44156    0.23326  -1.893   0.0618 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4618 on 83 degrees of freedom
Multiple R-squared:  0.04139,   Adjusted R-squared:  0.02984 
F-statistic: 3.583 on 1 and 83 DF,  p-value: 0.06184</code></pre>
</div>
</div>
<ul>
<li>How would we interpret these results? How are they different from the results from our other strategies?</li>
</ul>
</div>
</section><section id="problems" class="slide level2"><h2>Problems</h2>
<p>What did we find?</p>
<ul>
<li><p>Radon data clearly clustered by county, affecting distribution of log(radon) measurements, proportion of houses with/without basements, and number of observations</p></li>
<li><p>Effect of measurement floor changes depending on whether and how accounting for clustering</p></li>
</ul>
<div class="fragment">
<ul>
<li>Adding county as covariate to regression (“no pooling” analysis) seems like best solution… <span class="fragment">or not…</span>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>
<p>Violates a regression assumption that the number of parameters shouldn’t be growing with the amount of data</p>
<ul>
<li>Big issue when cluster sizes are small with respect to number of clusters</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>
<p>Each county-specific intercept estimated only using data from that count</p>
<ul>
<li>Even if that county has very few observations</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>May need a different solution…</li>
</ul>
<p><img src="POPUHEALSMPH_color-flush.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="slides-1_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="slides-1_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="slides-1_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="slides-1_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="slides-1_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="slides-1_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="slides-1_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="slides-1_files/libs/revealjs/plugin/notes/notes.js"></script><script src="slides-1_files/libs/revealjs/plugin/search/search.js"></script><script src="slides-1_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="slides-1_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>