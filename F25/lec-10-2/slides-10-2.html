<!DOCTYPE html>
<html lang="en"><head>
<script src="slides-10-2_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides-10-2_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides-10-2_files/libs/quarto-html/popper.min.js"></script>
<script src="slides-10-2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides-10-2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides-10-2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides-10-2_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="slides-10-2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<title>slides-10-2</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="slides-10-2_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="slides-10-2_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="slides-10-2_files/libs/revealjs/dist/theme/quarto.css">
<link href="slides-10-2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="slides-10-2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="slides-10-2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="slides-10-2_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="slides-10-2_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="slides-10-2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2"><h1>
Lecture 10.2: Kaplan-Meier estimator &amp; logrank tests
</h1>
<h2>
PHS 651: Advanced regression methods
</h2>
<hr>
<h3>
Mary Ryan Baumann, PhD
</h3>
<h3>
November 13, 2025
</h3>
<p><br></p>
<div style="font-size: 75%;">
<p><strong>Recording disclosure</strong></p>
<p><em>This class is being conducted in person, as well as over <span class="alert">Zoom</span>. As the instructor, I will be <span class="alert">recording</span> this session. I have disabled the recording feature for others so that no one else will be able to record this session. I will be posting this session to the course’s website.</em></p>
<p><em>If you have privacy concerns and do not wish to appear in the recording, you may turn video off (click “stop video”) so that Zoom does not record you.</em></p>
<p><em>The chat box is always open for discussion and questions to the entire class. You may also send messages privately to the instructor. Please note that Zoom saves all chat transcripts.</em></p>
</div>
<div class="absolute" style="left: 260px; bottom: 100px; width: 1500px; ">
<p>Slides found at: <a href="https://maryryan.github.io/PHS-651-slides/F25/lec-10-2/slides-10-2" class="uri">https://maryryan.github.io/PHS-651-slides/F25/lec-10-2/slides-10-2</a></p>
</div>
<div class="absolute" style="left: 100px; bottom: 50px; width: 150px; ">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-10-2_files/figure-revealjs/qr%20code-1.png" width="192"></p>
</div>
</div>
</div>
</section><section id="roadmap" class="slide level2"><h2>Roadmap</h2>
<ul>
<li><p>Recap from last class</p></li>
<li>
<p>Estimating <span class="math inline">\(S(t)\)</span> without a probability distribution (non-parametrically)</p>
<ul>
<li><p>When we don’t have censoring</p></li>
<li><p>When we do have censoring</p></li>
</ul>
</li>
<li><p>Confidence intervals for <span class="math inline">\(S(t)\)</span></p></li>
<li><p>Survival curves</p></li>
<li><p>Logrank tests: testing difference between survival curves</p></li>
</ul></section><section id="recap-time-to-event-data" class="slide level2"><h2>Recap: Time-to-event data</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Last time we introduced the idea of <span class="alert">time-to-event data</span>, which is characterized by:</p>
<ul>
<li><p>Whether an individual experience an <span class="alert">event</span></p></li>
<li><p>If yes, the <span class="alert">time</span> that event happened</p></li>
<li><p>If no, how long were they observed for</p></li>
<li><p>The presence of <span class="alert">censoring</span></p></li>
</ul>
<p><br></p>
<p>We also discussed how to measure time to an event:</p>
<ul>
<li><p>Time origin: time to event from when the “research question” clock starts</p></li>
<li><p>Entry to study: time to event from when someone first enters your study</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="timeOrigin.png" style="width:100.0%"></p>
</div>
</div>
</section><section id="recap-describing-time-to-event-data" class="slide level2"><h2>Recap: Describing time-to-event data</h2>
<p>We also talked about the ways we can describe survival time</p>
<ul>
<li><p>The <span class="alert">survival function</span> <span class="math inline">\(S(t) = P(T&gt;t)\)</span>: the probability that a event happens after time <span class="math inline">\(t\)</span></p></li>
<li><p>The <span class="alert">hazard function</span> <span class="math inline">\(\lambda(t) = \lambda(t) = \lim_{\delta \rightarrow 0} \frac{P(t\le T &lt; t + \delta | T \ge t)}{\delta}\)</span>: the instantaneous rate of an event happening</p></li>
<li><p>The <span class="alert">cumulative hazard function</span> <span class="math inline">\(\Lambda(t) = \int_0^t \lambda(u) du\)</span>: the rate of event occurrence over a period of time</p></li>
</ul>
<p><img data-src="surv-fnc.png" width="800"></p>
</section><section id="recap-describing-time-to-event-data-1" class="slide level2"><h2>Recap: Describing time-to-event data</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>We noted that we could assume that the survival time <span class="math inline">\(T\)</span> follows a <span class="alert">probability distribution</span>, and use that assumption to calculate <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(\lambda(t)\)</span>, and <span class="math inline">\(\Lambda(t)\)</span></p>
<ul>
<li>We specifically looked at the exponential and Weibull distributions</li>
</ul>
</div><div class="column" style="width:25%;">
<p><img data-src="exponential.png" width="700"></p>
</div><div class="column" style="width:25%;">
<p><img data-src="weibull.png" width="500"></p>
</div>
</div>
<p>However, if our assumption about the distribution is <span class="alert">incorrect</span>, this can lead to a <span class="alert">biased and inconsistent</span> estimate of <span class="math inline">\(S(t)\)</span></p>
<ul>
<li>This is bad because <span class="math inline">\(S(t)\)</span> is the main things we’re trying to estimate in survival analysis!</li>
</ul>
<p>Because of this, we want to try to estimate <span class="math inline">\(S(t)\)</span> in a <span class="alert">non-parametric</span> way…</p>
</section><section id="estimating-st" class="slide level2"><h2>Estimating <span class="math inline">\(S(t)\)</span>
</h2>
<p>Using this data, how would we estimate <span class="math inline">\(S(t) = P(T&gt;t)\)</span> at t=1 and t=2?</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="estimating-S.png" width="1000"></p>
</div><div class="column" style="width:50%;">
<p><span class="math inline">\(P(T&gt;1) = \frac{\text{# alive at 1 year}}{\text{# "at risk"}}=\)</span><span class="fragment" data-fragment-index="1"><span class="math inline">\(8/10=0.8\)</span></span></p>
<div class="fragment" data-fragment-index="1">
<p>What about <span class="math inline">\(P(T&gt;2)\)</span>?</p>
<ul>
<li>We could use the “full” sample and look at <span class="math inline">\(\frac{\text{# with no event at 2 year}}{\text{# "at risk" since time 0}}\)</span>
</li>
</ul>
</div>
<div class="fragment" data-fragment-index="1">
<ul>
<li>Or we could use a “reduced” sample that only looks at <span class="math inline">\(\frac{\text{# alive past 2 year}}{\text{# with complete data at 2 years}}\)</span>
</li>
</ul>
</div>
<div class="fragment" data-fragment-index="2">
<table>
<thead><tr class="header">
<th></th>
<th>P(T&gt;1)</th>
<th>P(T&gt;2)</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>“Full” sample</td>
<td>8/10 = 0.8</td>
<td>6/10 = 0.6</td>
<td>(too high)</td>
</tr>
<tr class="even">
<td>“Reduced” sample</td>
<td>8/10 = 0.8</td>
<td>4/8 = 0.5</td>
<td>(too variable)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="fragment absolute" data-fragment-index="2" style="left: -10px; bottom: 100px; width: 50%; ">
<p>The “full” sample takes anyone who was censored and <span class="alert">carries their last observation forward</span></p>
<p>The “reduced” sample <span class="alert">ignores</span> anyone who dropped out</p>
</div>
</section><section id="estimating-st-1" class="slide level2"><h2>Estimating <span class="math inline">\(S(t)\)</span>
</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="estimating-S.png" width="1000"></p>
</div><div class="column" style="width:50%;">
<p>Alternatively, we could also use conditional probability!</p>
<p><span class="math display">\[\begin{align*}P(T&gt;2) &amp;= P(T&gt;2 | T&gt;1) \times P(T&gt;1)\\
&amp;=\frac{\text{# alive past 2 years}}{\text{# observed &gt; 2 years, alive at 1 year}}\\
&amp;~~~~~~~\times \frac{\text{# alive at 1 year}}{\text{# observed at 1 year}}\\
&amp;= \frac{4}{6} \times \frac{8}{10}\\
&amp;= 0.53\end{align*}\]</span></p>
</div>
</div>
<div class="absolute" style="left: 0px; bottom: 75px; width: 75%; ">
<p>Compared to:</p>
<table>
<thead><tr class="header">
<th></th>
<th>P(T&gt;1)</th>
<th>P(T&gt;2)</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>“Full” sample</td>
<td>8/10 = 0.8</td>
<td>6/10 = 0.6</td>
<td>(too high)</td>
</tr>
<tr class="even">
<td>“Reduced” sample</td>
<td>8/10 = 0.8</td>
<td>4/8 = 0.5</td>
<td>(too variable)</td>
</tr>
</tbody>
</table>
</div>
</section><section id="life-table-estimates" class="slide level2"><h2>Life table estimates</h2>
<p>But what happens when we have <span class="alert">censoring</span>?</p>
<p>Consider some data from the 6-MP leukemia trial we discussed in lecture 10.1</p>
<ul>
<li>The essential data are the 21 ordered times (in months) to relapse or <u>censoring</u> (time with “+” next to it): 6, 6, 6, 7, 10, 13, 16, 22, 23, 6+, 9+, 10+, 11+, 17+, 19+, 20+, 25+, 32+, 32+, 34+, 35+</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>We can organize these times into intervals:</li>
</ul>
<table>
<thead><tr class="header">
<th>Interval</th>
<th>Beginning total</th>
<th># lost</th>
<th># relapsed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(0 - 5]</td>
<td>21</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>(5 - 10]</td>
<td>21</td>
<td>3</td>
<td>5</td>
</tr>
<tr class="odd">
<td>(10 - 15]</td>
<td>13</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>(15 - 20]</td>
<td>11</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="odd">
<td>(20 - 25]</td>
<td>7</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>(25 - 30]</td>
<td>4</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>(30 - 35]</td>
<td>4</td>
<td>4</td>
<td>0</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:50%;">
<p>How do we account for censoring when estimating <span class="math inline">\(S(t)\)</span>?</p>
<!-- - Could adjust the beginning totals for censoring -->
<!--    - Assume censoring occurs [uniformly]{.alert} throughout the interval $\Rightarrow$ censored participants are at risk for half the interval (on average) -->
<!-- - [Adjusted total at risk]{.alert} in an interval is then: -->
<!-- $$\begin{align*}\text{Adju. total} &= (\text{Uncens. total}) + (\text{# lost})/2\\ -->
<!-- & = (\text{Beg. total}) - (\text{# lost}) + (\text{# lost})/2\\ -->
<!-- & = (\text{Beg. total}) - (\text{# lost})/2\end{align*}$$ -->
</div>
</div>
<!-- --- -->

<!-- ## Life table estimates -->
<!-- :::: {.columns} -->
<!-- ::: {.column width="50%"} -->
<!-- This gets us: -->
<!-- | Interval | Beginning total | # lost | Adju. total | # relapsed | -->
<!-- |---------|----------|---------|---------| -->
<!-- | (0 - 5] | 21 | 0 | 21 | 0 | -->
<!-- | (5 - 10] | 21 | 3 | 19.5 | 5 | -->
<!-- | (10 - 15] | 13 | 1 | 12.5 | 1 | -->
<!-- | (15 - 20] | 11 | 3 | 9.5 | 1 | -->
<!-- | (20 - 25] | 7 | 1 | 6.5 | 2 | -->
<!-- | (25 - 30] | 4 | 0 | 4 | 0 | -->
<!-- | (30 - 35] | 4 | 4 | 2 | 0 | -->
<!-- ::: -->
<!-- ::: {.column width="50%"} -->
<!-- Then we can compute the survival proportion for each interval: -->
<!-- $$(0 - 5]: \frac{21-0}{21} = 1$$ -->
<!-- $$(5 - 10]: \frac{19.5-5}{19.5} = 14.5/19.5 = 0.74 \Rightarrow $$ 75% of those not relapsed at the end of month 5 have not relapsed by the end of the 10th month -->
<!-- ::: {.fragment} -->
<!-- $$(10 - 15]: \frac{12.5-1}{12.5} = 11.5/12.5 = 0.92 \Rightarrow $$ 92% of those not relapsed at the end of month 10 have not relapsed by the end of the 15th month -->
<!-- ::: -->
<!-- ::: -->
<!-- :::: -->
<!-- --- -->

<!-- ## Life table estimates -->
<!-- Then we can use conditional probability to compute the surviving proportions -->
<!-- $$P(T > 10) = P(T>5) \times \frac{P(T>10)}{P(T>5)} = 1 \times 0.74 = 0.74$$ -->
<!-- $$P(T > 15) = P(T>5) \times \frac{P(T>10)}{P(T>5)} \times \frac{P(T>15)}{P(T>10)} = 1 \times 0.74 \times 0.92 = 0.68$$ -->
<!-- --- -->

<!-- ## Life table estimates -->
<!-- Which gets us: -->
<!-- | Interval | Beginning total | # lost | Adju. total | # relapsed | Cond. interval survival | Marg. survival| -->
<!-- |-------|------|-----|-----|-----|------|------| -->
<!-- | (0 - 5] | 21 | 0 | 21 | 0 | 1 | 1 | -->
<!-- | (5 - 10] | 21 | 3 | 19.5 | 5 | 0.7436 | 0.7436 | -->
<!-- | (10 - 15] | 13 | 1 | 12.5 | 1 | 0.92 | 0.6841 | -->
<!-- | (15 - 20] | 11 | 3 | 9.5 | 1 | 0.8947 | 0.6121 | -->
<!-- | (20 - 25] | 7 | 1 | 6.5 | 2 | 0.6923 | 0.4236 | -->
<!-- | (25 - 30] | 4 | 0 | 4 | 0 | 1 | 0.4236 | -->
<!-- | (30 - 35] | 4 | 4 | 2 | 0 | 1 | 0.4236 | -->
<!-- This method requires us to come up with the intervals [on our own]{.underline} -->
<!-- - Some of these intervals have no events or censoring, some have multiple -->
<!-- - Who's to say what's the correct interval? ... or is there a better way? -->
</section><section id="kaplan-meier-estimator-of-st" class="slide level2"><h2>Kaplan-Meier estimator of <span class="math inline">\(S(t)\)</span>
</h2>
<p>The <span class="alert">Kaplan-Meier estimator</span> of <span class="math inline">\(S(t)\)</span> considers the probability of survival a (very small) interval of time, given that an individual is at risk at the beginning of the interval</p>
<p><br></p>
<ul>
<li><p>Say we have <span class="math inline">\(D\)</span> total event times in a sample, and we can put them in order: <span class="math inline">\(t_1 &lt; t_2 &lt; \dots &lt; t_D\)</span></p></li>
<li><p><span class="math inline">\(d_i\)</span>: total number of <u>events</u> at time <span class="math inline">\(t_i\)</span></p></li>
<li><p><span class="math inline">\(s_i\)</span>: total number who <u>haven’t failed</u> by time <span class="math inline">\(t_i\)</span></p></li>
<li><p><span class="math inline">\(Y_i\)</span>: total number <u>at risk</u> at time <span class="math inline">\(t_i\)</span> (under observation, not failed)</p></li>
</ul>
<p><br></p>
<p>Total number of events at time <span class="math inline">\(t_i\)</span> is equal to total number at risk minus those who haven’t failed <span class="math display">\[d_i = Y_i - s_i\]</span></p>
</section><section id="km-estimator" class="slide level2"><h2>KM estimator</h2>
<p>The KM estimator calculates a conditional survival probability for each time interval in which <u>only 1 event occurs</u>, and then multiplies them together:</p>
<p><span class="math display">\[\begin{align*}\widehat{S}_{KM}(t) &amp;= P(T&gt;t)\\
&amp;= P(T&gt;t | T &gt; t_k) \times P(T&gt;t_k | T&gt;t_{k-1})\times \dots \times P(T&gt;t_1)\\
&amp;= \prod_{t_i \le t}\left[1-\frac{d_i}{Y_i}\right]\end{align*}\]</span></p>
<ul>
<li>We can just focus on the intervals where an event occurs because if the interval contains no event, the conditional surivival probability is approximately 1</li>
</ul></section><section id="example-6-mp" class="slide level2"><h2>Example: 6-MP</h2>
<p>Back to our 6-MP example, with event and censoring times: 6, 6, 6, 7, 10, 13, 16, 22, 23, 6+, 9+, 10+, 11+, 17+, 19+, 20+, 25+, 32+, 32+, 34+, 35+</p>
<table>
<colgroup>
<col style="width: 30%">
<col style="width: 26%">
<col style="width: 21%">
<col style="width: 21%">
</colgroup>
<thead><tr class="header">
<th><span class="math inline">\(t_i\)</span></th>
<th><span class="math inline">\(d_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\(\widehat{S}_{KM}(t)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>3</td>
<td>21</td>
<td><span class="fragment" data-fragment-index="1"><span class="math inline">\(1-\frac{3}{21}=0.857\)</span></span></td>
</tr>
<tr class="even">
<td>7</td>
<td>1</td>
<td>17</td>
<td><span class="fragment" data-fragment-index="2"><span class="math inline">\(0.857(1-\frac{1}{17})=0.807\)</span></span></td>
</tr>
<tr class="odd">
<td>10</td>
<td>1</td>
<td>15</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.807(1-\frac{1}{15})=0.753\)</span></span></td>
</tr>
<tr class="even">
<td>13</td>
<td>1</td>
<td>12</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.753(1-\frac{1}{12})=0.690\)</span></span></td>
</tr>
<tr class="odd">
<td>16</td>
<td>1</td>
<td>11</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.690(1-\frac{1}{11})=0.628\)</span></span></td>
</tr>
<tr class="even">
<td>22</td>
<td>1</td>
<td>7</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.628(1-\frac{1}{7})=0.538\)</span></span></td>
</tr>
<tr class="odd">
<td>23</td>
<td>1</td>
<td>6</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.538(1-\frac{1}{16})=0.448\)</span></span></td>
</tr>
</tbody>
</table></section><section id="example-6-mp-1" class="slide level2"><h2>Example: 6-MP</h2>
<!-- :::: {.columns} -->
<!-- ::: {.column width="50%"} -->
<p>If we were to wite our KM estimates in the style of a life table (which shows survival probabilities over intervals), this would look like:</p>
<table>
<thead><tr class="header">
<th><span class="math inline">\(t\)</span></th>
<th><span class="math inline">\(\widehat{S}_{KM}(t)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>[0 - 6)</td>
<td>0.857</td>
</tr>
<tr class="even">
<td>[6 - 7)</td>
<td>0.807</td>
</tr>
<tr class="odd">
<td>[7 - 10)</td>
<td>0.753</td>
</tr>
<tr class="even">
<td>[10 - 13)</td>
<td>0.690</td>
</tr>
<tr class="odd">
<td>[13 - 16)</td>
<td>0.628</td>
</tr>
<tr class="even">
<td>[16 - 22)</td>
<td>0.538</td>
</tr>
<tr class="odd">
<td>[22 - 23)</td>
<td>0.448</td>
</tr>
</tbody>
</table>
<!-- ::: --><!-- ::: {.column width="10%"} --><!-- ::: --><!-- ::: {.column width="40%"} --><!-- <br> --><!-- Compared to before: --><!-- | Interval | Marg. survival| --><!-- |-------|------| --><!-- | (0 - 5]  | 1 | --><!-- | (5 - 10] | 0.7436 | --><!-- | (10 - 15] | 0.6841 | --><!-- | (15 - 20] | 0.6121 | --><!-- | (20 - 25] | 0.4236 | --><!-- | (25 - 30] | 0.4236 | --><!-- | (30 - 35] | 0.4236 | --><!-- ::: --><!-- :::: --><p><br></p>
<p>We’ve estimated the survival function, but maybe we’d also like some confidence intervals around this probability…</p>
</section><section id="km-confidence-intervals" class="slide level2"><h2>KM confidence intervals</h2>
<p><span class="math inline">\(d_i\)</span>: total number of <u>events</u> at time <span class="math inline">\(t_i\)</span>; <span class="math inline">\(Y_i\)</span>: total number <u>at risk</u> at time <span class="math inline">\(t_i\)</span> (under observation, not failed)</p>
<div class="columns">
<div class="column" style="width:60%;">
<p>We can also estimate the variance and standard error of the KM estimator by:</p>
<p><span class="math display">\[\widehat{Var}\left[\widehat{S}_{KM}(t)\right] = \widehat{S}_{KM}(t)^2 \sum_{t_i \le t}\frac{d_i}{Y_i(Y_i - d_i)}\]</span></p>
<p><span class="math display">\[\widehat{SE}\left[\widehat{S}_{KM}(t)\right] = \sqrt{\widehat{Var}\left[\widehat{S}_{KM}(t)\right]} = \widehat{S}_{KM}(t) \sqrt{\sum_{t_i \le t}\frac{d_i}{Y_i(Y_i - d_i)}}\]</span></p>
</div><div class="column" style="width:40%;">
<p>This means we can construct <span class="math inline">\((1-\alpha)\times 100\)</span>% confidence intervals for <span class="math inline">\(S(t)\)</span>: <span class="math display">\[\widehat{S}_{KM}(t) \pm Z_{1-\alpha/2} \times \widehat{SE}_{KM}(t)\]</span></p>
</div>
</div>
<p><br></p>
<p>This formulation of a confidence interval for <span class="math inline">\(S(t)\)</span> could produce upper and lower bounds outside of [0,1]</p>
<ul>
<li>
<span class="math inline">\(S(t)\)</span> is a probability, so this is a problem!</li>
</ul></section><section id="km-confidence-intervals-1" class="slide level2"><h2>KM confidence intervals</h2>
<p>One way to avoid this is by using the <span class="alert">complementary log-log transformation</span></p>
<ul>
<li><p>Recall that the cumulative hazard function <span class="math inline">\(\Lambda(t)=-\log S(t)\)</span></p></li>
<li><p>So, the complementary log-log transformation looks at the log of the cumulative hazard:</p></li>
</ul>
<p><span class="math display">\[\log\left[-\log S(t)\right] = \log\left[\Lambda(t)\right]\]</span></p>
<p><br></p>
<p>Next we’ll build a confidence interval for <span class="math inline">\(\log\left[\widehat\Lambda(t)\right]\)</span> first, and then we’ll back-transform it to get the interval for <span class="math inline">\(\widehat{S}(t)\)</span></p>
</section><section id="km-confidence-intervals-2" class="slide level2"><h2>KM confidence intervals</h2>
<p><span class="alert">Complementary log-log transformation</span>: <span class="math inline">\(\log\left[-\log S(t)\right] = \log\left[\Lambda(t)\right]\)</span></p>
<p><br></p>
<p>The variance for <span class="math inline">\(\log\left[\widehat{\Lambda}(t)\right]\)</span> is: <span class="math display">\[Var\left[\log\left[\widehat{\Lambda}(t)\right]\right] = \frac{Var\left[\widehat S(t)\right]}{\left(\widehat S(t) \log\left[\widehat S(t)\right]\right)^2}\]</span></p>
<p><br></p>
<p>This means the confidence interval for <span class="math inline">\(\log\left[\widehat{\Lambda}(t)\right]\)</span> is: <span class="math display">\[\log\left[\widehat \Lambda(t)\right] \pm Z_{1-\alpha/2} \times \sqrt{ Var\left[\widehat S(t)\right]/\left(\widehat S(t) \log\left[\widehat S(t)\right]\right)^2}  \Rightarrow\log\left[\widehat \Lambda(t)\right] \pm Z_{1-\alpha/2} \times \widehat{SE}_{\Lambda}(t)\]</span></p>
</section><section id="km-confidence-intervals-3" class="slide level2"><h2>KM confidence intervals</h2>
<p><span class="alert">Complementary log-log transformation</span>: <span class="math inline">\(\log\left[-\log S(t)\right] = \log\left[\Lambda(t)\right]\)</span></p>
<p><br></p>
<p>This means the confidence interval for <span class="math inline">\(\log\left[\widehat{\Lambda}(t)\right]\)</span> is: <span class="math display">\[\log\left[\widehat \Lambda(t)\right] \pm Z_{1-\alpha/2} \times \sqrt{ Var\left[\widehat S(t)\right]/\left(\widehat S(t) \log\left[\widehat S(t)\right]\right)^2 } \Rightarrow\log\left[\widehat \Lambda(t)\right] \pm Z_{1-\alpha/2} \times \widehat{SE}_{\Lambda}(t)\]</span></p>
<p><br></p>
<p>If we use <span class="math inline">\(\widehat S_{KM}(t)\)</span> for every <span class="math inline">\(\widehat S(t)\)</span>, and back-transform the above to be a confidence interval around <span class="math inline">\(\widehat S_{KM}(t)\)</span>, we would get: <span class="math display">\[\left(\widehat S_{KM}(t)^{\exp\left\{Z_{1-\alpha/2} \times \widehat{SE}_{\Lambda}(t)\right\}}, ~ \widehat S_{KM}(t)^{\exp\left\{-Z_{1-\alpha/2} \times \widehat{SE}_{\Lambda}(t)\right\}}\right)\]</span></p>
</section><section id="nelson-aalen-estimator-of-lambdat" class="slide level2"><h2>Nelson-Aalen estimator of <span class="math inline">\(\Lambda(t)\)</span>
</h2>
<p>We can also use the KM estimator <span class="math inline">\(\widehat{S}_{KM}(t)\)</span> to get an estimate of the cumulative hazard function: <span class="math display">\[\widehat{\Lambda}_{KM}(t) = -\log\left[\widehat{S}_{KM}(t)\right]\]</span></p>
<ul>
<li>But this estimator can perform poorly when the sample size is small</li>
</ul>
<p><br></p>
<p>An alternative estimator of <span class="math inline">\(\Lambda(t)\)</span> is what we call the <span class="alert">Nelson-Aalen estimator</span>:</p>
<p><span class="math display">\[\tilde{\Lambda}_{NA}(t) = \sum_{t_i \le t}\frac{d_i}{Y_i}\]</span></p>
</section><section id="na-estimator" class="slide level2"><h2>NA estimator</h2>
<p>An alternative estimator of <span class="math inline">\(\Lambda(t)\)</span> is the <span class="alert">Nelson-Aalen estimator</span>:</p>
<p><span class="math display">\[\tilde{\Lambda}_{NA}(t) = \sum_{t_i \le t}\frac{d_i}{Y_i}\]</span></p>
<div class="columns">
<div class="column" style="width:60%;">
<p>The variance and standard error of the NA estimator are given by: <span class="math display">\[\widehat{Var}[\tilde{\Lambda}_{NA}(t)] = \sum_{t_i \le t}\frac{d_i}{Y_i^2}\]</span></p>
<p><span class="math display">\[\widehat{SE}[\tilde{\Lambda}_{NA}(t)] =  \sqrt{\widehat{Var}[\tilde{\Lambda}_{NA}(t)]} = \sqrt{\sum_{t_i \le t}\frac{d_i}{Y_i^2}}\]</span></p>
</div><div class="column" style="width:40%;">
<p>This means we can construct <span class="math inline">\((1-\alpha)\times 100\)</span>% confidence intervals for <span class="math inline">\(\Lambda(t)\)</span>: <span class="math display">\[\tilde{\Lambda}_{NA}(t) \pm Z_{1-\alpha/2} \times \widehat{SE}_{NA}(t)\]</span></p>
</div>
</div>
</section><section id="na-estimator-of-lambdat-and-st" class="slide level2"><h2>NA estimator of <span class="math inline">\(\Lambda(t)\)</span> and <span class="math inline">\(S(t)\)</span>
</h2>
<p><span class="math display">\[\tilde{\Lambda}_{NA}(t) = \sum_{t_i \le t}\frac{d_i}{Y_i}\]</span></p>
<p>Using the NA estimator of <span class="math inline">\(\Lambda(t)\)</span>, we can also construct an alternative estimator of the survival function, which we call the <span class="alert">Breslow estimator</span>: <span class="math display">\[\tilde{S}_{B}(t) = e^{-\tilde{\Lambda}_{NA}(t)}\]</span></p>
</section><section id="example-6-mp-2" class="slide level2"><h2>Example: 6-MP</h2>
<p><span class="math display">\[\widehat \Lambda_{KM}(t) = -\log[\widehat S_{KM}(t)], ~~ \tilde{\Lambda}_{NA}(t) = \sum_{t_i \le t}\frac{d_i}{Y_i}, ~~ \tilde S_{B}(t) = e^{-\tilde{\Lambda}_{NA}(t)}\]</span></p>
<p>Recall the 6-MP event and censoring times: 6, 6, 6, 7, 10, 13, 16, 22, 23, 6+, 9+, 10+, 11+, 17+, 19+, 20+, 25+, 32+, 32+, 34+, 35+</p>
<table>
<colgroup>
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th><span class="math inline">\(t_i\)</span></th>
<th><span class="math inline">\(d_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\(\widehat{S}_{KM}(t)\)</span></th>
<th><span class="math inline">\(\widehat\Lambda_{KM}(t)\)</span></th>
<th><span class="math inline">\(\tilde\Lambda_{NA}(t)\)</span></th>
<th><span class="math inline">\(\tilde S_{B}(t)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>3</td>
<td>21</td>
<td>0.857</td>
<td><span class="fragment" data-fragment-index="1"><span class="math inline">\(-\log(0.857)=0.154\)</span></span></td>
<td><span class="fragment" data-fragment-index="1"><span class="math inline">\(\frac{3}{21}=0.1428\)</span></span></td>
<td><span class="fragment" data-fragment-index="1"><span class="math inline">\(e^{0.1428}=0.887\)</span></span></td>
</tr>
<tr class="even">
<td>7</td>
<td>1</td>
<td>17</td>
<td>0.807</td>
<td><span class="fragment" data-fragment-index="2"><span class="math inline">\(-\log(0.807)=0.214\)</span></span></td>
<td><span class="fragment" data-fragment-index="2"><span class="math inline">\(0.1428 + \frac{1}{17}=0.2017\)</span></span></td>
<td><span class="fragment" data-fragment-index="2"><span class="math inline">\(e^{0.2017}=0.8173\)</span></span></td>
</tr>
<tr class="odd">
<td>10</td>
<td>1</td>
<td>15</td>
<td>0.753</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(-\log(0.753)=0.284\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.2017 + \frac{1}{15}=0.2683\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(e^{0.2683}=0.7647\)</span></span></td>
</tr>
<tr class="even">
<td>13</td>
<td>1</td>
<td>12</td>
<td>0.690</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(-\log(0.690)=0.371\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.2683 + \frac{1}{12}=0.3517\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(e^{0.3517}=0.7035\)</span></span></td>
</tr>
<tr class="odd">
<td>16</td>
<td>1</td>
<td>11</td>
<td>0.628</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(-\log(0.628)=0.465\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.3517 + \frac{1}{11}=0.4426\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(e^{0.4426}=0.6424\)</span></span></td>
</tr>
<tr class="even">
<td>22</td>
<td>1</td>
<td>7</td>
<td>0.538</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(-\log(0.538)=0.620\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.4426 + \frac{1}{7}=0.5854\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(e^{0.5854}=0.5569\)</span></span></td>
</tr>
<tr class="odd">
<td>23</td>
<td>1</td>
<td>6</td>
<td>0.448</td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(-\log(0.448)=0.803\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(0.5854 + \frac{1}{6}=0.7521\)</span></span></td>
<td><span class="fragment" data-fragment-index="3"><span class="math inline">\(e^{0.7521}=0.4714\)</span></span></td>
</tr>
</tbody>
</table></section><section id="example-6-mp-3" class="slide level2"><h2>Example: 6-MP</h2>
<p>Comparing the KM and NA estimates in a life table would look like:</p>
<table>
<colgroup>
<col style="width: 21%">
<col style="width: 18%">
<col style="width: 21%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Survival Functions</th>
<th></th>
<th>Cumulative Hazards</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\boldsymbol{t}\)</span></td>
<td><span class="math inline">\(\boldsymbol{\widehat{S}_{KM}(t)}\)</span></td>
<td><span class="math inline">\(\boldsymbol{\tilde S_{B}(t)}\)</span></td>
<td><span class="math inline">\(\boldsymbol{\widehat\Lambda_{KM}(t)}\)</span></td>
<td><span class="math inline">\(\boldsymbol{\tilde\Lambda_{NA}(t)}\)</span></td>
</tr>
<tr class="even">
<td>[0 - 6)</td>
<td>0.857</td>
<td>0.887</td>
<td>0.154</td>
<td>0.143</td>
</tr>
<tr class="odd">
<td>[6 - 7)</td>
<td>0.807</td>
<td>0.817</td>
<td>0.214</td>
<td>0.202</td>
</tr>
<tr class="even">
<td>[7 - 10)</td>
<td>0.753</td>
<td>0.765</td>
<td>0.284</td>
<td>0.268</td>
</tr>
<tr class="odd">
<td>[10 - 13)</td>
<td>0.690</td>
<td>0.704</td>
<td>0.371</td>
<td>0.352</td>
</tr>
<tr class="even">
<td>[13 - 16)</td>
<td>0.628</td>
<td>0.342</td>
<td>0.465</td>
<td>0.443</td>
</tr>
<tr class="odd">
<td>[16 - 22)</td>
<td>0.538</td>
<td>0.557</td>
<td>0.620</td>
<td>0.585</td>
</tr>
<tr class="even">
<td>[22 - 23)</td>
<td>0.448</td>
<td>0.471</td>
<td>0.803</td>
<td>0.752</td>
</tr>
</tbody>
</table></section><section id="survival-curves" class="slide level2"><h2>Survival curves</h2>
<p>We’ve estimated all these survival probabilities but what do we… do with them?</p>
<ul>
<li><p>We could do like we’ve been doing and put them in a table and track how the probabilities change with time</p></li>
<li><p>… but that can get complicated quickly, and it’s not very easy to compare how the probabilities change across multiple groups</p></li>
</ul>
<p><span class="alert">Solution: plot the probabilities as curves!</span></p>
</section><section id="example-6-mp-4" class="slide level2"><h2>Example: 6-MP</h2>
<p>An example of a survival curve for the 6-MP data, using a KM estimator for the survival function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>km<span class="fl">.6</span>mp <span class="ot">&lt;-</span> <span class="fu">survfit</span>( <span class="fu">Surv</span>(t2, relapse) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>drug6mp )</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">plot</span>(km<span class="fl">.6</span>mp, <span class="at">mark.time=</span>T, <span class="at">xlab=</span><span class="st">"Months since study start"</span>, <span class="at">ylab=</span><span class="st">"Survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides-10-2_files/figure-revealjs/survival%20curve-1.png" style="width:80.0%"></p>
</div>
</div>
</section><section id="comparing-survival-curves" class="slide level2"><h2>Comparing survival curves</h2>
<p>If we would like to formally compare the survival functions for multiple groups, we can perform a statistical test</p>
<p><span class="math display">\[\begin{align*}&amp;H_0: S_1(t) = S_2(t) \text{ for all } t\\
&amp;H_1: S_1(t) \ne S_2(t) \text{ for at least one } t\end{align*}\]</span></p>
<p><br></p>
<p>Let <span class="math inline">\(t_1 &lt; t_2 &lt; \dots &lt; t_D\)</span> denote the distinct event times in the overall sample</p>
<ul>
<li>
<p>At time <span class="math inline">\(t_i\)</span>, we observe:</p>
<ul>
<li><p><span class="math inline">\(d_{1i}\)</span> events from the <span class="math inline">\(Y_{1i}\)</span> subjects at risk in the first group</p></li>
<li><p><span class="math inline">\(d_{2i}\)</span> events from the <span class="math inline">\(Y_{2i}\)</span> subjects at risk in the second group</p></li>
<li><p><span class="math inline">\(d_i = d_{1i} + d_{2i}\)</span> events from the <span class="math inline">\(U_i = Y_{1i} + Y_{2i}\)</span> subjects at risk in the two groups combined</p></li>
</ul>
</li>
</ul></section><section id="comparing-survival-curves-1" class="slide level2"><h2>Comparing survival curves</h2>
<p>We can then make a contingency table for events and non-events at time <span class="math inline">\(t_i\)</span>:</p>
<p><img data-src="logrank-table.png"></p>
<p>Under the null hypothesis <span class="math inline">\(H_0\)</span>, every subject at risk at time <span class="math inline">\(t_i\)</span> has the <u>same probability</u> of experiencing an event at time <span class="math inline">\(t_i\)</span> regardless of group</p>
<ul>
<li>
<p>Under <span class="math inline">\(H_0\)</span>:</p>
<ul>
<li><p>the expected number of subjects in group 1 who experience an event at time <span class="math inline">\(t_i\)</span> is <span class="math inline">\(E_{1i} = E[d_{1i}] = d_i \frac{Y_{1i}}{Y_i}\)</span></p></li>
<li><p>the variance is <span class="math inline">\(V_{1i} = Var[d_{1i}] = d_i \times \frac{Y_{1i}}{Y_i}\times\frac{Y_{2i}}{Y_i}\times\frac{Y_i - d_i}{Y_i - 1}\)</span></p></li>
</ul>
</li>
</ul></section><section id="logrank-tests" class="slide level2"><h2>Logrank tests</h2>
<p>We can use <span class="math inline">\(d_{1i}\)</span>, <span class="math inline">\(E_{1i}\)</span>, <span class="math inline">\(V_{1i}\)</span>, and a weight function <span class="math inline">\(W(t_i)\)</span> to construct a weighted test statistic:</p>
<p><span class="math display">\[Z = \frac{\sum_{i=1}^D W(t_i)(d_{1i} - E_{1i})}{\sqrt{\sum_{i=1}^D W(t_i)^2 V_{1i}}}\]</span></p>
<p>If we choose <span class="math inline">\(W(t_i) = 1\)</span> for all <span class="math inline">\(t\)</span>, we get the <span class="alert">Mantel-Haenszel</span> or <span class="alert">logrank</span> test statistic:</p>
<p><span class="math display">\[Z = \frac{\sum_{i=1}^D (d_{1i} - E_{1i})}{\sqrt{\sum_{i=1}^D V_{1i}}}\]</span></p>
<ul>
<li><p>It looks a little bit like a chi-squared test!</p></li>
<li><p>We can compare this test statistic to a standard Normal distribution to determine whether we should reject <span class="math inline">\(H_0\)</span></p></li>
<li><p>If we reject, this means that we have evidence that people in group 1 <u>do not</u> have the same probability of experiencing an event at time <span class="math inline">\(t_i\)</span> as the people in group 2!</p></li>
</ul></section><section id="proportional-hazards" class="slide level2"><h2>Proportional hazards</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>The logrank test is <span class="alert">most powerful</span> when the alternative looks at a hazard for group 2 that is <span class="alert">different but proportional</span> to the group 1 hazard: <span class="math inline">\(\lambda_2(t) = \alpha \lambda_1(t)\)</span></p>
<ul>
<li>Can also rewrite this in terms of survival functions: <span class="math inline">\(S_2(t) = S_1(t)^\alpha\)</span>
</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="prop-hazards.png" width="1000"></p>
</div>
</div>
</section><section id="proportional-hazards-1" class="slide level2"><h2>Proportional hazards</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>The logrank test is <span class="alert">most powerful</span> when the alternative looks at a hazard for group 2 that is <span class="alert">different but proportional</span> to the group 1 hazard: <span class="math inline">\(\lambda_2(t) = \alpha \lambda_1(t)\)</span></p>
<ul>
<li>Can also rewrite this in terms of survival functions: <span class="math inline">\(S_2(t) = S_1(t)^\alpha\)</span>
</li>
</ul>
<p><br></p>
<ul>
<li>Or in terms of the log cumulative hazards: <span class="math inline">\(\log[\Lambda_2(t)] = \log[\alpha] + \log[\Lambda_1(t)]\)</span>
</li>
</ul>
<p><br></p>
<p>This means that the logrank test will be most powerful if the log cumulative hazards are (roughly) <span class="alert">parallel</span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="parallel-log-hazards.png" width="1000"></p>
</div>
</div>
</section><section id="example-6-mp-5" class="slide level2"><h2>Example: 6-MP</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>km<span class="fl">.6</span>mp2 <span class="ot">&lt;-</span> <span class="fu">survfit</span>( <span class="fu">Surv</span>(time, relapse) <span class="sc">~</span> sixmp, <span class="at">data=</span>drug6mp_long )</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">plot</span>(km<span class="fl">.6</span>mp2, <span class="at">mark.time=</span>T, <span class="at">xlab=</span><span class="st">"Months since study start"</span>, <span class="at">ylab=</span><span class="st">"Survival"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">legend</span>( <span class="dv">1</span>, .<span class="dv">6</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"6-MP"</span>), <span class="at">bty=</span><span class="st">"n"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides-10-2_files/figure-revealjs/cancer%20curves-1.png" style="width:80.0%"></p>
</div>
</div>
<div class="absolute" style="top: 300px; right: 0px; width: 20%; ">
<p>Curves look pretty proportional… Let’s do a logrank test to see if these curves are (significantly) different</p>
</div>
</section><section id="example-6-mp-6" class="slide level2"><h2>Example: 6-MP</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">survdiff</span>( <span class="fu">Surv</span>(time, relapse) <span class="sc">~</span> sixmp, <span class="at">data=</span>drug6mp_long )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(time, relapse) ~ sixmp, data = drug6mp_long)

         N Observed Expected (O-E)^2/E (O-E)^2/V
sixmp=0 21       21     10.7      9.77      16.8
sixmp=1 21        9     19.3      5.46      16.8

 Chisq= 16.8  on 1 degrees of freedom, p= 4e-05 </code></pre>
</div>
</div>
<p>A chi-squared test statistic of 16.8 (<span class="math inline">\(Z=4.1\)</span>) with a p-value of 0.00004… probably pretty different!</p>
<ul>
<li>
<p>Can conclude that 6-MP treatment group has higher relapse-free survival than placebo</p>
<ul>
<li><p>AKA: higher probability that the treatment group’s relapse time is greater that some time <span class="math inline">\(t\)</span> compared to the placebo group</p></li>
<li><p>AKA: treatment group takes longer to experience relapse, on average, compared to the placebo group</p></li>
</ul>
</li>
</ul></section><section id="weighted-logrank-tests" class="slide level2"><h2>Weighted logrank tests</h2>
<p>While the logrank test will still work work under <u>non-proportional hazards</u>, we might want to choose a different weight function <span class="math inline">\(W(t_i)\)</span> that would allow us to weight differences in the observed and expected number of events (<span class="math inline">\(d_{1i} - E_{1i}\)</span>) differently over time</p>
<p><br></p>
<ul>
<li><p><span class="alert">Gehan-Breslow</span> weights: <span class="math inline">\(W(t_i) = Y_i\)</span> applies more weight to early failure times</p></li>
<li><p><span class="alert">Generalized Wilcoxon</span> weights: <span class="math inline">\(W(t_i) = \widehat{S}_{KM}(t_k-) = \prod_{t_i \le t}\left[1-\frac{d_i}{Y_i + 1}\right]\)</span> also applies greater weight to early failure times</p></li>
<li>
<p><span class="alert">Fleming &amp; Harrington</span> weights: <span class="math inline">\(W_{p,q}(t_i) = \left[\widehat{S}_{KM}(t_{i-1})\right]^p\left[1-\widehat{S}_{KM}(t_{i-1})\right]^q\)</span></p>
<ul>
<li><p><span class="math inline">\(p=q=0\)</span> gives the unweighted logrank statistic</p></li>
<li><p><span class="math inline">\(p=1\)</span>, <span class="math inline">\(q=0\)</span> gives the generalized Wilcoxon logrank statistic (weight to early failures)</p></li>
<li><p><span class="math inline">\(p=0\)</span>, <span class="math inline">\(q=1\)</span> gives more weight to late failure times</p></li>
</ul>
</li>
</ul>
<p>No objectively “correct” choice for weights – it depends on whether early or late events are more important in your research context</p>
</section><section id="non-proportional-hazards" class="slide level2"><h2>Non-proportional hazards</h2>
<div class="columns">
<div class="column" style="width:75%;">
<p><img data-src="Real-study-examples-on-non-proportional-hazards-NPH-patterns-a-Delayed-treatment.png" width="1200"></p>
</div><div class="column" style="width:25%;">
<p><em>Figure from “Treating non-responders: Pitfalls and implications for cancer immunotherapy trial design” by Xu, Park, Liu, &amp; Zhu (2020)</em></p>
<ul>
<li>Whether you care about early success or late success depends on your health context!</li>
</ul>
</div>
</div>
</section><section id="take-home-messages" class="slide level2"><h2>Take home messages</h2>
<ul>
<li>Can be hard to know that we’re right about our assumed probability distribution for survival time</li>
</ul>
<p><br></p>
<ul>
<li>
<p>In that case, it’s good to estimate the survival function <span class="math inline">\(S(t)\)</span> using non-parametric methods</p>
<ul>
<li><p>The Kaplan-Meier estimator <span class="math inline">\(\widehat S_{KM}(t)\)</span> is usually the default</p></li>
<li><p>The Nelson Aalen estimator of the cumulative hazard <span class="math inline">\(\tilde\Lambda_{NA}(t)\)</span> and it’s equivalent Breslow estimator of the surivival function <span class="math inline">\(\widehat S_B(t)\)</span> work well with small sample sizes</p></li>
</ul>
</li>
</ul>
<p><br></p>
<ul>
<li>
<p>We can plot the survival function as a curve over time, and we can compare whether curves for different groups differ by using a logrank test</p>
<ul>
<li>We can use a weighted logrank test when we have non-proportional hazards, but we need to choose whether we care more about differences between early or late failures</li>
</ul>
</li>
</ul>
<p><img src="POPUHEALSMPH_color-flush.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="slides-10-2_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="slides-10-2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/notes/notes.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/search/search.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="slides-10-2_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': true,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>