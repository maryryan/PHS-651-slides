<!DOCTYPE html>
<html lang="en"><head>
<script src="slides-2-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides-2-1_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides-2-1_files/libs/quarto-html/popper.min.js"></script>
<script src="slides-2-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides-2-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides-2-1_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides-2-1_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="slides-2-1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<title>slides-2-1</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="slides-2-1_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="slides-2-1_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="slides-2-1_files/libs/revealjs/dist/theme/quarto.css">
<link href="slides-2-1_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="slides-2-1_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="slides-2-1_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="slides-2-1_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="slides-2-1_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="slides-2-1_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2"><h1>
Lecture 2.1: Non-normal outcomes, correlated data, and conditional models
</h1>
<h2>
PHS 651: Advanced regression methods
</h2>
<hr>
<h3>
Mary Ryan Baumann, PhD
</h3>
<h3>
September 16, 2025
</h3>
<p><br></p>
<div style="font-size: 75%;">
<p><strong>Recording disclosure</strong></p>
<p><em>This class is being conducted in person, as well as over <span class="alert">Zoom</span>. As the instructor, I will be <span class="alert">recording</span> this session. I have disabled the recording feature for others so that no one else will be able to record this session. I will be posting this session to the course’s website.</em></p>
<p><em>If you have privacy concerns and do not wish to appear in the recording, you may turn video off (click “stop video”) so that Zoom does not record you.</em></p>
<p><em>The chat box is always open for discussion and questions to the entire class. You may also send messages privately to the instructor. Please note that Zoom saves all chat transcripts.</em></p>
</div>
<div class="absolute" style="left: 260px; bottom: 50px; width: 1500px; ">
<p>Slides found at: <a href="https://maryryan.github.io/PHS-651-slides/F25/lec-2-1/slides-2-1" class="uri">https://maryryan.github.io/PHS-651-slides/F25/lec-2-1/slides-2-1</a></p>
</div>
<div class="absolute" style="left: 100px; bottom: 0px; width: 150px; ">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-2-1_files/figure-revealjs/qr%20code-1.png" width="192"></p>
</div>
</div>
</div>
</section><section id="recap-linear-mixed-effect-models" class="slide level2"><h2>Recap: linear mixed effect models</h2>
<p>One way to account for clustering in analysis is with a <span class="alert">linear mixed effects</span> model <span class="math display">\[\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<ul>
<li><p><span class="math inline">\(\boldsymbol{X}_i\vec{\beta}\)</span> are the <span class="alert">fixed effects</span> representing the mean responses for cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\vec{Z}_ib_{0i}\)</span> are the <span class="alert">random effects</span> accounting for random between-cluster variation</p></li>
<li><p><span class="math inline">\(\vec{\epsilon}_i\)</span> is the regular between-individual variation</p></li>
</ul>
<div class="fragment">
<p>The <span class="alert">fixed effects</span> are shared across everyone in the sample, while the <span class="alert">random effects</span> are unique to a particular cluster</p>
<p>Interpretations of <span class="math inline">\(\beta_1\)</span> in an LME are <span class="alert">conditional</span> because they are comparing 2 individuals with the same cluster membership</p>
<ul>
<li>Often referred to as having individual-specific or cluster-specific interpretation</li>
</ul>
</div>
<div class="fragment">
<p><span class="alert">We can also extend this model to non-continuous/non-Normal outcome data</span></p>
</div>
</section><section id="review-logistic-regression" class="slide level2"><h2>552 review: logistic regression</h2>
<p>If our outcome for an individual <span class="math inline">\(j\)</span>, <span class="math inline">\(Y_{j}\)</span>, is <span class="alert">binary</span>, we can model it using a logistic regression: <span class="math display">\[\log\left(\frac{p_j}{1-p_j}\right) = \boldsymbol{X}_j\vec{\beta} = \beta_0 + U_j\beta_1 + \epsilon_j\]</span></p>
<ul>
<li>
<p>We assume <span class="math inline">\(Y_j \sim \text{Binomial}(p_j)\)</span></p>
<ul>
<li><span class="math inline">\(E[Y_j] = p_j\)</span></li>
</ul>
</li>
<li>
<p>The logit function <span class="math inline">\(\log\left(\frac{x}{1-x}\right)\)</span> acts as the <span class="alert">link</span> between <span class="math inline">\(E[Y_j]\)</span> and the linear model <span class="math inline">\(\boldsymbol{X}_j\vec{\beta}\)</span></p>
<ul>
<li>
<span class="math inline">\(\left(\frac{p_j}{1-p_j}\right)\)</span> are known as the <span class="alert">odds</span> of <span class="math inline">\(u=1\)</span> compared to <span class="math inline">\(u=0\)</span>
</li>
</ul>
</li>
</ul></section><section id="review-logistic-regression-1" class="slide level2"><h2>522 review: logistic regression</h2>
<p>If our outcome for an individual <span class="math inline">\(j\)</span>, <span class="math inline">\(Y_{j}\)</span>, is <span class="alert">binary</span>, we can model it using a logistic regression: <span class="math display">\[\log\left(\frac{p_j}{1-p_j}\right) = \boldsymbol{X}_j\vec{\beta} = \beta_0 + U_j\beta_1 + \epsilon_j\]</span></p>
<ul>
<li>
<span class="math inline">\(\beta_1\)</span> tells us about the <span class="alert">log odds</span>:</li>
</ul>
<p><span class="math display">\[\beta_1 = \log\left(\frac{p(u=1)}{1-p(u=1)}\right) - \log\left(\frac{p(u=0)}{1-p(u=0)}\right)\]</span></p>
<ul>
<li>
<span class="math inline">\(e^{\beta_1}\)</span> tells us about the <span class="alert">odds ratio</span>:</li>
</ul>
<p><span class="math display">\[e^{\beta_1} = \frac{\text{odds}(u=1)}{\text{odds}(u=0)}=\frac{\left(\frac{p(u=1)}{1-p(u=1)}\right)}{\left(\frac{p(u=0)}{1-p(u=0)}\right)}\]</span></p>
</section><section id="review-logistic-regression-2" class="slide level2"><h2>522 review: logistic regression</h2>
<p>Logistic regression is solving 2 problems for us:</p>
<ol type="1">
<li>
<p>Using our Binomial distribution assumptions to handle non-constant variance in binary data</p>
<ul>
<li>Remember, variance of binary data is a function of its mean!</li>
</ul>
</li>
<li><p>Transforms the outcome so we don’t have to worry about predictions going beyond the range of binary data (above 1 or below 0)</p></li>
</ol>
<div class="fragment">
<p>These are common problems when analyzing many types of non-Normal data that OLS doesn’t accommodate</p>
<ul>
<li>Logistic regression is a specific example of a broader class of <span class="alert">generalized linear models</span>
</li>
</ul>
</div>
</section><section id="generalized-linear-models" class="slide level2"><h2>Generalized linear models</h2>
<p>In the independent observation setting, many types of data are modeled using a common <span class="alert">generalized linear model</span> (GLM) structure</p>
<p><span class="math display">\[g(Y_j) = \boldsymbol{X}_j\vec{\beta} + \epsilon_j\]</span></p>
<ul>
<li><p><span class="math inline">\(g(\cdot)\)</span> is known as the <span class="alert">link function</span> because it <em>links</em> a linear model on the righthand side to the outcome on the lefthand side</p></li>
<li><p><span class="math inline">\(\epsilon_j\)</span> will still be Normally distributed, but its variance <span class="math inline">\(\sigma^2_{\epsilon}\)</span> will match the distribution of <span class="math inline">\(Y_j\)</span></p></li>
</ul></section><section id="generalized-linear-models-1" class="slide level2"><h2>Generalized linear models</h2>
<p>In GLMs, we estimate the regression coefficients <span class="math inline">\(\vec{\beta}\)</span> as the solution to the <span class="alert">estimating equation</span>: <span class="math display">\[\sum_{j=1}^n \left(\frac{\partial \mu_j}{\partial \vec{\beta}}\right)^T v_j^{-1}[Y_j - \mu_j(\vec{\beta})] = 0\]</span></p>
<p>where</p>
<ul>
<li><p>The mean of the outcome <span class="math inline">\(E[Y_j]=\mu_j(\vec{\beta})\)</span> is a function of <span class="math inline">\(\vec{\beta}\)</span></p></li>
<li><p>The variance of the outcome <span class="math inline">\(Var[Y_j] = v_j\)</span> is some function <span class="math inline">\(v_j\)</span></p></li>
</ul>
<div class="fragment">
<ul>
<li>The estimating equation is actually just the derivative of the likelihood with respect to regression parameters <span class="math inline">\(\beta\)</span> (<span class="math inline">\(\partial f(y_j)/\partial \beta\)</span>)</li>
</ul>
</div>
</section><section id="generalized-linear-models-2" class="slide level2"><h2>Generalized linear models</h2>
<p>In GLMs, we estimate the regression coefficients <span class="math inline">\(\vec{\beta}\)</span> as the solution to the <span class="alert">estimating equation</span>: <span class="math display">\[\sum_{j=1}^n \left(\frac{\partial \mu_j}{\partial \vec{\beta}}\right)^T v_j^{-1}[Y_j - \mu_j(\vec{\beta})] = 0\]</span></p>
<p>Look similar?</p>
<p><span class="math display">\[\sum_{j=1}^n\boldsymbol{X}^T\frac{1}{\sigma^2}[Y_j - \boldsymbol{X}\vec{\beta}]=0 \]</span></p>
<div class="fragment">
<p>OLS is a type of GLM!</p>
<ul>
<li>
<p><span class="math inline">\(E[Y_j] = \mu_j(\beta) = \boldsymbol{X}\vec{\beta}\)</span></p>
<ul>
<li><span class="math inline">\(\left(\frac{\partial \mu_j}{\partial \beta}\right) = \boldsymbol{X}\)</span></li>
</ul>
</li>
<li><p><span class="math inline">\(Var[Y_j] = v_j = \sigma^2\)</span></p></li>
</ul>
</div>
</section><section id="generalized-linear-models-3" class="slide level2"><h2>Generalized linear models</h2>
<p>In GLMs, we estimate the regression coefficients <span class="math inline">\(\vec{\beta}\)</span> as the solution to the <span class="alert">estimating equation</span>: <span class="math display">\[\sum_{j=1}^n \left(\frac{\partial \mu_j}{\partial \vec{\beta}}\right)^T v_j^{-1}[Y_j - \mu_j(\vec{\beta})] = 0\]</span></p>
<ul>
<li>
<p>This estimating equation is based on the <span class="alert">likelihood function</span> associated with the distribution we assume the outcome is coming from</p>
<ul>
<li><p>Many types of data distributions have likelihoods with a similar form called the <span class="alert">exponential family form</span> - GLMs exploits this</p></li>
<li><p>This is how we get types of regression models such as OLS, logistic, and log-linear (Poisson)</p></li>
</ul>
</li>
</ul></section><section id="exponential-family" class="slide level2"><h2>Exponential family</h2>
<p>Exponential family distributions share some common statistical properties</p>
<ul>
<li>
<p>The expectation of <span class="math inline">\(Y_j\)</span>, <span class="math inline">\(E[Y_j] = \mu_j(\beta)\)</span> can be transformed by a link function <span class="math inline">\(g(\cdot)\)</span> so that it is <em>linearly</em> related to the covariates <span class="math display">\[g(\mu_j) = \boldsymbol{X}\vec{\beta}\]</span></p>
<ul>
<li>Some types of exponential family distributions may have multiple link functions associated with it (i.e., Bernoulli)</li>
</ul>
</li>
<li>
<p>Variance of <span class="math inline">\(Y_j\)</span> can be expressed in terms of <span class="math display">\[\text{Var}[Y_j] = \phi v(\mu_j),\]</span></p>
<ul>
<li><p><span class="math inline">\(\phi\)</span> is a scale parameter <span class="math inline">\(&gt;0\)</span></p></li>
<li>
<p><span class="math inline">\(v(\mu_j)\)</span> is the variance function that describes how the outcome variance <span class="math inline">\(\text{Var}[Y_j]\)</span> is related to the mean of the outcome <span class="math inline">\(\mu_j\)</span></p>
<ul>
<li>If the mean and variance are independent, this will be 1</li>
</ul>
</li>
</ul>
</li>
</ul></section><section id="exponential-family-and-glms" class="slide level2"><h2>Exponential family and GLMs</h2>
<table>
<colgroup>
<col style="width: 11%">
<col style="width: 19%">
<col style="width: 68%">
</colgroup>
<thead><tr class="header">
<th>Distribution</th>
<th>Var. function <span class="math inline">\(v(\mu)\)</span>
</th>
<th>Usual link function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Normal</td>
<td><span class="math inline">\(v(\mu)=1\)</span></td>
<td>Identity: <span class="math inline">\(g(\mu) = \mu = \boldsymbol{X}_i\vec{\beta}\)</span>
</td>
</tr>
<tr class="even">
<td>Bernoulli/Binomial</td>
<td><span class="math inline">\(v(\mu)=\mu(1-\mu)\)</span></td>
<td>Logit: <span class="math inline">\(g(\mu) = \log\left(\frac{\mu}{1-\mu}\right)= \boldsymbol{X}_i\vec{\beta}\)</span>
</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td><span class="math inline">\(v(\mu)=\mu\)</span></td>
<td>Log: <span class="math inline">\(g(\mu) = \log(\mu)= \boldsymbol{X}_i\vec{\beta}\)</span>
</td>
</tr>
</tbody>
</table>
<div class="fragment">
<ul>
<li>We’ll focus on binary/Bernoulli/Binomial data today and circle back to count/Poisson data in a recorded video</li>
</ul>
</div>
</section><section id="exponential-family-and-glms-examples" class="slide level2"><h2>Exponential family and GLMs: examples</h2>
<p>Normal distribution</p>
<ul>
<li><p>Assume that <span class="math inline">\(g(\cdot)\)</span> is the identity function <span class="math inline">\(g(\mu) = \mu\)</span></p></li>
<li><p>Model is then</p></li>
</ul>
<p><span class="math display">\[g(E[Y_i]) = \mu_i = \boldsymbol{X}_i\vec{\beta}\]</span></p>
<p>a standard linear regression model</p>
<ul>
<li>
<p>Variance is <span class="math inline">\(\text{Var}[Y_i] = \phi = \sigma^2\)</span></p>
<ul>
<li>
<span class="math inline">\(v(\mu_i) = 1\)</span> (independent of mean)</li>
</ul>
</li>
</ul></section><section id="exponential-family-and-glms-examples-1" class="slide level2"><h2>Exponential family and GLMs: examples</h2>
<p>Bernoulli distribution</p>
<ul>
<li><p>Assume that <span class="math inline">\(g(\cdot)\)</span> is the logit function <span class="math inline">\(g(\mu) = \log\left(\frac{\mu}{1-\mu}\right)\)</span></p></li>
<li><p>Model is then</p></li>
</ul>
<p><span class="math display">\[g(E[Y_i]) = \log\left(\frac{\mu_i}{1-\mu_i}\right) = \boldsymbol{X}_i\vec{\beta}\]</span></p>
<p>a logistic regression model</p>
<ul>
<li>
<p>Variance is <span class="math inline">\(\text{Var}[Y_i] = v(\mu_i) = \mu_i(1-\mu_i)\)</span> (<em>dependent</em> on mean)</p>
<ul>
<li>
<span class="math inline">\(\phi = 1\)</span> <!-- ## Exponential family -->
</li>
</ul>
</li>
</ul>
<!-- Many common types of data distributions belong to a family called the [exponential family]{.alert} --><!-- - Called such because their likelihoods can be written in a common form: --><!-- $$f(y_i)= \exp\left\{\frac{[y_i\theta_i - \psi(\theta_i)]}{\varphi} + c(y_i,\varphi)\right\}$$ --><!--    - $\theta_i$ is the natural parameter --><!--    - $\psi(\cdot)$ related $\theta_i$ to $E[Y_i]$ through $E[Y_i]=\partial\psi(\theta_i)/\partial \theta_i$ --><!--    - $\varphi$ is a variance scaling parameter --><!--    - $c(y_i,\varphi)$ is a catch-all for everything else --><!-- --- --><!-- ## Exponential family examples --><!-- Normal: $\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left\{-\frac{(y_i-\mu_i)^2}{2\sigma^2}\right\}=\exp\left\{\frac{y_i\mu_i - 1/2\mu_i^2}{\sigma^2} -\frac{1}{2} \log(2\pi\sigma^2)-\frac{y_i^2}{2\sigma^2}\right\}$ --><!-- - $\theta_i = \mu_i$ --><!-- - $\psi(\theta_i) = 1/2 \mu_i^2$ --><!-- - $\varphi = \sigma^2$ --><!-- - $c(y_i,\varphi) = -\frac{1}{2} \log(2\pi\sigma^2)-\frac{y_i^2}{2\sigma^2}$ --><!-- --- --><!-- ## Exponential family examples --><!-- Binomial: ${n_i\choose n_i y_i}\pi_i^{n_i y_i})(1-\pi_i)^{n_i - n_i y_i} = \exp\left\{\frac{y_i \theta_i - \log[1+\exp(\theta_i)]}{1/n_i} + \log\left[{n_i \choose n_i y_i} \right]\right\}$ --><!-- - $\theta_i = \log\left[\frac{\pi_i}{1-\pi_i}\right]$ --><!-- - $\psi(\theta_i) = \log[1+\exp(\theta_i)]$ --><!-- - $\varphi = 1/n_i$ --><!-- - $c(y_i,\theta_i) = \log\left[{n_i \choose n_i y_i} \right]$ --><!-- --- --><!-- ## Exponential family examples --><!-- Poisson: $\frac{\exp\{-\mu_i\}\mu_i^{y_i}}{y_i!} = \exp\{y_i\log(\mu_i) - \mu_i - \log(y_i!)\}$ --><!-- - $\theta_i = \log(\mu_i)$ --><!-- - $psi(\theta_i) = \exp(\theta_i)$ --><!-- - $\varphi = 1$ --><!-- - $c(y_i, \theta_i) = -\log(y_i!)$ --></section><section id="generalized-linear-mixed-models" class="slide level2 smaller"><h2>Generalized linear mixed models</h2>
<p>We can also use the idea of GLMs in LMEs to model data that is both <em>clustered</em> and <em>non-Normal</em></p>
<ul>
<li>We call this hybrid a <span class="alert">generalized linear mixed model</span> (GLMMs)</li>
</ul>
<div class="fragment">
<p><span class="math display">\[g(\vec{Y}_i) = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<ul>
<li><p>Assumes <span class="math inline">\([\vec{Y}_i|\boldsymbol{X}_i, b_{0i}]\)</span> is distributed as a member of the exponential family</p></li>
<li><p>We’ll use a distribution assumption to assume link function <span class="math inline">\(g(\cdot)\)</span> and the form of within-cluster variance <span class="math inline">\(Var[Y_{ij}|\boldsymbol{X}_i,b_{0i}]\)</span></p></li>
</ul>
</div>
</section><section id="generalized-linear-mixed-models-1" class="slide level2 smaller"><h2>Generalized linear mixed models</h2>
<p>We can also use the idea of GLMs in LMEs to model data that is both <em>clustered</em> and <em>non-Normal</em></p>
<ul>
<li>We call this hybrid a <span class="alert">generalized linear mixed model</span> (GLMMs)</li>
</ul>
<p><span class="math display">\[g(\vec{Y}_i) = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<ul>
<li>Just as with Normally-distributed outcomes, the random intercepts will still give us an exchangeable covariance structure</li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
\sigma^2_b + \sigma^2_\epsilon &amp; \sigma^2_b &amp; \dots &amp; \sigma^2_b\\
\sigma^2_b &amp; \ddots &amp; \dots &amp; \sigma^2_b\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2_b &amp; \dots &amp; \sigma^2_b &amp; \sigma^2_b + \sigma^2_\epsilon
\end{bmatrix}\]</span></p>
<ul>
<li>The difference is that the form of <span class="math inline">\(Var[Y_{ij}|\boldsymbol{X}_i,b_{0i}] = Var[\epsilon_{ij}] = \sigma^2_\epsilon\)</span> will depend on the distribution of <span class="math inline">\(Y_{ij}\)</span>
</li>
</ul></section><section id="logistic-linear-mixed-models" class="slide level2"><h2>Logistic linear mixed models</h2>
<p>Let’s be more specific</p>
<ul>
<li><p>Say we have <span class="math inline">\(\vec{Y}_i\)</span> that is distributed Bernoulli with probability of success <span class="math inline">\(p_{ij}\)</span></p></li>
<li><p>We want to know what effect exposure <span class="math inline">\(U_{ij}\)</span> has on <span class="math inline">\(\vec{Y}_i\)</span></p></li>
</ul>
<p><span class="alert">What would our model look like?</span></p>
<div class="fragment">
<p><span class="math display">\[\text{logit}(Y_{ij}) = \beta_0 + U_{ij}\beta_1 + Z_i b_{0i} + \epsilon_{ij}\]</span></p>
<p>where <span class="math inline">\(b_{0i} \sim N(0, \sigma^2_b)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim \left(0, p_{ij}(1-p_{ij})\right)\)</span></p>
<ul>
<li>We usually estimate <span class="math inline">\(Var[\epsilon_{ij}]\)</span> as <span class="math inline">\(p(1-p)\)</span>
</li>
</ul>
</div>
</section><section id="logistic-linear-mixed-models-1" class="slide level2"><h2>Logistic linear mixed models</h2>
<p><span class="math display">\[\text{logit}(Y_{ij}) = \beta_0 + U_{ij}\beta_1 + Z_i b_{0i} + \epsilon_{ij}\]</span></p>
<p>where <span class="math inline">\(b_{0i} \sim N(0, \sigma^2_b)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim \left(0, p_{ij}(1-p_{ij})\right)\)</span></p>
<p><span class="alert">How do we interpret <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(b_{0i}\)</span> in this setting?</span></p>
<div class="fragment">
<ul>
<li><p><span class="math inline">\(e^{\beta_0}\)</span>: grand odds of the event occurring</p></li>
<li><p><span class="math inline">\(e^{\beta_0 + b_{i0}}\)</span>: cluster <span class="math inline">\(i\)</span>-specific odds of the event occurring</p></li>
<li><p><span class="math inline">\(e^{b_{i0}}\)</span>: odds ratio/relative change in odds of the event occurring in cluster <span class="math inline">\(i\)</span> compared to grand odds</p></li>
</ul>
</div>
</section><section id="some-notes-on-estimation" class="slide level2"><h2>Some notes on estimation</h2>
<p>In order to estimate regression coefficients/covariances from the likelihood function for a GLMM, we usually need to do some approximations</p>
<ul>
<li>
<p>There are 2 ways to do this:</p>
<ol type="1">
<li><p>Approximate maximum likelihood (penalized quasi-likelihood)</p></li>
<li><p>Approximate the integral (Gaussian quadrature or Laplace approximation)</p></li>
</ol>
</li>
</ul>
<div class="fragment">
<ul>
<li>
<p>In the last 10-15 years, <span class="alert">Gaussian quadrature</span>/Laplace approximation has become the preferred method (if you don’t want to go Bayesian)</p>
<ul>
<li><p>However, GQ can get computationally expensive/intensive if you have lots of random effects</p></li>
<li><p>Laplace approximation is like GQ with only one quadrature point (less precise, but uses fewer computational resources)</p></li>
</ul>
</li>
</ul>
</div>
</section><section id="software-using-gassuain-quadraturelaplace-approximation" class="slide level2"><h2>Software using Gassuain quadrature/Laplace approximation</h2>
<p>There are several types of functions/procedures out there that use Gaussian quadrature/Laplace approximation, but I’m recommending</p>
<ul>
<li>
<p>In R: <code>glmer()</code></p>
<ul>
<li>Other functions (like <code>glmmML()</code> and <code>glmm()</code> ) have trouble extending to longitudinal models</li>
</ul>
</li>
</ul>
<p><br></p>
<ul>
<li>
<p>In SAS</p>
<ul>
<li>
<p><code>PROC GLIMMIX METHOD=QUAD</code> and <code>PROC NLMIXED METHOD=GAUSS</code> use Gaussian quadrature</p>
<ul>
<li>By default, they find the optimal number of quadrature points (adaptive Gaussian quadrature)</li>
</ul>
</li>
<li>
<p><code>PROC GLIMMIX METHOD=LAPLACE</code> uses Laplace approximation</p>
<ul>
<li>Not quite as “accurate” as GQ, but may converge in instances when GQ won’t</li>
</ul>
</li>
</ul>
</li>
</ul></section><section id="troubleshooting-convergence-issues" class="slide level2"><h2>Troubleshooting convergence issues</h2>
<p>Because we need to use approximation to estimate regression coefficients/covariances, sometimes the algorithm won’t converge. There are several possible ways to troubleshoot this.</p>
<ol type="1">
<li>
<p>If using GQ, try changing the number of quadrature points</p>
<ul>
<li><p>In SAS, you can specify a specific number of points with the <code>(QPOINTS= )</code> argument</p></li>
<li><p>In R, you can specify a specific number of points with the <code>nAGQ=</code> argument (default is 1, resulting in Laplace approximation; can also specify 0 if even Laplace won’t converge)</p></li>
<li><p>Fewer quadrature points will be less precise, but will use fewer computational resources (more likely to converge)</p></li>
</ul>
</li>
</ol></section><section id="troubleshooting-convergence-issues-1" class="slide level2"><h2>Troubleshooting convergence issues</h2>
<p>Because we need to use approximation to estimate regression coefficients/covariances, sometimes the algorithm won’t converge. There are several possible ways to troubleshoot this.</p>
<ol start="2" type="1">
<li>
<p>Change the optimizer and increase the number of max iterations</p>
<ul>
<li>
<p>In R, you can add the argument <code>control=glmerControl( optimizer="bobyqa", optCtrl=list(maxfun=200000) )</code> to change the optimizer to <code>bobyqa</code> and change the maximum bumber of iterations to 200,000</p>
<ul>
<li>More iterations = more computation time, so don’t go ham (but should use at least 100,000 here)</li>
</ul>
</li>
<li><p>In SAS, you can add the argument <code>NLOPTIONS maxiter=1000;</code> to change the maximum number of iterations to 1,000 (no recommended min number here)</p></li>
</ul>
</li>
</ol></section><section id="comparing-results-between-sas-and-r" class="slide level2"><h2>Comparing results between SAS and R</h2>
<p>Fair warning: because we’re using approximation algorithms to estimate our regression coefficients, SAS and R <span class="alert">may give you different results</span>, even if both are using the same type of algorithm</p>
<ul>
<li>Ideally these differences aren’t large, but depends on how much and what type of data you have</li>
</ul>
<div class="fragment">
<p>… But now let’s see these methods in action!</p>
</div>
</section><section id="example-cancer-remission" class="slide level2"><h2>Example: cancer remission</h2>
<!-- https://stats.oarc.ucla.edu/r/dae/mixed-effects-logistic-regression/ -->
<p>Say we want to see whether <span class="alert">years of physician experience</span> impacts whether a patient’s lung cancer goes into <span class="alert">remission</span> after treatment</p>
<ul>
<li><p>simulated dummy data from <a href="https://stats.oarc.ucla.edu/r/dae/mixed-effects-logistic-regression/">UCLA</a></p></li>
<li><p>patients clustered by physician</p></li>
<li><p>adjust for cancer stage as confounding factor (more experienced physicians may get patients with more advanced cancer)</p></li>
</ul>
<div class="fragment">
<p>Our (loose) model structure is then:</p>
<p><span class="math display">\[\text{logit}(E[\text{remission}_{ij}]) = \beta_0 + \beta_1(\text{experience}_i) + \beta_2(\text{Stage2}_{ij}) + \beta_3(\text{Stage3}_{ij}) + \beta_4(\text{Stage4}_{ij})\]</span></p>
</div>
</section><section id="example-cancer-remission-1" class="slide level2"><h2>Example: cancer remission</h2>
<p>Let’s get an idea of our data…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>cancer <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2"></a>   <span class="fu">group_by</span>(doc_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3"></a>   <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="at">prop_remission=</span><span class="fu">mean</span>(remission, <span class="at">na.rm=</span>T), <span class="at">mean_exp =</span> <span class="fu">mean</span>(Experience, <span class="at">na.rm=</span>T),</span>
<span id="cb1-4"><a href="#cb1-4"></a>             <span class="at">prop_stageI =</span> <span class="fu">mean</span>(CancerStage<span class="sc">==</span><span class="st">"I"</span>, <span class="at">na.rm=</span>T), <span class="at">prop_stageII =</span> <span class="fu">mean</span>(CancerStage<span class="sc">==</span><span class="st">"II"</span>, <span class="at">na.rm=</span>T),</span>
<span id="cb1-5"><a href="#cb1-5"></a>             <span class="at">prop_stageIII =</span> <span class="fu">mean</span>(CancerStage<span class="sc">==</span><span class="st">"III"</span>, <span class="at">na.rm=</span>T), <span class="at">prop_stageIV =</span> <span class="fu">mean</span>(CancerStage<span class="sc">==</span><span class="st">"IV"</span>, <span class="at">na.rm=</span>T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 407 × 8
   doc_ID     n prop_remission mean_exp prop_stageI prop_stageII prop_stageIII
   &lt;fct&gt;  &lt;int&gt;          &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
 1 1         28         0            25       0.321        0.571        0.0714
 2 2         32         0.375        14       0.406        0.344        0.125 
 3 3          6         0.667        19       0.667        0            0     
 4 4         30         0.267        18       0.3          0.433        0.2   
 5 5         18         0            17       0.444        0.444        0.0556
 6 6         34         0.0294       14       0.324        0.324        0.294 
 7 7         27         0.0370       16       0.259        0.481        0.148 
 8 8         32         0            21       0.344        0.375        0.0938
 9 9         23         0            14       0.261        0.435        0.174 
10 10        22         0.273        18       0.455        0.364        0.0455
# ℹ 397 more rows
# ℹ 1 more variable: prop_stageIV &lt;dbl&gt;</code></pre>
</div>
</div>
</section><section id="example-cancer-remission-2" class="slide level2"><h2>Example: cancer remission</h2>
<p>Now we should see if there’s any evidence of clustering</p>
<div class="cell" data-hash="slides-2-1_cache/revealjs/cancer icc_84e21f509a08c75b62a0c6d1050e585c">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(ICCbin)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># get ICC for remission outcomes - this function can take a while to run #</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">iccbin</span>( <span class="at">cid =</span> doc_ID, <span class="at">y =</span> remission, <span class="at">data =</span> cancer,</span>
<span id="cb3-5"><a href="#cb3-5"></a>        <span class="at">method =</span> <span class="st">"rm"</span>, <span class="at">ci.type =</span> <span class="st">"rm"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$estimates
              Methods       ICC
1 Resampling Estimate 0.3718346

$ci
                                  Type   LowerCI   UpperCI
1 Resampling Based Confidence Interval 0.3357405 0.4079287</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>Decent amount of clustering!</li>
</ul>
</div>
</section><section id="example-cancer-remission-3" class="slide level2"><h2>Example: cancer remission</h2>
<p>Now let’s see what a <span class="alert">non-clustered</span> logistic regression would get us:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>logistic_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>( remission <span class="sc">~</span> Experience <span class="sc">+</span> <span class="fu">factor</span>(CancerStage),</span>
<span id="cb5-2"><a href="#cb5-2"></a>         <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb5-3"><a href="#cb5-3"></a>         <span class="at">data =</span> cancer)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>logistic_fit_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(logistic_fit)</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="fu">summary</span>(logistic_fit)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)            -1.97454210 0.11705470 -16.868541 7.666646e-64
Experience              0.08389574 0.00609915  13.755316 4.732102e-43
factor(CancerStage)II  -0.33108865 0.05577013  -5.936666 2.908764e-09
factor(CancerStage)III -0.70970702 0.07084838 -10.017265 1.279957e-23
factor(CancerStage)IV  -1.72417405 0.12105741 -14.242614 4.982759e-46</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>
<p><span class="math inline">\(e^{\beta_1}\)</span>: 1.0875</p>
<ul>
<li><p>95% CI: (1.0746, 1.1006)</p></li>
<li><p><span class="alert">Interpretation</span>: <span class="fragment">Cancer patients have an estimated 8.75% increased odds of going into remission if they have a physician with 1 year of experience compared to 0 years, cancer stage held constant. We are 95% confident the true odds is between 7.46 and 7.46%.</span></p></li>
</ul>
</li>
</ul>
</div><div class="column" style="width:30%;">
<div class="fragment">
<p><span class="alert">Can we trust this estimate?</span></p>
</div>
<div class="fragment">
<ul>
<li>Assumptions: correct mean model; <span class="alert">independent</span> observations</li>
</ul>
</div>
</div>
</div>
</section><section id="example-cancer-remission-4" class="slide level2"><h2>Example: cancer remission</h2>
<p>Now what about a logistic GLMM with random intercepts by physician:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb7-2"><a href="#cb7-2"></a>glmm_fit <span class="ot">&lt;-</span> <span class="fu">glmer</span>( remission <span class="sc">~</span> Experience <span class="sc">+</span> CancerStage <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> doc_ID), <span class="at">family =</span> binomial, <span class="at">data =</span> cancer, </span>
<span id="cb7-3"><a href="#cb7-3"></a>         <span class="at">control=</span><span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>) )</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># confint() can take a long time with glmer(), so usually just best to calculate CIs by hand</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>glmm_fit_ci_l <span class="ot">&lt;-</span> <span class="fu">exp</span>( <span class="fu">summary</span>(glmm_fit)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">summary</span>(glmm_fit)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) )</span>
<span id="cb7-7"><a href="#cb7-7"></a>glmm_fit_ci_u <span class="ot">&lt;-</span> <span class="fu">exp</span>( <span class="fu">summary</span>(glmm_fit)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">summary</span>(glmm_fit)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) )</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="fu">summary</span>( glmm_fit )<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)    -2.9477893 0.48456845  -6.083329 1.177125e-09
Experience      0.1187726 0.02649019   4.483643 7.337924e-06
CancerStageII  -0.4856890 0.07099432  -6.841238 7.851168e-12
CancerStageIII -1.1208592 0.09006870 -12.444492 1.498347e-35
CancerStageIV  -2.4858983 0.14796101 -16.801036 2.398188e-63</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:60%;">
<p>Logistic GLMM results:</p>
<ul>
<li>
<p><span class="math inline">\(e^{\beta_1}\)</span>: 1.1261</p>
<ul>
<li><p>95% CI: (1.0691, 1.1861)</p></li>
<li><p><span class="alert">Interpretation</span>: <span class="fragment">Cancer patients have an estimated 11.35% increased odds of going into remission if they have a physician with 1 year of experience compared to the same physician with 0 years experience, cancer stage held constant. We are 95% confident the true odds is between 6.91 and 18.61%.</span></p></li>
</ul>
</li>
</ul>
</div><div class="column" style="width:40%;">
<p>Compare to what we had with the unclustered logistic model:</p>
<ul>
<li>
<p><span class="math inline">\(e^{\beta_1}\)</span>: 1.0875</p>
<ul>
<li>95% CI: (1.0746, 1.1006)</li>
</ul>
</li>
</ul>
</div>
</div>
</section><section id="example-cancer-remission-5" class="slide level2"><h2>Example: cancer remission</h2>
<p>A brief comparison of <code>glmmPQL</code> vs <code>glmer</code> (Laplace) vs <code>glmer</code> (GQ with 10 q-points):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb9-2"><a href="#cb9-2"></a>pql_fit <span class="ot">&lt;-</span> <span class="fu">glmmPQL</span>( remission <span class="sc">~</span> Experience <span class="sc">+</span> CancerStage,</span>
<span id="cb9-3"><a href="#cb9-3"></a>         <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> doc_ID, <span class="at">family =</span> binomial, <span class="at">data =</span> cancer, <span class="at">verbose =</span> F )</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="fu">summary</span>( pql_fit )<span class="sc">$</span>tTable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Value  Std.Error   DF    t-value      p-value
(Intercept)    -2.6355391 0.44747734 8115  -5.889771 4.021412e-09
Experience      0.1074656 0.02450726  405   4.385051 1.480059e-05
CancerStageII  -0.4681372 0.06208941 8115  -7.539727 5.218208e-14
CancerStageIII -1.0892780 0.07847836 8115 -13.879980 2.612280e-43
CancerStageIV  -2.4132991 0.12745333 8115 -18.934767 2.823650e-78</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">summary</span>(glmm_fit)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)    -2.9477893 0.48456845  -6.083329 1.177125e-09
Experience      0.1187726 0.02649019   4.483643 7.337924e-06
CancerStageII  -0.4856890 0.07099432  -6.841238 7.851168e-12
CancerStageIII -1.1208592 0.09006870 -12.444492 1.498347e-35
CancerStageIV  -2.4858983 0.14796101 -16.801036 2.398188e-63</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>glmm_fit_agq <span class="ot">&lt;-</span> <span class="fu">glmer</span>( remission <span class="sc">~</span> Experience <span class="sc">+</span> CancerStage <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> doc_ID),<span class="at">family =</span> binomial, <span class="at">data =</span> cancer,</span>
<span id="cb13-2"><a href="#cb13-2"></a>                       <span class="at">control=</span><span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>), <span class="at">nAGQ=</span><span class="dv">10</span> )</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="fu">summary</span>(glmm_fit_agq)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)    -2.9529558 0.50079175  -5.896574 3.711257e-09
Experience      0.1189719 0.02730504   4.357139 1.317733e-05
CancerStageII  -0.4867531 0.07279083  -6.687011 2.277741e-11
CancerStageIII -1.1241823 0.09217574 -12.196076 3.261673e-34
CancerStageIV  -2.4922475 0.15023385 -16.589121 8.353380e-62</code></pre>
</div>
</div>
</section><section id="alternate-link-functions-for-binary-data" class="slide level2"><h2>Alternate link functions for binary data</h2>
<p>Binary outcomes are special in that there are several alternative link functions you can use</p>
<ul>
<li>
<p>The <span class="alert">logit</span> link is very common</p>
<ul>
<li>Gives us odds ratios and log-odds ratios for <span class="math inline">\(\beta_1\)</span>
</li>
</ul>
</li>
<li>
<p>The <span class="alert">probit</span> link is sometimes used in certain fields for prediction</p>
<ul>
<li><p>Function is the inverse Normal CDF</p></li>
<li><p>Coefficients are very difficult to interpret</p></li>
</ul>
</li>
<li>
<p>The <span class="alert">log</span> link and <span class="alert">identity</span> links also get used</p>
<ul>
<li>The former gives us risk ratios for <span class="math inline">\(\beta_1\)</span>, while the latter gives us risk differences for <span class="math inline">\(\beta_1\)</span>
</li>
</ul>
</li>
</ul>
<div class="fragment">
<p>In this case, we choose our link function based on 2 criteria:</p>
<ol type="1">
<li><p>What quantity are we actually wanting to estimate?</p></li>
<li>
<p>Do we have many observations with outcome probabilities very near 0 or 1?</p>
<ul>
<li>This will cause instability if you use log or identity link functions, but you should be okay if you’re using a logit link</li>
</ul>
</li>
</ol>
</div>
</section><section id="marginal-effects-in-glmms" class="slide level2"><h2>Marginal effects in GLMMs</h2>
<p>Last week we noted that marginal and conditional effects are <em>identical</em> in LMEs</p>
<ul>
<li>This is not the case for all GLMMs</li>
</ul>
<p>Take a logistic mixed effects model:</p>
<p><span class="math display">\[\text{logit}(\vec{Y}_i) = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i} + \vec{\epsilon}_i\]</span></p>
<div class="fragment">
<ul>
<li>The conditional mean of our outcome is then: <span class="math display">\[\text{logit}(\mu_i)=\text{logit}(E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}]) = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}\]</span>
</li>
</ul>
</div>
</section><section id="marginal-effects-in-glmms-1" class="slide level2"><h2>Marginal effects in GLMMs</h2>
<p>In order to get the marginal effects, we would need to inverse-transform the outcome (undo the logit function): <span class="math display">\[E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}] = \frac{\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}{1+\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}\]</span></p>
<div class="fragment">
<p>and then take the marginal expectation of that: <span class="math display">\[\begin{align*}E[\vec{Y}_i|\boldsymbol{X}_i] &amp;= E\left\{E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}]\right\}\\
&amp;=E\left[\frac{\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}{1+\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}\right]\end{align*}\]</span></p>
</div>
<div class="fragment">
<ul>
<li>Clearly, <span class="math inline">\(E[\vec{Y}_i|\boldsymbol{X}_i]\)</span> <span class="alert">is not the same as</span> <span class="math inline">\(\frac{\exp(\boldsymbol{X}_i\vec{\beta})}{1+\exp(\boldsymbol{X}_i\vec{\beta})}\)</span>
</li>
</ul>
</div>
<div class="fragment">
<p>This phenomenon is known as <span class="alert">non-collapsibility</span></p>
</div>
</section><section id="marginal-effects-in-identity-link-glmms" class="slide level2"><h2>Marginal effects in (identity link) GLMMs</h2>
<p>But what if had a GLMM with a binary outcome and an identity link?</p>
<p><span class="math display">\[\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i} + \vec{\epsilon}_i\]</span></p>
<div class="fragment">
<ul>
<li>The conditional mean of our outcome is then: <span class="math display">\[E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}] = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}\]</span>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>Since <span class="math inline">\(g(\vec{Y}_i) = \vec{Y}_i\)</span>, there’s no function to “undo” to isolate <span class="math inline">\(E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}]\)</span></p></li>
<li><p>So,</p></li>
</ul>
<p><span class="math display">\[\begin{align*}E[\vec{Y}_i|\boldsymbol{X}_i] &amp;= E\left\{E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}]\right\}\\
&amp;=E\left[\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}\right]\\
&amp;=\boldsymbol{X}_i\vec{\beta}\end{align*}\]</span></p>
<ul>
<li>The conditional and marginal effects are identical again!</li>
</ul>
</div>
</section><section id="marginal-effects-in-glmms-2" class="slide level2"><h2>Marginal effects in GLMMs</h2>
<p>So what happens when we have transformed outcomes and want marginal effects?</p>
<div class="fragment">
<ul>
<li>
<p>You could integrate out the random effects: <span class="math display">\[E\left[\frac{\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}{1+\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}\right] = \int_{-\infty}^{\infty}\frac{\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}{1+\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})} f(b_{0i})db_{0i}\]</span></p>
<ul>
<li>where <span class="math inline">\(f(b_{0i})\)</span> is the pdf for the random intercept</li>
</ul>
</li>
</ul>
<p>but this generally doesn’t end up with a nice formulaic solution…</p>
</div>
<div class="fragment">
<ul>
<li>You could use an approximation: <span class="math display">\[\text{logit}(\vec{Y}_i) = \frac{\boldsymbol{X}_i\vec{\beta}}{\sqrt{(1+0.346\sigma^2_b)}}\]</span>
</li>
</ul>
<p>but this is very sensitive to any model misspecification and can be biased</p>
</div>
<div class="fragment">
<p>Maybe what we need are specific <span class="alert">marginal models</span> that incorporate clustering… (stay tuned for next week)</p>
<p><img src="POPUHEALSMPH_color-flush.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="slides-2-1_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="slides-2-1_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/notes/notes.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/search/search.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="slides-2-1_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': true,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>