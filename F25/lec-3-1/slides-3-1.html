<!DOCTYPE html>
<html lang="en"><head>
<script src="slides-3-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides-3-1_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides-3-1_files/libs/quarto-html/popper.min.js"></script>
<script src="slides-3-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides-3-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides-3-1_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides-3-1_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="slides-3-1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<title>slides-3-1</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="slides-3-1_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="slides-3-1_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="slides-3-1_files/libs/revealjs/dist/theme/quarto.css">
<link href="slides-3-1_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="slides-3-1_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="slides-3-1_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="slides-3-1_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="slides-3-1_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="slides-3-1_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2"><h1>
Lecture 3.1: Marginal models for correlated data
</h1>
<h2>
PHS 651: Advanced regression methods
</h2>
<hr>
<h3>
Mary Ryan Baumann, PhD
</h3>
<h3>
September 23, 2025
</h3>
<p><br></p>
<div style="font-size: 75%;">
<p><strong>Recording disclosure</strong></p>
<p><em>This class is being conducted in person, as well as over <span class="alert">Zoom</span>. As the instructor, I will be <span class="alert">recording</span> this session. I have disabled the recording feature for others so that no one else will be able to record this session. I will be posting this session to the course‚Äôs website.</em></p>
<p><em>If you have privacy concerns and do not wish to appear in the recording, you may turn video off (click ‚Äústop video‚Äù) so that Zoom does not record you.</em></p>
<p><em>The chat box is always open for discussion and questions to the entire class. You may also send messages privately to the instructor. Please note that Zoom saves all chat transcripts.</em></p>
</div>
<div class="absolute" style="left: 300px; bottom: 280px; width: 1500px; ">
<p>Slides found at: <a href="https://maryryan.github.io/PHS-651-slides/F25/lec-3-1/slides-3-1" class="uri">https://maryryan.github.io/PHS-651-slides/F25/lec-3-1/slides-3-1</a></p>
</div>
<div class="absolute" style="left: 50px; bottom: 175px; width: 250px; ">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-3-1_files/figure-revealjs/qr%20code-1.png" width="192"></p>
</div>
</div>
</div>
</section><section id="recap-generalized-linear-mixed-effect-models" class="slide level2"><h2>Recap: (generalized) linear mixed effect models</h2>
<p>One way to account for clustering in analysis is with a <span class="alert">(generalized) linear mixed effects</span> model <span class="math display">\[g(Y_{ij}) = \color{red}{\beta_0 + U_{ij}\beta_1} + \color{blue}{Z_ib_{0i}}+ \epsilon_{ij}\]</span> <span class="math display">\[g(\vec{Y}_i) = \color{red}{\boldsymbol{X}_i\vec{\beta}} + \color{blue}{\vec{Z}_ib_{0i}}+\vec{\epsilon}_i\]</span> (<em>Transformed outcome for individual j in cluster i, modeled as a function of the exposure status for individual j in cluster i, with cluster-level random effects</em>)</p>
<ul>
<li><p><span class="math inline">\(g(\cdot)\)</span> is a <span class="alert">link function</span> that transforms the outcome</p></li>
<li><p><span class="math inline">\(\color{red}{\beta_0 + u_{ij}\beta_1}\)</span> (or <span class="math inline">\(\color{red}{\boldsymbol{X}_i\vec{\beta}}\)</span>) are the <span class="alert">fixed effects</span> modeling the mean outcome response as a function of variables</p></li>
<li><p><span class="math inline">\(\color{blue}{Z_i b_{0i}}\)</span> (<span class="math inline">\(\color{blue}{\vec{Z}_ib_{0i}}\)</span>) are the <span class="alert">random effects</span> accounting for random between-cluster variation</p></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span> (<span class="math inline">\(\vec{\epsilon}_i\)</span>) is the regular between-individual variation</p></li>
<li><p>We assume the outcome observations in cluster <em>i</em>, <span class="math inline">\(\vec{Y}_i\)</span>, follow a <span class="alert">multivariate probability distribution</span></p></li>
</ul></section><section id="recap-generalized-linear-mixed-effect-models-1" class="slide level2"><h2>Recap: (generalized) linear mixed effect models</h2>
<p>One way to account for clustering in analysis is with a <span class="alert">(generalized) linear mixed effects</span> model <span class="math display">\[g(Y_{ij}) = \color{red}{\beta_0 + U_{ij}\beta_1} + \color{blue}{Z_ib_{0i}}+ \epsilon_{ij}\]</span> <span class="math display">\[g(\vec{Y}_i) = \color{red}{\boldsymbol{X}_i\vec{\beta}} + \color{blue}{\vec{Z}_ib_{0i}}+\vec{\epsilon}_i\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="random-intercept.png" style="width:120.0%"></p>
<figcaption><em>Figure modified from Harrison et al.&nbsp;(2018). ‚ÄúA brief introduction to mixed effects modelling and multi-model inference in ecology.‚Äù Ecology.</em></figcaption></figure>
</div>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[\mu_{\text{group}} = \beta_0\]</span> <span class="math display">\[\alpha_1 = \beta_0 + b_{0i}\]</span></p>
</div>
</div>
</section><section id="recap-generalized-linear-mixed-effect-models-2" class="slide level2"><h2>Recap: (generalized) linear mixed effect models</h2>
<p>One way to account for clustering in analysis is with a <span class="alert">(generalized) linear mixed effects</span> model <span class="math display">\[g(Y_{ij}) = \color{red}{\beta_0 + U_{ij}\beta_1} + \color{blue}{Z_ib_{0i}}+ \epsilon_{ij}\]</span> <span class="math display">\[g(\vec{Y}_i) = \color{red}{\boldsymbol{X}_i\vec{\beta}} + \color{blue}{\vec{Z}_ib_{0i}}+\vec{\epsilon}_i\]</span></p>
<p>The <span class="alert">fixed effects</span> are shared across everyone in the sample, while the <span class="alert">random effects</span> are unique to a particular cluster (however we define cluster)</p>
<div class="fragment">
<p><br> Interpretations of <span class="math inline">\(\beta_1\)</span> in an LME (identity link) are technically <span class="alert">conditional</span> because they are comparing 2 individuals with the same cluster membership (<span class="math inline">\(E[Y_{ij} | \boldsymbol{X}_i, b_{0i}]\)</span>)</p>
<ul>
<li>It is easy to separate out the random effects, though, and get the <span class="alert">marginal</span> interpretation</li>
</ul>
</div>
</section><section id="recap-generalized-linear-mixed-effect-models-3" class="slide level2"><h2>Recap: (generalized) linear mixed effect models</h2>
<p>One way to account for clustering in analysis is with a <span class="alert">(generalized) linear mixed effects</span> model <span class="math display">\[g(Y_{ij}) = \color{red}{\beta_0 + U_{ij}\beta_1} + \color{blue}{Z_ib_{0i}}+ \epsilon_{ij}\]</span> <span class="math display">\[g(\vec{Y}_i) = \color{red}{\boldsymbol{X}_i\vec{\beta}} + \color{blue}{\vec{Z}_ib_{0i}}+\vec{\epsilon}_i\]</span></p>
<p>The <span class="alert">fixed effects</span> are shared across everyone in the sample, while the <span class="alert">random effects</span> are unique to a particular cluster (however we define cluster)</p>
<p><br> Interpretations of <span class="math inline">\(\beta_1\)</span> in a GLMM are <span class="alert">strictly conditional</span> because they are comparing 2 individuals with the same cluster membership, or have the same random effect value (<span class="math inline">\(g\left(E[Y_{ij} | \boldsymbol{X}_i, b_{0i}]\right)\)</span>)</p>
<ul>
<li><p>Often referred to as having individual-specific or cluster-specific interpretation</p></li>
<li><p>Possible to extract marginal effects from conditional models, but often complicated and prone to bias</p></li>
</ul></section><section id="recap-marginal-effects-in-glmms" class="slide level2"><h2>Recap: Marginal effects in GLMMs</h2>
<p>In order to get the marginal effects, we would need to inverse-transform the outcome (undo the logit function): <span class="math display">\[E[Y_{ij}|\boldsymbol{X}_i, b_{0i}] = \frac{\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}{1+\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}~~~~~~~ E[Y_{ij}|\boldsymbol{X}_i, b_{0i}] = \frac{\exp(\beta_0 + U_{ij}\beta_1 + Z_ib_{0i})}{1+\exp(\beta_0 + U_{ij}\beta_1 + Z_ib_{0i})}\]</span></p>
<p>and then take the marginal expectation of that:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\begin{align*}E[\vec{Y}_i|\boldsymbol{X}_i] &amp;= E\left\{E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}]\right\}\\
&amp;=E\left[\frac{\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}{1+\exp(\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i})}\right]\end{align*}\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[\begin{align*}E[Y_{ij}|\boldsymbol{X}_i] &amp;= E\left\{E[Y_{ij}|\boldsymbol{X}_i, b_{0i}]\right\}\\
&amp;=E\left[\frac{\exp(\beta_0 + U_{ij}\beta_1 + Z_ib_{0i})}{1+\exp(\beta_0 + U_{ij}\beta_1 + Z_ib_{0i})}\right]\end{align*}\]</span></p>
</div>
</div>
<ul>
<li>Clearly, <span class="math inline">\(E[\vec{Y}_i|\boldsymbol{X}_i]\)</span> <span class="alert">is not the same as</span> <span class="math inline">\(g(E[\vec{Y}_i|\boldsymbol{X}_i])=\frac{\exp(\boldsymbol{X}_i\vec{\beta})}{1+\exp(\boldsymbol{X}_i\vec{\beta})}\)</span>
</li>
</ul>
<p>This phenomenon is known as <span class="alert">non-collapsibility</span></p>
</section><section id="recap-generalized-linear-mixed-effect-models-4" class="slide level2"><h2>Recap: (generalized) linear mixed effect models</h2>
<p>One way to account for clustering in analysis is with a <span class="alert">(generalized) linear mixed effects</span> model <span class="math display">\[g(Y_{ij}) = \color{red}{\beta_0 + U_{ij}\beta_1} + \color{blue}{Z_ib_{0i}}+ \epsilon_{ij}\]</span> <span class="math display">\[g(\vec{Y}_i) = \color{red}{\boldsymbol{X}_i\vec{\beta}} + \color{blue}{\vec{Z}_ib_{0i}}+\vec{\epsilon}_i\]</span></p>
<p>The <span class="alert">fixed effects</span> are shared across everyone in the sample, while the <span class="alert">random effects</span> are unique to a particular cluster (however we define cluster)</p>
<p><br> Interpretations of <span class="math inline">\(\beta_1\)</span> in a GLMM are <span class="alert">strictly conditional</span> because they are comparing 2 individuals with the same cluster membership, or have the same random effect value (<span class="math inline">\(g\left(E[Y_{ij} | \boldsymbol{X}_i, b_{0i}]\right)\)</span>)</p>
<ul>
<li><p>Often referred to as having individual-specific or cluster-specific interpretation</p></li>
<li><p>Possible to extract marginal effects from conditional models, but often complicated and prone to bias</p></li>
</ul>
<p><span class="alert">What if we want to look at the marginal effect of an exposure ‚Äì one that‚Äôs <em>averaged across</em> all clusters?</span></p>
</section><section id="marginal-models" class="slide level2"><h2>Marginal models</h2>
<p>Basic idea: we want to account for clustering of data, but make inference about <span class="alert">population averages</span> (marginal effects)</p>
<ul>
<li><p>We‚Äôre often very interested in these in public and population health!</p></li>
<li><p>Not to be confused with the average treatment effect (ATE) ‚Äì this is a different concept</p></li>
<li><p>Mean response is conditional <em>only</em> on the adjustment covariates we add to the mean model</p></li>
</ul>
<div class="fragment">
<p><br> Rigid distributional assumptions got in the way of this in LMEs/GLMMs</p>
<ul>
<li><p>Adding random effects were how we were able to have non-0 covariance (<span class="math inline">\(Cov[Y_{ij},Y_{ik}]\ne 0\)</span>) while still allowing for our outcome to follow a proper probability distribution</p></li>
<li><p>This allowed us to assume some things about our data and not have to estimate them</p></li>
<li><p>So for marginal models we want to use <span class="alert">fewer distributional assumptions</span></p></li>
</ul>
<!-- . . . --><!-- - How can we account for correlation among outcome observations/non-0 covariance without the rigidity of distribution assumptions? -->
</div>
</section><section id="r-side-and-g-side-variance" class="slide level2"><h2>R-side and G-side variance</h2>
<p><span class="math display">\[g(\vec{Y}_i) = \boldsymbol{X}_i\vec{\beta} + \boldsymbol{Z}_ib_{0i} + \vec{\epsilon}_i\]</span></p>
<ul>
<li><p>Recall that with LMEs and GLMMs, we modeled our <u>systematic variation</u> (random effects and within-cluster individual variation) as: <span class="math display">\[\vec{b}_0 \sim N(\vec{0}, \boldsymbol{G}),~~~ \vec{\epsilon}_i \sim N(\vec{0}, \boldsymbol{R}_i=\sigma_\epsilon^2\boldsymbol{I})\]</span></p></li>
<li><p>When using random effects (like in LMEs and GLMMs), some call this modeling with <span class="alert">G-side variance</span></p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p>The <span class="math inline">\(\boldsymbol{G}\)</span> matrix with random intercepts looked like: <span class="math display">\[\begin{bmatrix}
\sigma^2_b + \sigma^2_\epsilon &amp; \sigma^2_b &amp; \dots &amp; \sigma^2_b\\
\sigma^2_b &amp; \ddots &amp; \dots &amp; \sigma^2_b\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2_b &amp; \dots &amp; \sigma^2_b &amp; \sigma^2_b + \sigma^2_\epsilon
\end{bmatrix}\]</span></p>
</div><div class="column" style="width:50%;">
<p>The <span class="math inline">\(\boldsymbol{R}_i = \sigma^2_{\epsilon}\boldsymbol{I}\)</span> matrix for within-cluster individual variation looked like: <span class="math display">\[\begin{bmatrix}
\sigma^2 &amp; 0 &amp; \dots &amp; 0 \\
0 &amp; \ddots &amp; \dots &amp; 0 \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
0 &amp; \dots &amp; 0 &amp; \sigma^2
\end{bmatrix}\]</span></p>
</div>
</div>
<ul>
<li><p>These random effects <span class="math inline">\(\vec{\gamma}\)</span> were difficult to marginalize out of the expectation when we used a non-identity link function</p></li>
<li><p>What if instead we had <em>no</em> random effects (<span class="math inline">\(\boldsymbol{G}=0\)</span>), and modeled non-zero covariance using <span class="math inline">\(\vec{\epsilon}_i\)</span> and a <span class="math inline">\(\boldsymbol{R}_i \ne \sigma^2_\epsilon \boldsymbol{I}\)</span>?</p></li>
</ul></section><section id="r-side-and-g-side-variance-1" class="slide level2"><h2>R-side and G-side variance</h2>
<p><span class="math display">\[g(\vec{Y}_i) = \boldsymbol{X}_i\vec{\beta} + \boldsymbol{Z}_ib_{0i} + \vec{\epsilon}_i\]</span></p>
<ul>
<li><p>Recall that with LMEs and GLMMs, we modeled our <u>systematic variation</u> (random effects and within-cluster variation) as: <span class="math display">\[\vec{b}_0 \sim N(\vec{0}, \boldsymbol{G}),~~~ \vec{\epsilon}_i \sim N(\vec{0}, \boldsymbol{R}_i=\sigma_\epsilon^2\boldsymbol{I})\]</span></p></li>
<li><p>When using random effects (like in LMEs and GLMMs), some call this modeling with G-side variance</p></li>
<li>
<p>When using <span class="math inline">\(\boldsymbol{G}=0\)</span> (no random intercepts), we call this modeling with <span class="alert">R-side variance</span></p>
<ul>
<li><p><span class="alert">Marginal modeling</span> approaches tend to exclusively model with <u>R-side variance</u></p></li>
<li><p>Downside: this means we‚Äôre not modeling the outcome using a proper probability distribution (more on this soon‚Ä¶)</p></li>
</ul>
</li>
</ul>
<!--    - Those assumptions focused on specifying [within-cluster and between cluster variability]{.alert}, and helped show what the covariance matrix for a cluster should look like and how we could estimate model parameters --><!--    - What if we focused more on the [within-cluster correlation]{.alert}, and use an [empirically estimated]{.alert} covariance structure? --></section><section id="marginal-model-components" class="slide level2"><h2>Marginal model components</h2>
<p>There are 2 main components of a marginal model</p>
<ol type="1">
<li>The <span class="alert">marginal expectation</span> of the outcome <span class="math inline">\(E[Y_{ij}|\vec{X}_{ij}]=\mu_{ij}\)</span>:</li>
</ol>
<ul>
<li>
<span class="math inline">\(\mu_{ij}\)</span> should only depend on the covariates in the model through the link function <span class="math inline">\(g(\cdot)\)</span>: <span class="math inline">\(~g(\mu_{ij}) = \vec{X}_{ij}\vec{\beta}\)</span>
</li>
</ul>
<ol start="2" type="1">
<li>The covariance of the outcome <span class="math inline">\(Cov[Y_{ij}, Y_{ik}|\boldsymbol{X}_i]\)</span>, which can be broken down into 2 more components:</li>
</ol>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<ol type="i">
<li>The <span class="alert">marginal variance</span> of the outcome:</li>
</ol>
<p><span class="math display">\[Var[Y_{ij}|\vec{X}_{ij}] = \varphi v(\mu_{ij})\]</span></p>
<ul>
<li>Should depend on the marginal mean through the variance function <span class="math inline">\(v(\cdot)\)</span> and a scale parameter <span class="math inline">\(\varphi\)</span>
</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<ol start="2" type="i">
<li>The <span class="alert">within-cluster association</span> of the outcomes (<span class="math inline">\(Corr[Y_{ij},Y_{ik}]\)</span>)</li>
</ol>
<ul>
<li>Should depend on the means and a correlation parameter(s)</li>
</ul>
</div>
</div>
</div>
<div class="fragment absolute" style="bottom: 200px; right: 200px; width: 30%; ">
<p><span class="alert">Component 2 is kind of like the systematic variation in GLMMs we saw in lecture 2.1!</span></p>
</div>
</section><section id="marginal-model-components-example-continuous-outcomes" class="slide level2"><h2>Marginal model components example: continuous outcomes</h2>
<p>For example, in a model with clustered continuous responses <span class="math inline">\(Y_{ij}\)</span> and only one exposure <span class="math inline">\(U_{ij}\)</span>, we might have:</p>
<ol type="1">
<li><span class="math inline">\(E[Y_{ij}|\boldsymbol{X}_i] = \mu_{ij} = \beta_0 + U_{ij}\beta_1\)</span></li>
</ol>
<ul>
<li><p>We specify this based on our domain knowledge, hypotheses we want to test, model-building strategies, etc</p></li>
<li><p>To account for confounding, we would add additional variables to the right hand side so that we <span class="alert">correctly model the mean</span></p></li>
</ul>
<div class="fragment">
<p>2.1. <span class="math inline">\(Var[Y_{ij}|\boldsymbol{X}] = \varphi_{i} = \sigma^2\)</span></p>
<ul>
<li><p>Clusters share a common variance, which we assume is independent of <span class="math inline">\(\mu_{ij}\)</span></p></li>
<li><p>Could also assume difference variances for each cluster, <span class="math inline">\(\sigma^2_i\)</span>!</p></li>
</ul>
</div>
<div class="fragment">
<p>2.2. <span class="math inline">\(Corr[Y_{ij}, Y_{ik}] = \alpha\)</span></p>
<ul>
<li>Outcomes in same cluster are all correlated by <span class="math inline">\(\alpha\)</span>
</li>
</ul>
</div>
</section><section id="marginal-model-components-example-continuous-outcomes-1" class="slide level2"><h2>Marginal model components example: continuous outcomes</h2>
<p>For example, in a model with clustered continuous responses <span class="math inline">\(Y_{ij}\)</span> and only one exposure <span class="math inline">\(U_{ij}\)</span>, we might have:</p>
<ol type="1">
<li><span class="math inline">\(E[Y_{ij}|\boldsymbol{X}_i] = \mu_{ij} = \beta_0 + U_{ij}\beta_1\)</span></li>
</ol>
<p>2.1. <span class="math inline">\(Var[Y_{ij}|\boldsymbol{X}] = \varphi_{i} = \sigma^2\)</span></p>
<p>2.2. <span class="math inline">\(Corr[Y_{ij}, Y_{ik}] = \alpha\)</span></p>
<ul>
<li>This means we can assume a <span class="alert">correlation structure</span> for one cluster that looks like:</li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; \alpha &amp; \dots &amp; \alpha \\
\alpha &amp; \ddots &amp; \dots &amp; \alpha \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha &amp; \dots &amp; \alpha &amp; 1
\end{bmatrix}\]</span></p>
</section><section id="marginal-model-components-example-continuous-outcomes-2" class="slide level2"><h2>Marginal model components example: continuous outcomes</h2>
<p>If we combined 2.1 and 2.2, we get the covariance between two outcomes in the same cluster: <span class="math display">\[\begin{align*}Cov[Y_{ij}, Y_{ik}] &amp;= sd[Y_{ij}|\boldsymbol{X}] ~Corr[Y_{ij}, Y_{ik}] ~sd[Y_{ij}|\boldsymbol{X}]\\
&amp;= \sqrt{\sigma^2}~ \alpha ~\sqrt{\sigma^2}\\
&amp;=\sigma^2\alpha\end{align*}\]</span></p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<p>which creates us a <span class="alert">covariance matrix</span> for cluster <span class="math inline">\(i\)</span>, <span class="math inline">\(V_i\)</span>, that looks like:</p>
<p><span class="math display">\[V_i=\begin{bmatrix}
\sigma^2 &amp; \sigma^2\alpha &amp; \dots &amp; \sigma^2\alpha \\
\sigma^2\alpha &amp; \ddots &amp; \dots &amp; \sigma^2\alpha \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2\alpha &amp; \dots &amp; \sigma^2\alpha &amp; \sigma^2
\end{bmatrix}\]</span></p>
<p>We call <span class="math inline">\(V_i\)</span> the <span class="alert">‚Äúworking‚Äù covariance</span> matrix</p>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>which <em>looks</em> different than the covariance matrix we‚Äôd get from an LME:</p>
<p><span class="math display">\[\begin{bmatrix}
\sigma^2_b + \sigma^2_\epsilon &amp; \sigma^2_b &amp; \dots &amp; \sigma^2_b\\
\sigma^2_b &amp; \ddots &amp; \dots &amp; \sigma^2_b\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2_b &amp; \dots &amp; \sigma^2_b &amp; \sigma^2_b + \sigma^2_\epsilon
\end{bmatrix}\]</span></p>
<p><span class="fragment">but these are actually the same if <span class="math inline">\(\sigma^2 = \sigma^2_b + \sigma^2_\epsilon\)</span> and <span class="math inline">\(\sigma^2\alpha = \sigma^2_b\)</span></span> <span class="fragment">ü§Ø</span></p>
</div>
</div>
</div>
</div>
</section><section id="marginal-model-components-example-continuous-outcomes-3" class="slide level2"><h2>Marginal model components example: continuous outcomes</h2>
<p>If we combined 2.1 and 2.2, we get the covariance between two outcomes in the same cluster: <span class="math display">\[\begin{align*}Cov[Y_{ij}, Y_{ik}] &amp;= sd[Y_{ij}|\boldsymbol{X}] ~Corr[Y_{ij}, Y_{ik}] ~sd[Y_{ij}|\boldsymbol{X}]\\
&amp;= \sqrt{\sigma^2}~ \alpha ~\sqrt{\sigma^2}\\
&amp;=\sigma^2\alpha\end{align*}\]</span></p>
<ul>
<li>Outcomes for individuals in <strong>different</strong> clusters would still have a covariance of 0 though because we‚Äôre assuming that <span class="alert">clusters are independent of one another</span>
</li>
</ul></section><section id="marginal-model-components-example-continuous-outcomes-4" class="slide level2"><h2>Marginal model components example: continuous outcomes</h2>
<p>If we combined 2.1 and 2.2, we get the covariance between two outcomes in the same cluster: <span class="math display">\[\begin{align*}Cov[Y_{ij}, Y_{ik}] &amp;= sd[Y_{ij}|\boldsymbol{X}] ~Corr[Y_{ij}, Y_{ik}] ~sd[Y_{ij}|\boldsymbol{X}]\\
&amp;= \sqrt{\sigma^2}~ \alpha ~\sqrt{\sigma^2}\\
&amp;=\sigma^2\alpha\end{align*}\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>which creates us a <span class="alert">covariance matrix</span> for cluster <span class="math inline">\(i\)</span> that looks like:</p>
<p><span class="math display">\[V_i=\begin{bmatrix}
\sigma^2 &amp; \sigma^2\alpha &amp; \dots &amp; \sigma^2\alpha \\
\sigma^2\alpha &amp; \ddots &amp; \dots &amp; \sigma^2\alpha \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2\alpha &amp; \dots &amp; \sigma^2\alpha &amp; \sigma^2
\end{bmatrix}\]</span></p>
</div><div class="column" style="width:50%;">
<p>which <em>looks</em> different than the covariance matrix we‚Äôd get from an LME:</p>
<p><span class="math display">\[\begin{bmatrix}
\sigma^2_b + \sigma^2_\epsilon &amp; \sigma^2_b &amp; \dots &amp; \sigma^2_b\\
\sigma^2_b &amp; \ddots &amp; \dots &amp; \sigma^2_b\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2_b &amp; \dots &amp; \sigma^2_b &amp; \sigma^2_b + \sigma^2_\epsilon
\end{bmatrix}\]</span></p>
</div>
</div>
<p><span class="alert">Can we assume other types of correlation/covariance structures?</span> <span class="fragment">Yes!</span></p>
</section><section id="correlation-structures-independence" class="slide level2"><h2>Correlation structures: independence</h2>
<p>The most basic (and the one we have the most prior experience with) is the <span class="alert">independence</span> correlation structure</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Assumes all observations in a cluster are completely uncorrelated with each other</li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; 0 &amp; \dots &amp; 0 \\
0 &amp; \ddots &amp; \dots &amp; 0 \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
0 &amp; \dots &amp; 0 &amp; 1
\end{bmatrix}\]</span></p>
<div class="fragment">
<ul>
<li>We don‚Äôt have to estimate anything here!</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>Assuming <span class="math inline">\(Var[Y_{ij}|\boldsymbol{X}] = \sigma^2\)</span>, creates a covariance matrix that looks like</p>
<p><span class="math display">\[V_i=\begin{bmatrix}
\sigma^2 &amp; 0 &amp; \dots &amp; 0 \\
0 &amp; \ddots &amp; \dots &amp; 0 \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
0 &amp; \dots &amp; 0 &amp; \sigma^2
\end{bmatrix}\]</span></p>
</div>
</div>
</div>
</section><section id="correlation-structures-exchangeable" class="slide level2"><h2>Correlation structures: exchangeable</h2>
<p>Another type is the <span class="alert">exchangeable</span> correlation structure (AKA: compound symmetry)</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Assumes all observations in a cluster are related to each other to the same degree</li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; \alpha &amp; \dots &amp; \alpha \\
\alpha &amp; \ddots &amp; \dots &amp; \alpha \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha &amp; \dots &amp; \alpha &amp; 1
\end{bmatrix}\]</span></p>
<div class="fragment">
<ul>
<li>Need to estimate <span class="math inline">\(\alpha\)</span>
</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>Assuming <span class="math inline">\(Var[Y_{ij}|\boldsymbol{X}] = \sigma^2\)</span>, creates a covariance matrix that looks like</p>
<p><span class="math display">\[V_i=\begin{bmatrix}
\sigma^2 &amp; \sigma^2\alpha &amp; \dots &amp; \sigma^2\alpha \\
\sigma^2\alpha &amp; \ddots &amp; \dots &amp; \sigma^2\alpha \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2\alpha &amp; \dots &amp; \sigma^2\alpha &amp; \sigma^2
\end{bmatrix}\]</span></p>
</div>
</div>
</div>
</section><section id="correlation-structures-unstructured" class="slide level2"><h2>Correlation structures: unstructured</h2>
<p>Could you assume all observations are (potentially) related to each other in different ways?</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Known as an <span class="alert">unstructured</span> correlation structure</li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; \alpha_{12} &amp; \dots &amp; \alpha_{1n} \\
\alpha_{21} &amp; \ddots &amp; \dots &amp; \alpha_{2n} \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha_{n1} &amp; \dots &amp; \alpha_{n(n-1)} &amp; 1
\end{bmatrix}\]</span></p>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="1">
<p>Assuming <span class="math inline">\(Var[Y_{ij}|\boldsymbol{X}] = \sigma^2\)</span>, creates a covariance matrix that looks like</p>
<p><span class="math display">\[V_i=\begin{bmatrix}
\sigma^2 &amp; \sigma^2\alpha_{12} &amp; \dots &amp; \sigma^2\alpha_{1n} \\
\sigma^2\alpha_{21} &amp; \ddots &amp; \dots &amp; \sigma^2\alpha_{2n} \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2\alpha_{n1} &amp; \dots &amp; \sigma^2\alpha_{n(n-1)} &amp; \sigma^2
\end{bmatrix}\]</span></p>
</div>
</div>
</div>
<div class="fragment" data-fragment-index="2">
<ul>
<li>Offers maximum flexibility because correlations can be the same, very similar, or completely different from each other</li>
</ul>
</div>
<div class="fragment" data-fragment-index="3">
<ul>
<li>
<p>But also requires you to estimate <em>every</em> correlation parameter in this matrix separately</p>
<ul>
<li>This can cause computational and efficiency issues</li>
</ul>
</li>
</ul>
</div>
</section><section id="correlation-structures-unstructured-1" class="slide level2"><h2>Correlation structures: unstructured</h2>
<p>Could you assume all observations are (potentially) related to each other in different ways?</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Known as an <span class="alert">unstructured</span> correlation structure</li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; \alpha_{12} &amp; \dots &amp; \alpha_{1n} \\
\alpha_{21} &amp; \ddots &amp; \dots &amp; \alpha_{2n} \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha_{n1} &amp; \dots &amp; \alpha_{n(n-1)} &amp; 1
\end{bmatrix}\]</span></p>
</div><div class="column" style="width:50%;">
<p>Assuming <span class="math inline">\(Var[Y_{ij}|\boldsymbol{X}] = \sigma^2\)</span>, creates a covariance matrix that looks like</p>
<p><span class="math display">\[V_i=\begin{bmatrix}
\sigma^2 &amp; \sigma^2\alpha_{12} &amp; \dots &amp; \sigma^2\alpha_{1n} \\
\sigma^2\alpha_{21} &amp; \ddots &amp; \dots &amp; \sigma^2\alpha_{2n} \\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2\alpha_{n1} &amp; \dots &amp; \sigma^2\alpha_{n(n-1)} &amp; \sigma^2
\end{bmatrix}\]</span></p>
</div>
</div>
<ul>
<li>Can get away with unstructured correlation in small data sets, but usually easier to assume a simpler structure</li>
</ul></section><section id="marginal-model-components-1" class="slide level2"><h2>Marginal model components</h2>
<p>So we have the main components of a marginal model</p>
<ol type="1">
<li><p>The marginal expectation of the outcome: <span class="math inline">\(g(E[Y_{ij}| \vec{X}_{ij}]) = g(\mu_{ij}) = \vec{X}_{ij}\vec{\beta}\)</span></p></li>
<li>
<p>The covariance of the outcome</p>
<ol type="i">
<li><p>The marginal variance of the outcome: <span class="math inline">\(Var[Y_{ij}|\vec{X}_{ij}] = \varphi v(\mu_{ij})\)</span></p></li>
<li><p>The within-cluster association of the outcomes (correlation structure)</p></li>
</ol>
</li>
</ol>
<p><span class="alert">But how do we use these components to estimate our regression coefficients?</span></p>
<div class="fragment">
<ul>
<li>With OLS and LMEs/GLMMs, we had a likelihood-based estimating equation we could use to derive estimates for <span class="math inline">\(\beta\)</span> (see lecture 2.1)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>What if we used something like the GLM estimating equation here?</li>
</ul>
</div>
<div class="fragment">
<p>Thus is born <span class="alert">generalized estimating equations</span></p>
<!-- --- -->
<!-- ## Marginal models and estimating equations -->
<!-- We want to take the 3 components of the marginal model -->
<!-- 1. The marginal expectation of the outcome $g(E[Y_{ij}| \vec{X}_{ij}]) = g(\mu_{ij}) = \vec{X}_{ij}\vec{\beta}$ -->
<!-- 2. The marginal variance of the outcome: $Var[Y_{ij}|\vec{X}_{ij}] = \varphi v(\mu_{ij})$ -->
<!-- 3. The within-cluster association of the outcomes -->
<!-- and shove them into something that looks like the GLM estimating equation -->
<!-- . . . -->
<!-- Thus is born [generalized estimating equations]{.alert} -->
</div>
</section><section id="generalized-estimating-equations" class="slide level2"><h2>Generalized estimating equations</h2>
<p>Generalized estimating equations (<span class="alert">GEEs</span>) find the <span class="math inline">\(\beta\)</span> that solves an estimating equation of the general form: <span class="math display">\[\sum_{i=1}^N \left(\frac{\partial \mu_i}{\partial \beta}\right)^T V_i^{-1}[y_{ij} - \mu_{ij}(\vec{\beta})] = 0\]</span></p>
<ul>
<li>Almost exactly the same as the one we saw for GLMs!</li>
</ul>
<div class="fragment">
<ul>
<li>
<p>Difference here: <span class="math inline">\(V_i\)</span> is the <span class="alert">working covariance</span> for the outcome</p>
<ul>
<li>
<p>Explicitly accounts for models of outcome variance <em>and</em> within-cluster association (components 2.1 and 2.2)</p>
<p><span class="math display">\[V_i = sd[Y_{ij}|\boldsymbol{X}] ~Corr[Y_{ij}, Y_{ik}] ~sd[Y_{ij}|\boldsymbol{X}]\]</span></p>
</li>
<li><p>Called ‚Äúworking‚Äù to distinguish it from the <em>true</em> covariance matrix of <span class="math inline">\(\vec{Y}_i\)</span></p></li>
</ul>
</li>
</ul>
</div>
</section><section id="generalized-estimating-equations-1" class="slide level2"><h2>Generalized estimating equations</h2>
<p>Generalized estimating equations (GEEs) find the <span class="math inline">\(\beta\)</span> that solves an estimating equation of the general form: <span class="math display">\[\sum_{i=1}^N \left(\frac{\partial \mu_i}{\partial \beta}\right)^T V_i^{-1}[y_{ij} - \mu_{ij}(\vec{\beta})] = 0\]</span></p>
<p>Since this estimating equation <span class="alert">only depends on the mean <span class="math inline">\(\mu_{ij}(\cdot)\)</span> and the working (co)variance <span class="math inline">\(V_i\)</span></span>, a GEE doesn‚Äôt have to correspond to a full likelihood/distribution like a GLMM does</p>
<ul>
<li><p>This means we have <span class="alert">fewer assumptions</span> about how <span class="math inline">\(Y_{ij}\)</span> behaves</p></li>
<li><p>Also lets us ‚Äúmix and match‚Äù different forms for the marginal model components into this one estimating equation</p></li>
<li><p>e.g., we don‚Äôt need to theoretically derive the covariance - we can just approximate it using the variance and the chosen correlation structure</p></li>
</ul></section><section id="generalized-estimating-equations-2" class="slide level2"><h2>Generalized estimating equations</h2>
<p>Generalized estimating equations (GEEs) find the <span class="math inline">\(\beta\)</span> that solves an estimating equation of the general form: <span class="math display">\[\sum_{i=1}^N \left(\frac{\partial \mu_i}{\partial \beta}\right)^T V_i^{-1}[y_{ij} - \mu_{ij}(\vec{\beta})] = 0\]</span></p>
<p>Since this estimating equation <span class="alert">only depends on the mean <span class="math inline">\(\mu_{ij}(\cdot)\)</span> and the working (co)variance <span class="math inline">\(V_i\)</span></span>, a GEE doesn‚Äôt have to correspond to a full likelihood/distribution like a GLMM does</p>
<p><span class="alert">What‚Äôs the effect of this?</span></p>
<div class="fragment">
<ul>
<li>Estimation of model parameters no longer done by maximum likelihood or REML, but by an iterative algorithm (like Newton-Raphson)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>We can‚Äôt answer questions about cluster-specific trajectories like we can with GLMMs</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Fewer assumptions means results will be <span class="alert">more robust</span> to incorrect assumptions about the marginal model components (e.g., wrong correlation structure, wrong variance) üéâ</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Also means we <span class="alert">need more data</span> (specifically, more clusters) to run this model üôÅ</li>
</ul>
</div>
</section><section id="glmms-vs-gees" class="slide level2"><h2>GLMMs vs GEEs</h2>
<p>We noted that GEEs are <em>marginal</em> models while GLMMS are <em>conditional</em> models‚Ä¶</p>
<p><span class="alert">What are some other differences between GEEs and GLMMs?</span></p>
<div class="fragment">
<table>
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>GEE</th>
<th>GLMM</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Interpretation</td>
<td>‚ÄúPopulation‚Äù-level</td>
<td>Cluster-level</td>
</tr>
<tr class="even">
<td>Accounting for correlation</td>
<td>Empirical estimation</td>
<td>Specification of random effects</td>
</tr>
<tr class="odd">
<td>Assumptions</td>
<td>Weak assumptions; more robust (correlation structure, over-dispersion)</td>
<td>Strong assumptions; less robust</td>
</tr>
<tr class="even">
<td>Sample size requirements</td>
<td>Moderately large (<span class="math inline">\(n &gt; 50\)</span>)</td>
<td>Works with smaller numbers of clusters provided that the entire model is correctly specified</td>
</tr>
<tr class="odd">
<td>Computational burden</td>
<td>Light</td>
<td>Heavy</td>
</tr>
<tr class="even">
<td>Cluster-level prediction?</td>
<td>No</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p><span class="alert">Big take away:</span> GLMMs and GEEs aren‚Äôt so much different models, as different ways of estimating models</p>
</div>
</section><section id="a-note-on-population-level-interpretation" class="slide level2"><h2>A note on ‚Äúpopulation‚Äù-level interpretation</h2>
<p>GEEs are often touted as having ‚Äúpopulation‚Äù-level interpretations as opposed to GLMMs cluster-level ones</p>
<ul>
<li>This is usually easier to think about than marginal vs conditional effects</li>
</ul>
<p>Our estimates (and our interpretations!) are only as good as our data, though</p>
<ul>
<li><p>If the data we‚Äôre using to build a GEE isn‚Äôt <span class="alert">representative of the population</span> we‚Äôre interested in, it‚Äôs not going to magically give us results generalizable to the population</p></li>
<li><p>A more accurate description would be that GEEs give us sample-population-level interpretations while GLMMs give us sample-cluster-level interpretations</p></li>
</ul></section><section id="gees-radon" class="slide level2"><h2>GEEs: radon</h2>
<p>Let‚Äôs use our old Minnesota radon data we used back in lecture 1.2</p>
<ul>
<li>Recall that we want to estimate how the floor we measure on affects radon measurements in Minnesota houses, which are clustered by county</li>
</ul>
<p>We‚Äôd assume:</p>
<ul>
<li><p>Mean model:</p></li>
<li><p>Variance:</p></li>
<li><p>Correlation structure:</p></li>
</ul></section><section id="gees-radon-1" class="slide level2"><h2>GEEs: radon</h2>
<p>Let‚Äôs use our old Minnesota radon data we used back in lecture 2.1</p>
<ul>
<li>Recall that we want to estimate how the floor we measure on affects radon measurements in Minnesota houses, which are clustered by county</li>
</ul>
<p>We‚Äôd assume:</p>
<ul>
<li><p>Mean model: <span class="alert"><span class="math inline">\(E[\text{log radon}_{ij}|\vec{X}_{ij}] = \beta_0 + \beta_1(\text{floor}_{ij})\)</span></span><br></p></li>
<li><p>Variance: <span class="alert"><span class="math inline">\(Var[Y_{ij}] = \sigma^2\)</span></span></p></li>
<li><p>Correlation structure: <span class="alert">exchangeable (just one correlation parameter to estimate)</span></p></li>
</ul></section><section id="gees-radon-2" class="slide level2"><h2>GEEs: radon</h2>
<p>Let‚Äôs run it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(gee)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># run a GEE with exchangeable correlation clustered on counties #</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>radon_gee <span class="ot">&lt;-</span> <span class="fu">gee</span>( log_radon <span class="sc">~</span> floor,</span>
<span id="cb1-5"><a href="#cb1-5"></a>                  <span class="at">id=</span>cntyfips, <span class="co"># cluster ID needs to be a number, not names or categories</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>                  <span class="at">data=</span>radon.mn, <span class="at">corstr=</span><span class="st">"exchangeable"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       floor 
  1.3624099  -0.5864218 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">summary</span>( radon_gee )<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  1.5011024 0.05525251  27.16804  0.05101495 29.424759
floor       -0.6698925 0.06583761 -10.17492  0.07746389 -8.647803</code></pre>
</div>
</div>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span>: -0.6699</p></li>
<li><p>Ignore the ‚Äúnaive‚Äù and ‚Äúrobust‚Äù SEs for now ‚Äì we‚Äôll talk about that more on Thursday</p></li>
</ul></section><section id="gees-radon-3" class="slide level2"><h2>GEEs: radon</h2>
<p>Let‚Äôs compare our GEE result with what we would get from an LME:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># run a LME with random county intercepts #</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>radon_lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>( log_radon <span class="sc">~</span> floor <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>county),</span>
<span id="cb5-5"><a href="#cb5-5"></a>                  <span class="at">data=</span>radon.mn )</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">summary</span>( radon_lme )<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error   t value
(Intercept)  1.4923932 0.04955304 30.117088
floor       -0.6628887 0.06765334 -9.798315</code></pre>
</div>
</div>
<ul>
<li><p>Exchangeable GEE <span class="math inline">\(\beta_1\)</span>: -0.6699</p></li>
<li>
<p>LME <span class="math inline">\(\beta_1\)</span>: -0.6629</p>
<ul>
<li><p>Not that different on point estimates!</p></li>
<li><p>Where we‚Äôll likely see the biggest differences is in the inference/95% CIs/standard errors‚Ä¶ more on than Thursday</p></li>
</ul>
</li>
</ul></section><section id="take-home-messages" class="slide level2"><h2>Take home messages</h2>
<ul>
<li>We add random effects to GLMMs to help <span class="alert">model non-0 covariance</span> (correlation between observations)</li>
</ul>
<p><br></p>
<ul>
<li>Because GLMMs are derived from the assumption that the outcome follows a specific probability distribution, it‚Äôs hard to get marginal interpretations of results because it‚Äôs <span class="alert">difficult separate out the random effects</span> when we have a <u>non-identity link function</u>
</li>
</ul>
<p><br></p>
<ul>
<li>GEEs allow us to model the mean and covariance of a regression <span class="alert">separately</span> and in a way that doesn‚Äôt have distributional assumptions, so we can easily get the <span class="alert">population-averaged interpretation</span>
</li>
</ul>
<p><br></p>
<ul>
<li>GEEs tend to be more robust to breaking assumptions, but we <span class="alert">need more clusters</span> to pay for that flexibility</li>
</ul>
<p><img src="POPUHEALSMPH_color-flush.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="slides-3-1_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="slides-3-1_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/notes/notes.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/search/search.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="slides-3-1_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': true,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1200,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>