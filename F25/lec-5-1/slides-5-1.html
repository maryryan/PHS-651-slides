<!DOCTYPE html>
<html lang="en"><head>
<script src="slides-5-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides-5-1_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides-5-1_files/libs/quarto-html/popper.min.js"></script>
<script src="slides-5-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides-5-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides-5-1_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides-5-1_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="slides-5-1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<title>slides-5-1</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="slides-5-1_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="slides-5-1_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="slides-5-1_files/libs/revealjs/dist/theme/quarto.css">
<link href="slides-5-1_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="slides-5-1_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="slides-5-1_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="slides-5-1_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="slides-5-1_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="slides-5-1_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2"><h1>
Lecture 5.1: Diagnostics for GLMMs and GEEs
</h1>
<h2>
PHS 651: Advanced regression methods
</h2>
<hr>
<h3>
Mary Ryan Baumann, PhD
</h3>
<h3>
October 7, 2025
</h3>
<p><br></p>
<div style="font-size: 75%;">
<p><strong>Recording disclosure</strong></p>
<p><em>This class is being conducted in person, as well as over <span class="alert">Zoom</span>. As the instructor, I will be <span class="alert">recording</span> this session. I have disabled the recording feature for others so that no one else will be able to record this session. I will be posting this session to the course’s website.</em></p>
<p><em>If you have privacy concerns and do not wish to appear in the recording, you may turn video off (click “stop video”) so that Zoom does not record you.</em></p>
<p><em>The chat box is always open for discussion and questions to the entire class. You may also send messages privately to the instructor. Please note that Zoom saves all chat transcripts.</em></p>
</div>
<div class="absolute" style="left: 260px; bottom: 5px; width: 1500px; ">
<p>Slides found at: <a href="https://maryryan.github.io/PHS-651-slides/F25/lec-5-1/slides-5-1" class="uri">https://maryryan.github.io/PHS-651-slides/F25/lec-5-1/slides-5-1</a></p>
</div>
<div class="absolute" style="left: 100px; bottom: 0px; width: 150px; ">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-5-1_files/figure-revealjs/qr%20code-1.png" width="192"></p>
</div>
</div>
</div>
</section><section id="roadmap" class="slide level2"><h2>Roadmap</h2>
<ul>
<li><p>Modeling choices/assumptions for LMEs/GLMMs and GEEs</p></li>
<li><p>Marginal and conditional residual analysis for LMEs/GLMMs</p></li>
<li><p>Investigating over/under-dispersion in Poisson GLMMs/GEEs</p></li>
<li><p>Influential observations in LMEs/GLMMs/GEEs: leverage and DFBETA</p></li>
<li><p>Other diagnostics for GEEs</p></li>
</ul></section><section id="model-diagnostics" class="slide level2"><h2>Model diagnostics</h2>
<p>So far we’ve dealt with how to model correlated data</p>
<ul>
<li>But how do we assess whether the modeling choices we’ve made are sound?</li>
</ul>
<div class="fragment">
<p>There are some analyses/diagnostics we can perform to explore this</p>
</div>
<div class="fragment">
<ul>
<li>
<p>Heavy emphasis on <span class="alert">explore</span></p>
<ul>
<li><p>We know that our model likely won’t perfectly reflect the true form/relationships in the data</p></li>
<li><p>But we should assess whether there are <span class="alert">major discrepancies</span> between what we’ve assumed and what’s in the data</p></li>
<li><p>Use these as a temperature check for whether the model needs to be adjusted, how much confidence can be placed in estimates, and whether estimates need to be presented with caveats</p></li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<p>Also, in the non-longitudinal clustered data settings, there are not many diagnostic checks for GEE models</p>
<ul>
<li><p>This is because we aren’t <em>assuming</em> much for GEEs - we’re estimating most of the covariance matrix</p></li>
<li><p>So we’ll mostly be focusing on mixed models in this session</p></li>
</ul>
</div>
</section><section id="modeling-choices" class="slide level2"><h2>Modeling choices</h2>
<p>Let’s review the various modeling choices we’ve covered so far</p>
<p>First, we can choose between conditional/mixed vs marginal models</p>
<ul>
<li>Usually this will be driven by whether we want a conditional or population-averaged interpretation of our effects</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="1">
<p>Within conditional/mixed models, we make decisions about:</p>
<ul>
<li><p>Variable for random intercepts</p></li>
<li><p><span class="fragment highlight-red" data-fragment-index="3">Variable(s) for fixed effects (isolating causal pathway)</span></p></li>
<li><p><span class="fragment highlight-red" data-fragment-index="3">Outcome distribution</span></p></li>
<li><p>Link function</p></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="2">
<p>Within marginal models, we make decisions about:</p>
<ul>
<li><p><span class="fragment highlight-red" data-fragment-index="3">How to specify the mean model/what variables to include to isolate causal pathway</span></p></li>
<li><p>Marginal variance function</p></li>
<li><p>Correlation structure</p></li>
<li><p>Model-based vs robust confidence intervals</p></li>
</ul>
</div>
</div>
</div>
</section><section id="mixed-model-residual-analysis" class="slide level2"><h2>Mixed model residual analysis</h2>
<p>Recall the form of a LME with one exposure variable <span class="math inline">\(U_{ij}\)</span> for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[\begin{align*}&amp;\vec{Y}_i = \boldsymbol{X}_{i}\vec{\beta} + Z_ib_{0i} + \vec{\epsilon}_{i}\\
&amp;Y_{ij} = \beta_0 + U_{ij}\beta_1 + Z_ib_{0i} + \epsilon_{ij}\end{align*}\]</span></p>
<p><span class="alert">Residuals</span> are the difference between the observed outcomes and the ones predicted by your model</p>
<p><span class="math display">\[r_{ij} = Y_{ij} - \vec{X}_{ij}\widehat{\vec{\beta}}\]</span></p>
<ul>
<li>In mixed models, we refer to <span class="math inline">\(r_{ij}\)</span> as the <span class="alert">marginal residuals</span> (only subtracting the fixed effects)</li>
</ul>
<div class="fragment">
<p>In mixed models, we <u>also</u> have <span class="alert">conditional residuals</span> (subtracting marginal and random effects): <span class="math display">\[r^c_{ij} = Y_{ij} - \left(\vec{X}_{ij}\widehat{\vec{\beta}} + Z_i \hat{b}_{i0}\right)\]</span></p>
</div>
</section><section id="mixed-model-residual-analysis-1" class="slide level2"><h2>Mixed model residual analysis</h2>
<p>Recall the form of a LME with one exposure variable <span class="math inline">\(U_{ij}\)</span> for individual <span class="math inline">\(j\)</span> in cluster <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[\begin{align*}&amp;\vec{Y}_i = \boldsymbol{X}_{i}\vec{\beta} + Z_ib_{0i} + \vec{\epsilon}_{i}\\
&amp;Y_{ij} = \beta_0 + U_{ij}\beta_1 + Z_ib_{0i} + \epsilon_{ij}\end{align*}\]</span></p>
<p><span class="math display">\[\text{Marginal residuals: }r_{ij} = Y_{ij} - \vec{X}_{ij}\widehat{\vec{\beta}}\]</span></p>
<p><span class="math display">\[\text{Conditional residuals: }r^c_{ij} = Y_{ij} - \left(\vec{X}_{ij}\widehat{\vec{\beta}} + Z_i \hat{b}_{i0}\right)\]</span></p>
<p>If the model <u>adequately captures</u> the systematic trend of the response, then <u>the residuals should exhibit no systematic pattern</u></p>
<ul>
<li>i.e., they should be scattered fairly randomly around zero</li>
</ul>
<p>The marginal and conditional residuals will tell us different things about where we might be seeing misspecification/issues with model assumptions</p>
</section><section id="marginal-residuals-vs-predictedfitted-response" class="slide level2"><h2>Marginal residuals vs predicted/fitted response</h2>
<p><span class="alert">Marginal</span> residuals can be used to check for systematic departures from the model for the <span class="alert">mean response</span></p>
<ul>
<li>
<p>We often do this by making a scatter plot of marginal residuals vs marginal predicted values</p>
<ul>
<li>Fitting a smoothed curve (e.g., lowess) through the scatter plot can help visualize any trends</li>
</ul>
</li>
</ul>
<p><img data-src="residual-plot-example.png" width="1000"></p>
<div class="absolute" style="bottom: 250px; right: 0px; width: 45%; ">
<ul>
<li>
<p>Usually, any (major) systematic pattern in the residual indicates inadequacy of the model in some way</p>
<ul>
<li><p>Solution: re-fit the data with a more flexible model (e.g., interactions, quadratic terms, and perhaps more covariates)</p></li>
<li><p>This only works for LMEs, though! Usually very hard to check functional form of covariates for logistic or log-linear GLMMs</p></li>
</ul>
</li>
</ul>
</div>
</section><section id="conditional-residuals-vs-predicted-response" class="slide level2"><h2>Conditional residuals vs predicted response</h2>
<p>Conditional residuals can be used to check for overall model fit (mean response, use of random effects, or constant individual-level variance)</p>
<p><img data-src="residual-plot-example.png" width="1000"></p>
<div class="absolute" style="bottom: 380px; right: 0px; width: 45%; ">
<ul>
<li>Plots of <span class="alert">conditional</span> residuals against <span class="alert">conditional</span> fitted values will tell you about how well the data fits your assumptions about the random intercepts (zero mean), the constant <span class="math inline">\(\epsilon_{ij}\)</span> variance assumption, and whether you have outlying subjects/clusters</li>
</ul>
</div>
</section><section id="conditional-residuals-vs-predicted-response-1" class="slide level2"><h2>Conditional residuals vs predicted response</h2>
<p>In R, we can plot the model object to get a conditional residuals plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># run an LME with random intercepts for county #</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>radon_lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>(log_radon <span class="sc">~</span> floor <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> county), <span class="at">data=</span>radon.mn)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">plot</span>(radon_lme, <span class="at">smooth=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides-5-1_files/figure-revealjs/resid%20plot-1.png" width="960"></p>
</div>
</div>
<div class="absolute" style="top: 450px; right: 100px; ">
<ul>
<li><p>Points fairly randomly distributed around 0</p></li>
<li><p>Smoothed line not showing significant trends</p></li>
</ul>
</div>
</section><section id="residuals-vs-predicted-response" class="slide level2"><h2>Residuals vs predicted response</h2>
<p>We can also get the marginal residuals using the <code>hlm_diag()</code> function:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(HLMdiag)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># get various standardized residuals #</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>radon_resid <span class="ot">&lt;-</span> <span class="fu">hlm_resid</span>(radon_lme,</span>
<span id="cb2-5"><a href="#cb2-5"></a>                         <span class="at">standardize=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">colnames</span>(radon_resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "id"              "log_radon"       "floor"           "county"         
 [5] ".std.resid"      ".fitted"         ".std.ls.resid"   ".ls.fitted"     
 [9] ".chol.mar.resid" ".mar.fitted"    </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>radon_resid <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>.mar.fitted, <span class="at">y=</span>.chol.mar.resid))<span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>   <span class="fu">geom_smooth</span>(<span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>   <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides-5-1_files/figure-revealjs/marg%20resid%20plot2-1.png" width="960"></p>
</div>
</div>
</div>
</div>
<ul>
<li>Since <code>floor</code> only takes on 2 values, our marginal fitted values only take on 2 values</li>
</ul></section><section id="residuals-vs-predicted-response-1" class="slide level2"><h2>Residuals vs predicted response</h2>
<p>We can also use <code>hlm_resid()</code> to get a nicer-looking conditional residuals plot than base R provides</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>radon_resid <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>.std.resid))<span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>   <span class="fu">geom_smooth</span>(<span class="at">se=</span>F, <span class="at">col=</span><span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>   <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides-5-1_files/figure-revealjs/marg%20resid%20plot3-1.png" width="960"></p>
</div>
</div>
</section><section id="residuals-vs-predicted-response-2" class="slide level2"><h2>Residuals vs predicted response</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>In SAS, we can add the <code>plots=studentpanel</code> option to the end of <code>PROC GLIMMIX</code> to look at the studentized residuals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource sas number-lines code-with-copy"><code class="sourceCode"><span id="cb6-1"><a href="#cb6-1"></a>PROC GLIMMIX data=dance plots=studentpanel(marginal conditional);</span>
<span id="cb6-2"><a href="#cb6-2"></a>   class village_id dance_class_bin(REF="0");</span>
<span id="cb6-3"><a href="#cb6-3"></a>   model gaitfollowup = dance_class_bin / dist = normal solution cl;</span>
<span id="cb6-4"><a href="#cb6-4"></a>   random intercept / subject=village_id;</span>
<span id="cb6-5"><a href="#cb6-5"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Our residuals vs fitted plot would be the one in the top left</p></li>
<li><p><code>studentpanel</code> defaults to conditional residuals, but we can add <code>(marginal conditional)</code> to have SAS display both</p></li>
</ul>
</div><div class="column" style="width:35%;">
<p><img data-src="residualpanel_std.png" width="1000"></p>
</div>
</div>
</section><section id="residuals-vs-covariates" class="slide level2"><h2>Residuals vs covariates</h2>
<p>We can follow a similar strategy for checking the functional form of covariates</p>
<ol type="1">
<li><p>Plot (marginal) residual vs covariate</p></li>
<li><p>If any systematic pattern, try adding a quadratic term for the covariate or transforming the covariate</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>radon_resid <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>floor, <span class="at">y=</span>.chol.mar.resid))<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>   <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides-5-1_files/figure-revealjs/floor%20resid%20plot-1.png" width="960"></p>
</div>
</div>
</section><section id="investigating-dispersion-in-poisson-glmms-recap-from-week-2-recorded-video" class="slide level2"><h2>Investigating dispersion in Poisson GLMMs (recap from week 2 recorded video)</h2>
<p>Recall that Poisson GLMMs assume that the mean and variance of the data are the same</p>
<ul>
<li><p>When this assumption is broken, we say that <span class="alert">dispersion</span> is present</p></li>
<li><p>If variance <span class="math inline">\(&gt;\)</span> mean, we have <span class="alert">over</span>dispersion</p></li>
<li><p>If variance <span class="math inline">\(&lt;\)</span> mean, we have <span class="alert">under</span>dispersion</p></li>
</ul>
<p>If dispersion is present this is an indicator that we likely want to fit something like a Negative Binomial GLMM that allows variance <span class="math inline">\(\ne\)</span> mean</p>
<ul>
<li>If that does not fix the issue, it may be that the dispersion is caused by “excess” zeros - in this case, something like a zero-inflated Poisson or NB model might work better</li>
</ul></section><section id="investigating-dispersion-in-poisson-models-recap-from-week-2-recorded-video" class="slide level2"><h2>Investigating dispersion in Poisson models (recap from week 2 recorded video)</h2>
<p>To see if dispersion is present, we can calculate the dispersion parameter using the squared sum of Pearson residuals: <span class="math display">\[\widehat\phi = \frac{\sum[\text{Pearson Residual}_{ij}^2]}{\text{Residual degrees of freedom}}\]</span></p>
<ul>
<li><p>Pearson residuals correct for the unequal variance in the raw residuals by dividing by the standard deviation - this includes an estimate of the dispersion paramter (which we’re extracting above)</p></li>
<li><p><span class="math inline">\(\hat\phi\)</span> should be 1 if there is absolutely no dispersion</p></li>
<li><p>Will usually expect this not to be <em>exactly</em> 1, but major departures (rule of thumb: <span class="math inline">\(&lt;0.75\)</span> or <span class="math inline">\(&gt;1.4\)</span>) indicate a NB model is likely better</p></li>
</ul></section><section id="investigating-dispersion-in-poisson-models-recap-from-week-2-recorded-video-1" class="slide level2"><h2>Investigating dispersion in Poisson models (recap from week 2 recorded video)</h2>
<p>SAS calculates and displays <span class="math inline">\(\hat\phi\)</span> in its default result output - For <code>PROC GLIMMIX method=QUAD</code>, the dispersion parameter is listed under “Pearson Chi-Square / DF” in the “fit statistics for conditional distribution” table</p>
<p><img data-src="glimmix_quad.png" width="700"></p>
<!-- https://documentation.sas.com/doc/en/statcdc/14.2/statug/statug_glimmix_examples19.htm  -->
</section><section id="investigating-dispersion-in-poisson-models-recap-from-week-2-recorded-video-2" class="slide level2"><h2>Investigating dispersion in Poisson models (recap from week 2 recorded video)</h2>
<p>In R, we can calculate the dispersion parameter by hand:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb8-2"><a href="#cb8-2"></a>awards_quad <span class="ot">&lt;-</span> <span class="fu">glmer</span>( awards <span class="sc">~</span> write <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> cid),</span>
<span id="cb8-3"><a href="#cb8-3"></a>                      <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>), <span class="at">data =</span> awards,</span>
<span id="cb8-4"><a href="#cb8-4"></a>                      <span class="at">control=</span><span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>) )</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># estimate dispersion parameter #</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># pearson weighted residual sum of squares divided by degrees of freedom #</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># if not dispersion, we want this to be 1 #</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="fu">summary</span>(awards_quad)<span class="sc">$</span>devcomp<span class="sc">$</span>cmp[<span class="st">"pwrss"</span>] <span class="sc">/</span> <span class="fu">summary</span>(awards_quad)<span class="sc">$</span>AICtab[<span class="st">"df.resid"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    pwrss 
0.1233381 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># can also calculate the pearson RSS yourself #</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">sum</span>(<span class="fu">resid</span>(awards_quad, <span class="at">type=</span><span class="st">"pearson"</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">summary</span>(awards_quad)<span class="sc">$</span>AICtab[<span class="st">"df.resid"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> df.resid 
0.1233381 </code></pre>
</div>
</div>
<p>This dispersion parameter is very small, so the data is likely very under-dispersed</p>
</section><section id="investigating-dispersion-in-poisson-models-recap-from-week-2-recorded-video-3" class="slide level2"><h2>Investigating dispersion in Poisson models (recap from week 2 recorded video)</h2>
<p>We can also use the <code>testDispersion()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># can use the testDisperson() function from DHARMa as well #</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">testDispersion</span>(awards_quad, <span class="at">type=</span><span class="st">"PearsonChisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Parametric dispersion test via mean Pearson-chisq statistic

data:  awards_quad
dispersion = 0.12334, df = 197, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<ul>
<li><p>This provides a formal test for whether <span class="math inline">\(\hat{\phi} \ne 0\)</span> in addition to calculating the estimated <span class="math inline">\(\phi\)</span></p></li>
<li><p>I would generally <span class="alert">not</span> pay much attention to the p-value - focus on the estimated value for <span class="math inline">\(\phi\)</span></p></li>
</ul>
<div class="fragment">
<p>If there’s dispersion in the mixed model, there will (likely) be dispersion in the marginal model</p>
<ul>
<li>With GEEs you can combat this with robust standard errors, even if you don’t specify a NB marginal variance</li>
</ul>
</div>
</section><section id="leverage" class="slide level2"><h2>Leverage</h2>
<p>We may also be interested in whether we have particularly influential observations in our data that are (overly) influencing our model estimates - we investigate this via “leverage” or Cook’s distance plots</p>
<ul>
<li><p>Leverage looks at how removing an observation/cluster affects predicted values/residuals – it will tell us us about extreme values in the predictor space</p></li>
<li><p>Cook’s distance looks at how removing an observation/cluster affects regression coefficients when combined</p></li>
</ul>
<p>We can also see whether we have any particularly influential clusters as well</p>
<div class="fragment">
<p>Unfortunately <code>PROC GLIMMIX</code> doesn’t have functionality for influence metrics, but R does</p>
</div>
</section><section id="leverage-1" class="slide level2"><h2>Leverage</h2>
<p>Observation-level leverage/Cook’s D</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># looking at observation-level leverage #</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>radon_leverage_obs <span class="ot">&lt;-</span> <span class="fu">hlm_influence</span>(radon_lme, <span class="at">leverage=</span><span class="st">"overall"</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="fu">ggarrange</span>(</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="fu">dotplot_diag</span>(radon_leverage_obs<span class="sc">$</span>leverage.overall, <span class="at">cutoff=</span><span class="st">"internal"</span>, <span class="at">name=</span><span class="st">"leverage"</span>)<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Leverage"</span>),</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="fu">dotplot_diag</span>(radon_leverage_obs<span class="sc">$</span>cooksd, <span class="at">cutoff=</span><span class="st">"internal"</span>, <span class="at">name=</span><span class="st">"cooks.distance"</span>)<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Cook's distance"</span>),</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides-5-1_files/figure-revealjs/leverage-1.png" style="width:65.0%"></p>
</div>
</div>
<div class="absolute" style="bottom: 200px; right: 0px; width: 30%; ">
<p>Looks like we have a lot of observations that are influential based on Cook’s distance…</p>
</div>
</section><section id="leverage-2" class="slide level2"><h2>Leverage</h2>
<p>Cluster-level leverage/Cook’s D</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># looking at observation-level leverage on the fixed effect estimates #</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>radon_leverage_cnty <span class="ot">&lt;-</span> <span class="fu">hlm_influence</span>(radon_lme, <span class="at">leverage=</span><span class="st">"overall"</span>, <span class="at">level=</span><span class="st">"county"</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="fu">ggarrange</span>(</span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="fu">dotplot_diag</span>(radon_leverage_cnty<span class="sc">$</span>leverage.overall, <span class="at">cutoff=</span><span class="st">"internal"</span>, <span class="at">name=</span><span class="st">"leverage"</span>),</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="fu">dotplot_diag</span>(radon_leverage_cnty<span class="sc">$</span>cooksd, <span class="at">cutoff=</span><span class="st">"internal"</span>, <span class="at">name=</span><span class="st">"cooks.distance"</span>),</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides-5-1_files/figure-revealjs/leverage%20cluster-1.png" style="width:65.0%"></p>
</div>
</div>
<div class="absolute" style="bottom: 200px; right: 0px; width: 30%; ">
<p>Just a few key counties that are influential based on Cook’s distance…</p>
</div>
</section><section id="dfbeta" class="slide level2"><h2>DFBETA</h2>
<p>A similar measure of influential observations is DFBETA - it’s the change in a regression coefficient if the <span class="math inline">\(ij^{th}\)</span> observation were removed</p>
<ul>
<li>Most functions/procedures will plot DFBETAs for each coefficients in the regression</li>
</ul>
<p>DFBETA is technically agnostic to model type - should work for both conditional and marginal models</p>
<ul>
<li><p>For SAS, <code>PROC GLIMMIX</code> doesn’t have any influence statistics built in but <code>PROC GENMOD</code> does</p></li>
<li><p>For R, I’ve had issues getting the <code>lmer()</code>, <code>glmer()</code>, and <code>gee()</code> functions to play nicely with the <code><a href="https://rdrr.io/r/stats/influence.measures.html">dfbeta()</a></code> function</p></li>
</ul></section><section id="dfbeta-in-proc-genmod" class="slide level2"><h2>DFBETA in <code>PROC GENMOD</code>
</h2>
<p>In SAS, we use the <code>PLOTS(UNPACK)=DFBETA</code> option:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource sas number-lines code-with-copy"><code class="sourceCode"><span id="cb16-1"><a href="#cb16-1"></a>proc genmod data=dance PLOTS(UNPACK)=DFBETA;</span>
<span id="cb16-2"><a href="#cb16-2"></a>        class village_id dance_class_bin(REF="0");</span>
<span id="cb16-3"><a href="#cb16-3"></a>        model gaitfollowup = dance_class_bin / dist = normal;</span>
<span id="cb16-4"><a href="#cb16-4"></a>        repeated subject=village_id / type=exch;</span>
<span id="cb16-5"><a href="#cb16-5"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" data-widht="60%">
<ul>
<li>
<p>We’re looking for observations that are clearly apart from the “herd”</p>
<ul>
<li>This plot looks fairly random and scattered, though</li>
</ul>
</li>
<li><p>We could also look at the standardized DFBETA by using PLOTS(UNPACK)=DFBETAS</p></li>
</ul>
</div>
</div>
<div class="absolute" style="bottom: 50px; right: -100px; ">
<p><img data-src="DFBETA.png" width="900"></p>
</div>
</section><section id="other-diagnostics-for-gees" class="slide level2"><h2>Other diagnostics for GEEs</h2>
<p>While we don’t do a lot of model testing for GEEs, we can compare the empirical estimates of the covariance structure to the model-based estimates</p>
<ul>
<li><p>For this we can compare the model-based and robust standard errors or confidence intervals of regression coefficients</p></li>
<li>
<p>If there is a large discrepancy, our robust variance estimator is probably doing the heavy lifting of correcting this for us</p>
<ul>
<li>What’s a “large” difference? Hard to say – it can be helpful to form a ratio <span class="math inline">\(\frac{\text{robust SE}}{\text{model-based SE}}\)</span> to see what percentage larger/smaller the robust standard error is compared to the model-based one</li>
</ul>
</li>
<li><p>In this setting (non-longitudinal clustered data) though, we aren’t likely to see much discrepancy</p></li>
</ul></section><section id="take-away-messages" class="slide level2"><h2>Take away messages</h2>
<ul>
<li>
<p>More diagnostics available for assessing LMEs/GLMMs because we make more assumptions in those models</p>
<ul>
<li>Residual plots can be useful to assess whether modeled variance/covariance correctly (constant variance, random intercepts), and sometimes to assess functional form of fixed effect covariates</li>
</ul>
</li>
<li><p>Influential observation analyses, like looking at leverage or DFBETA, can be useful for either LMEs/GLMMs or GEEs to see if “outlier” observations are strongly influencing the fit of our model</p></li>
<li><p>We can assess how well we’ve modeled the covarinace in GEEs by comparing the model-based standard errors to the robust standard errors</p></li>
<li><p>What if we want to compare 2 different models? We’ll get to this after the midterm</p></li>
</ul>
<p><img src="POPUHEALSMPH_color-flush.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="slides-5-1_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="slides-5-1_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/notes/notes.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/search/search.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="slides-5-1_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': true,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>