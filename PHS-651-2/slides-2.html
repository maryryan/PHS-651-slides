<!DOCTYPE html>
<html lang="en"><head>
<script src="slides-2_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides-2_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides-2_files/libs/quarto-html/popper.min.js"></script>
<script src="slides-2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides-2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides-2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides-2_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="slides-2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<title>slides-2</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="slides-2_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="slides-2_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="slides-2_files/libs/revealjs/dist/theme/quarto.css">
<link href="slides-2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="slides-2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="slides-2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="slides-2_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="slides-2_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="slides-2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2"><h1>
Lecture 2: Conditional models for correlated data
</h1>
<h2>
PHS 651: Advanced regression methods
</h2>
<hr>
<h3>
Mary Ryan Baumann, PhD
</h3>
<h3>
September 17, 2024
</h3>
<div class="absolute" style="left: 260px; bottom: -100px; width: 1500px; ">
<p>Slides found at: <a href="https://maryryan.github.io/PHS-651-slides/PHS-651-2/slides-2" class="uri">https://maryryan.github.io/PHS-651-slides/PHS-651-2/slides-2</a></p>
</div>
<div class="absolute" style="left: 100px; bottom: -150px; width: 150px; ">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-2_files/figure-revealjs/qr%20code-1.png" width="192"></p>
</div>
</div>
</div>
</section><section id="zoom-recording-disclaimer" class="slide level2"><h2>Zoom recording disclaimer</h2>
<p><br></p>
<p>This class is being conducted in person, as well as over <span class="alert">Zoom</span>. As the instructor, I will be <span class="alert">recording</span> this session. I have disabled the recording feature for others so that no one else will be able to record this session. I will be posting this session to the course’s website.</p>
<p><br></p>
<p>If you have privacy concerns and do not wish to appear in the recording, you may turn video off (click “stop video”) so that Zoom does not record you.</p>
<p><br></p>
<p>The chat box is always open for discussion and questions to the entire class. You may also send messages privately to the instructor. Please note that Zoom saves all chat transcripts.</p>
</section><section id="recap-correlatedclustered-data" class="slide level2"><h2>Recap: correlated/clustered data</h2>
<p>What do we mean by correlated data or data that is clustered?</p>
<ul>
<li><p><u>Independent data</u>: data where each observation of a variable are not meaningfully correlated with other observations of the same variable</p></li>
<li>
<p><u>Correlated data</u>: data where each observation of a variable is not entirely independent of other observations of the same variable</p>
<ul>
<li>AKA: multilevel/hierarchical data</li>
</ul>
</li>
</ul>
<div class="fragment">
<p>The ICC is a way to measure the “clustered-ness” of the outcome</p>
<p><span class="math display">\[\text{ICC} = \frac{\text{variation in cluster means}}{\text{total variation}} = \frac{\text{variation in cluster means}}{\text{variation in cluster means } + \text{individual-level variation}}\]</span></p>
</div>
</section><section id="recap-correlatedclustered-data-1" class="slide level2"><h2>Recap: correlated/clustered data</h2>
<p>Clustering may impact analysis in several ways</p>
<ul>
<li><p>Groups/clusters may not be the same size</p></li>
<li><p>May affect variance/break the homoskedasticity assumption of OLS</p></li>
<li><p>May impact average outcome/exposure</p></li>
<li><p>Reduces the amount of information we get from each individual data point</p></li>
</ul>
<p><span class="alert">How do we account for this clustering in analysis?</span></p>
<div class="fragment">
<ul>
<li><p>Could fit separate regressions for each group… no “global” estimate of exposure effect</p></li>
<li><p>Could add group as covariate in model… violates parameters vs data size assumptions</p></li>
<li><p>Could do cluster-level model… we lose a lot of individual-level information</p></li>
<li><p>… Something else?</p></li>
</ul>
</div>
<div class="fragment">
<p>Two main “classes” of modeling approaches:</p>
<ul>
<li><p>“Conditional” models (today’s focus)</p></li>
<li><p>“Marginal” models (we’ll get to these later)</p></li>
</ul>
</div>
</section><section id="conditional-models" class="slide level2"><h2>Conditional models</h2>
<p>Basic idea: some clusters will <span class="alert">randomly</span> having higher/lower means than other</p>
<ul>
<li><p>This means we might assume to have one population-level mean <span class="math inline">\(\beta_0\)</span></p></li>
<li>
<p>And that each cluster <span class="math inline">\(i\)</span> will have a <span class="alert">cluster-specific mean</span> a little bit above/below this: <span class="math inline">\(\beta_0 \pm b_{0i}\)</span></p>
<ul>
<li>Can think of <span class="math inline">\(b_{0i}\)</span> as the cluster-specific deviation – we’ll add this to our regression model</li>
</ul>
</li>
</ul>
<div class="fragment">
<p>Model is <span class="alert">conditional</span> because the interpretation of <span class="math inline">\(\beta_1\)</span> assumes we’re comparing individuals <em>in the same cluster</em> (conditional on group membership/that cluster-specific bump)</p>
<ul>
<li><p>Just like how interpretation of <span class="math inline">\(\beta_1\)</span> assumes we’re comparing individuals who have the same value for all other covariates</p></li>
<li><p>We’ll dig into this more later</p></li>
</ul>
</div>
<div class="fragment">
<p>We can put this into practice with a <span class="alert">linear mixed effects</span> model</p>
</div>
</section><section id="the-linear-mixed-effects-model" class="slide level2"><h2>The linear mixed effects model</h2>
<p>The linear mixed effects (LME) model takes the form:</p>
<p><span class="math display">\[Y_{ij} = \beta_0 + U_{ij}\beta_1 + Z_ib_{0i}+\epsilon_{ij}\]</span></p>
<ul>
<li><p><span class="math inline">\(Z_i\)</span> is the random effects indicator for cluster <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(b_{0i}\)</span> is the <span class="alert">random intercept</span> for cluster <span class="math inline">\(i\)</span> (dimensions: <span class="math inline">\(1\times 1\)</span>)</p></li>
</ul>
<div class="fragment">
<p>Or in matrix/vector notation:</p>
<p><span class="math display">\[\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<ul>
<li><p><span class="math inline">\(\vec{Y}_i\)</span> is the response vector for cluster <span class="math inline">\(i\)</span> (dimensions: <span class="math inline">\(n_i \text{ individuals} \times 1 \text{ variable}\)</span>)</p></li>
<li><p><span class="math inline">\(\boldsymbol{X}_i\)</span> is the <span class="alert">fixed effects</span> design matrix for cluster <span class="math inline">\(i\)</span> (dimensions: <span class="math inline">\(n_i \times p\)</span>)</p></li>
<li><p><span class="math inline">\(\vec{\beta}\)</span> is the fixed effects parameter vector (dimensions: <span class="math inline">\(p \times 1\)</span>)</p></li>
<li><p><span class="math inline">\(\vec{Z}_i\)</span> is the random effects vector for cluster <span class="math inline">\(i\)</span> (dimensions: <span class="math inline">\(n_i \times 1\)</span>)</p></li>
<li><p><span class="math inline">\(\vec{\epsilon}_i\)</span> is the vector of error terms (dimensions: <span class="math inline">\(n_i \times 1\)</span>)</p></li>
</ul>
</div>
</section><section id="interpreting-lmes" class="slide level2"><h2>Interpreting LMEs</h2>
<p>Consider a simple LME with 1 exposure variable <span class="math inline">\(W\)</span>: <span class="math display">\[\vec{Y}_i = \beta_0 + \beta_1 \vec{U}_{i} + \vec{Z}_ib_{0i} + \vec{\epsilon}_i\]</span></p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span>: the (sample) population-level mean in <span class="math inline">\(Y\)</span> when <span class="math inline">\(w=0\)</span></p></li>
<li><p><span class="math inline">\(\beta_0 + b_{0i}\)</span>: the mean in <span class="math inline">\(Y\)</span> for cluster <span class="math inline">\(i\)</span> when <span class="math inline">\(w=0\)</span></p></li>
<li><p><span class="math inline">\(\beta_1\)</span>: the change in <span class="math inline">\(Y\)</span> for increasing <span class="math inline">\(W\)</span> by one unit, comparing 2 individuals <em>in the same cluster</em></p></li>
</ul>
<div class="fragment">
<p>Conditional mean: <span class="math display">\[E[Y_{ij}|\boldsymbol{X}_i, b_{0i}] = \boldsymbol{X}_i\vec{\beta} + b_{0i}\]</span></p>
<ul>
<li>Mean outcome for an individual cluster</li>
</ul>
<p>Marginal mean: <span class="math display">\[E[Y_{ij}|\boldsymbol{X}_i] = \boldsymbol{X}_i\vec{\beta}\]</span></p>
<ul>
<li>Mean outcome averaged over the entire sample</li>
</ul>
</div>
</section><section id="breaking-down-lmes" class="slide level2"><h2>Breaking down LMEs</h2>
<p>Can also represent an LME model as:</p>
<p><span class="math display">\[\vec{Y}_i = \color{green}{\boldsymbol{X}_i\vec{\beta}} + \color{blue}{\vec{\xi}_i}\]</span></p>
<ul>
<li>
<p>Allows us to break down an LME into 2 main components:</p>
<ol type="1">
<li>Mean response (as function of <span class="alert">fixed</span> covariates)</li>
</ol>
<p><span class="math display">\[\color{green}{\boldsymbol{X}_i\vec{\beta}}\]</span></p>
<ol start="2" type="1">
<li>Systematic variation (of the response/outcome) <span class="math display">\[\color{blue}{\vec{\xi}_i} = \color{red}{\vec{Z}_ib_{0i}}+\color{purple}{\vec{\epsilon}_i}\]</span> made up of:
<ol type="i">
<li>
<p>Random effects</p>
<ul>
<li>Random between-cluster variation: <span class="math inline">\(\color{red}{\vec{Z}_i b_{0i}}\)</span>
</li>
</ul>
</li>
<li><p>Within-cluster variation: <span class="math inline">\(\color{purple}{\vec{\epsilon}_i}\)</span></p></li>
</ol>
</li>
</ol>
</li>
</ul></section><section id="the-linear-mixed-effects-model-cont." class="slide level2"><h2>The linear mixed effects model (cont.)</h2>
<!-- $$\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i$$ -->
<p><span class="math display">\[\vec{\xi}_i = \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<p>We typically assume <span class="math display">\[b_{0i} \sim N(0, \sigma^2_b)\]</span> <span class="math display">\[\vec{\epsilon}_i \sim N(\vec{0}, \boldsymbol{R}_i)\]</span></p>
<ul>
<li><p><span class="math inline">\(\boldsymbol{R}_i\)</span> is the covariance matrix of the individual-level errors: <span class="math inline">\(Cov[\epsilon_{ij}, \epsilon_{ik}] = \boldsymbol{R}_i\)</span></p></li>
<li>
<p>Also assume <span class="math inline">\(b_{0i}\)</span> and <span class="math inline">\(\vec{\epsilon}_i\)</span> are <em>independent</em> (<span class="math inline">\(b_{0i}\perp \vec{\epsilon}_i\)</span>)</p>
<ul>
<li>What happens when this is violated? Stay tuned for later this semester <span class="emoji" data-emoji="grinning">😀</span>
</li>
</ul>
</li>
</ul></section><section id="the-linear-mixed-effects-model-cont.-1" class="slide level2"><h2>The linear mixed effects model (cont.)</h2>
<p>What’s “mixed” about this model?</p>
<p><span class="math display">\[\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<ul>
<li>Named because it uses <span class="alert">fixed effects</span> (effects for covariates <span class="math inline">\(\vec{\beta}\)</span>) as well as <span class="alert">random effects</span> (cluster-specific intercepts <span class="math inline">\(b_{0i}\)</span>)</li>
</ul>
<div class="fragment">
<p>How is this different from adding groups as covariates?</p>
<ul>
<li><p>Allows groups with fewer observations to be more influenced by the rest of the data, and groups with more observations to be less</p></li>
<li><p>“… we can learn about one cluster’s coefficients by understanding the variability in coefficients across the population. <span class="alert">When there is little variability, we should rely on the population average coefficients to estimate those for a cluster When there’s substantial variation, we must rely more heavily on the data from each cluster in estimating its own coefficients</span>.” (Analysis of Longitudinal Data, pg. 173)</p></li>
</ul>
<!-- What's "conditional" about this model? --><!-- - Because the mean of the outcome variable is [conditional]{.alert} on both the fixed effects (always true in regressions) *and* the random effects: --><!-- $$E[\vec{Y}_i|\boldsymbol{X}_i,\vec{b}_{0i}] = \boldsymbol{X}_i\vec{\beta}$$ -->
</div>
</section><section id="breaking-down-systematic-variation" class="slide level2"><h2>Breaking down systematic variation</h2>
<p>Random effects: <span class="math display">\[b_{0i} \sim N(0, \sigma^2_b)\]</span></p>
<ul>
<li><p>Assumes that <span class="alert">clusters</span> are <em>randomly</em> varying around the population mean response: <span class="math inline">\(E[b_{0i}]=0\)</span></p></li>
<li><p>The typical cluster-to-cluster deviation in the overall level of the response is <span class="math inline">\(\sqrt{\sigma^2_b}\)</span></p></li>
</ul>
<div class="fragment">
<p>Within-cluster variation: <span class="math display">\[\vec{\epsilon}_i \sim N(0, \boldsymbol{R}_i)\]</span></p>
<ul>
<li>Assumes that <span class="alert">cluster members</span> are <em>randomly</em> varying around the cluster-specific mean response: <span class="math inline">\(E[\vec{\epsilon}_i]=0\)</span>
</li>
<li>For now, assume <span class="math inline">\(\boldsymbol{R}_i = \sigma^2_\epsilon \boldsymbol{I}\)</span>
<ul>
<li>Assumes all observations in cluster <span class="math inline">\(i\)</span> are <em>conditionally independent</em> given <span class="math inline">\(b_{0i}\)</span>
<ul>
<li>Given cluster membership, all members of cluster are independent</li>
</ul>
</li>
<li>Also known as an <span class="alert">independence model</span> of within-cluster variation</li>
</ul>
</li>
<li>The typical member-to-member deviation in the cluster-specific level of the response is <span class="math inline">\(\sqrt{\sigma^2_\epsilon}\)</span>
</li>
</ul>
</div>
</section><section id="variancecovariance-of-the-outcome" class="slide level2"><h2>Variance/covariance of the outcome</h2>
<p><span class="math display">\[\vec{Y}_i = \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\vec{\epsilon}_i\]</span></p>
<p>Then the variance of a single outcome measure is: <span class="math display">\[\begin{align*}Var[Y_{ij}] &amp;= Var[\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\epsilon_{ij}]\\
&amp;= Var[\vec{Z}_ib_{0i}+\epsilon_{ij}]\\
&amp;= \sigma^2_b + \sigma^2_{\epsilon}\end{align*}\]</span></p>
<div class="fragment">
<p>And the covariance between 2 outcome measures in the same cluster is: <span class="math display">\[\begin{align*}Cov[Y_{ij}, Y_{ik}] &amp;= Cov[\boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\epsilon_{ij}, \boldsymbol{X}_i\vec{\beta} + \vec{Z}_ib_{0i}+\epsilon_{ik}]\\
&amp;= Cov[\vec{Z}_ib_{0i}+\epsilon_{ij}, \vec{Z}_ib_{0i}+\epsilon_{ik}]\\
&amp;= Cov[\vec{Z}_ib_{0i}, \vec{Z}_ib_{0i}] + Cov[\epsilon_{ij}, \vec{Z}_ib_{0i}] + Cov[\vec{Z}_ib_{0i}, \epsilon_{ik}] + Cov[\epsilon_{ij}, \epsilon_{ik}]\\
&amp;= \sigma^2_b + 0 + 0 + 0\\
&amp;= \sigma^2_b\end{align*}\]</span></p>
</div>
<div class="fragment">
<p><span class="alert">In 552, we were used to seeing <span class="math inline">\(Cov[Y_{ij}, Y_{ik}]=0\)</span>!</span></p>
</div>
</section><section id="what-does-this-covariance-matrix-look-like" class="slide level2"><h2>What does this covariance matrix look like?</h2>
<p><span class="math display">\[\begin{align*}Cov[\vec{Y}_i] &amp;= \vec{Z}_i\sigma^2_b\boldsymbol{1}\vec{Z}_i^T + \boldsymbol{R}_i\\
&amp;= [\text{cluster-to-cluster variation}] + [\text{within-cluster member-to-member variation}]\\
&amp;=\begin{bmatrix}
\sigma^2_b &amp; \sigma^2_b &amp; \dots &amp; \sigma^2_b\\
\sigma^2_b &amp; \ddots &amp; \dots &amp; \sigma^2_b\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2_b &amp; \dots &amp; \sigma^2_b &amp; \sigma^2_b
\end{bmatrix} + \begin{bmatrix}
\sigma^2_\epsilon &amp; 0 &amp; \dots &amp; 0\\
0 &amp; \ddots &amp; \dots &amp; 0\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
0&amp; \dots &amp; 0 &amp; \sigma^2_\epsilon
\end{bmatrix}\\
&amp;=\begin{bmatrix}
\sigma^2_b + \sigma^2_\epsilon &amp; \sigma^2_b &amp; \dots &amp; \sigma^2_b\\
\sigma^2_b &amp; \ddots &amp; \dots &amp; \sigma^2_b\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\sigma^2_b &amp; \dots &amp; \sigma^2_b &amp; \sigma^2_b + \sigma^2_\epsilon
\end{bmatrix}\end{align*}\]</span></p>
<ul>
<li>Known as a <span class="alert">block exchangeable</span> matrix or <span class="alert">compound symmetry</span>
</li>
</ul></section><section id="inference-for-widehatbeta" class="slide level2"><h2>Inference for <span class="math inline">\(\widehat{\beta}\)</span>
</h2>
<p>Estimation of <span class="math inline">\(\beta\)</span> is done by (restricted) maximum likelihood estimation – the formula looks a lot like it did for weighted least squares (WLS)</p>
<p><span class="math display">\[\widehat{\beta} = \left(\sum_{i=1}^n \boldsymbol{X}^T \left\{Cov[\vec{Y}_i]\right\}^{-1}\boldsymbol{X}_i\right)^{-1}\sum_{i=1}^n \boldsymbol{X}^T \left\{Cov[\vec{Y}_i]\right\}^{-1}\vec{Y}_i\]</span></p>
<div class="r-stack">
<div class="fragment fade-in-then-out">
<ul>
<li><p>In OLS and WLS, we used <span class="alert">maximum likelihood</span> to estimate <span class="math inline">\(\beta\)</span>’s and variance components</p></li>
<li><p>In LMEs, we use <span class="alert">restricted maximum likelihood (REML)</span> estimation because MLE gives us biased estimates of the covariance components in small samples</p></li>
<li>
<p>This means that we <span class="alert">cannot</span> perform likelihood ratio test-based inference for <span class="math inline">\(\vec{\beta}\)</span> when using REML!</p>
<ul>
<li>Wald-based inference (z/t-tests and confidence intervals) are still fine, though</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<p>The “model-based” covariance matrix for <span class="math inline">\(\widehat{\beta}\)</span> is <span class="math display">\[Cov[\widehat{\beta}]=\left(\sum_{i=1}^n \boldsymbol{X}_i^T\left\{Cov[\vec{Y}_i]\right\}^{-1}\boldsymbol{X}_i^T\right)^{-1}\]</span></p>
</div>
</div>
<div class="fragment">
<p>The confidence intervals for <span class="math inline">\(\vec{\beta}\)</span> will take the form:</p>
<p><span class="math display">\[\widehat{\beta} \pm t_{\alpha/2; DoF=n-1} \text{diag}\left(\sum_{i=1}^n \boldsymbol{X}_i^T\left\{Cov[\vec{Y}_i]\right\}^{-1}\boldsymbol{X}_i^T\right)^{-1}\]</span></p>
</div>
</section><section id="robust-inference-for-widehatbeta" class="slide level2"><h2>Robust inference for <span class="math inline">\(\widehat{\beta}\)</span>
</h2>
<p>We can also use <span class="alert">robust or sandwich variance</span> estimators to perform inference on <span class="math inline">\(\widehat{\beta}\)</span></p>
<p><span class="math display">\[Cov^*[\widehat{\beta}] = B^{-1} A B^{-1}\]</span></p>
<p>where <span class="math display">\[\begin{align*}&amp;B^{-1} = Cov[\widehat{\beta}] = \left[\sum_{i=1}^n \boldsymbol{X}_i^T \left\{Cov[\vec{Y}_i]\right\}^{-1} \boldsymbol{X}_i\right]^{-1}\\
&amp;A = \left[\sum_{i=1}^n \boldsymbol{X}_i^T \left\{Cov[\vec{Y}_i]\right\}^{-1} (Y_i - \hat{\mu}_i)(Y_i - \hat{\mu}_i)^T \left\{Cov[\vec{Y}_i]\right\}^{-1} \boldsymbol{X}_i\right]\end{align*}\]</span></p>
<div class="r-stack">
<div class="fragment fade-in-then-out">
<p>This will give us (approximately) correct variance estimates for <span class="math inline">\(\widehat{\beta}\)</span> if we’re <span class="alert">wrong</span> about the random effects or the variance of <span class="math inline">\(Y\)</span></p>
</div>
<div class="fragment">
<p>If our random intercepts <span class="alert">correctly</span> model the covariance between observations, <span class="math inline">\(A \approx B\)</span> and: <span class="math display">\[\begin{align*}Cov^*[\widehat{\beta}] &amp;= B^{-1} A B^{-1}\\
&amp;\approx B^{-1} B B^{-1}\\
&amp; = B^{-1} = Cov[\widehat{\beta}]\end{align*}\]</span> the robust variance is the same as the model-based variance!</p>
</div>
<div class="fragment">
<p><img data-src="clustering-SE-meme.png" class="absolute" style="top: 150px; right: 100px; width: 20%; "></p>
</div>
</div>
</section><section id="icc-in-lmes" class="slide level2"><h2>ICC in LMEs</h2>
<p>It is also very intuitive to calculate the ICC from an LME: <span class="math display">\[\begin{align*}\text{ICC} &amp;= \frac{\text{variation in cluster means}}{\text{variation in cluster means } + \text{individual-level variation}}\\
&amp;= \frac{\sigma^2_b}{\sigma^2_b + \sigma^2_{\epsilon}}\end{align*}\]</span></p>
<!-- --- -->
<!-- ## Distributional assumptions -->
<!-- LMEs assume that the outcome follows a [multivariate normal]{.alert} distribution -->
</section><section id="example-radon-measurements-in-minnesota" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s fit an LME model for our Minnesota log-radon measurements: <span class="math display">\[Y_{ij} = \beta_0 + \beta_1 (\text{floor}_{ij}) + b_{0i} + \epsilon_{ij}\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_{ij}\)</span> is the log radon for house <span class="math inline">\(j\)</span> in county <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\text{floor}_{ij}\)</span> is whether the lowest floor of house <span class="math inline">\(j\)</span> in county <span class="math inline">\(i\)</span> was the basement (0) or the ground floor (1)</p></li>
<li><p><span class="math inline">\(b_{0i}\)</span> is the county-level random intercept</p></li>
</ul></section><section id="example-radon-measurements-in-minnesota-1" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s fit an LME model for our Minnesota log-radon measurements:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># run an LME with random intercepts for county #</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>radon_lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>(log_radon <span class="sc">~</span> floor <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> county), <span class="at">data=</span>radon.mn)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">summary</span>(radon_lme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: log_radon ~ floor + (1 | county)
   Data: radon.mn

REML criterion at convergence: 2097.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3597 -0.6253 -0.0016  0.6389  3.4965 

Random effects:
 Groups   Name        Variance Std.Dev.
 county   (Intercept) 0.09948  0.3154  
 Residual             0.52676  0.7258  
Number of obs: 919, groups:  county, 85

Fixed effects:
            Estimate Std. Error t value
(Intercept)  1.49239    0.04955  30.117
floor       -0.66289    0.06765  -9.798

Correlation of Fixed Effects:
      (Intr)
floor -0.288</code></pre>
</div>
</div>
<ul>
<li>
<p>LME <span class="math inline">\(\beta_1\)</span>: -0.6629</p>
<ul>
<li><p>Model-based 95% CI: (-0.7194, -0.6064)</p></li>
<li><p>How would we interpret this?</p></li>
</ul>
</li>
</ul></section><section id="example-radon-measurements-in-minnesota-2" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s compare the model-based confidence intervals</p>
<ul>
<li>Model-based 95% CI: (-0.7194, -0.6064)</li>
</ul>
<p>to the robust CIs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(clubSandwich)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># get the sandwich-based covariance matrix #</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>var_sand <span class="ot">&lt;-</span> <span class="fu">vcovCR</span>(radon_lme, <span class="at">type=</span><span class="st">"CR0"</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="fu">paste0</span>( <span class="st">"("</span>,<span class="fu">round</span>(<span class="fu">summary</span>(radon_lme)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sqrt</span>(var_sand[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">*</span><span class="fu">pnorm</span>(<span class="fl">0.975</span>), <span class="dv">4</span>), <span class="st">", "</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>        , <span class="fu">round</span>(<span class="fu">summary</span>(radon_lme)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">sqrt</span>(var_sand[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">*</span><span class="fu">pnorm</span>(<span class="fl">0.975</span>), <span class="dv">4</span>),<span class="st">")"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(-0.7267, -0.5991)"</code></pre>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<p>Model-based SEs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">summary</span>(radon_lme)<span class="sc">$</span>coef[,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       floor 
 0.04955304  0.06765334 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Robust SEs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(var_sand))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       floor 
 0.05106402  0.07640840 </code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><img data-src="clustering-SE-meme.png" class="absolute" style="bottom: -150px; right: 800px; width: 20%; "></p>
</div>
</div>
</section><section id="example-radon-measurements-in-minnesota-3" class="slide level2"><h2>Example: radon measurements in Minnesota</h2>
<p>Let’s compare the LME results to adding county as a regression coefficient</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>radon_cty_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_radon <span class="sc">~</span> floor <span class="sc">+</span> <span class="fu">factor</span>(county) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data=</span>radon.mn)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">summary</span>(radon_cty_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_radon ~ floor + factor(county) - 1, data = radon.mn)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1794 -0.4449 -0.0065  0.4406  2.6083 

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
floor                           -0.68923    0.07062  -9.760  &lt; 2e-16 ***
factor(county)AITKIN             0.88724    0.36370   2.439 0.014915 *  
factor(county)ANOKA              0.93061    0.10084   9.229  &lt; 2e-16 ***
factor(county)BECKER             1.54949    0.42210   3.671 0.000257 ***
factor(county)BELTRAMI           1.58715    0.27756   5.718 1.50e-08 ***
factor(county)BENTON             1.45454    0.36370   3.999 6.92e-05 ***
factor(county)BIG STONE          1.53679    0.41947   3.664 0.000264 ***
factor(county)BLUE EARTH         2.02488    0.19444  10.414  &lt; 2e-16 ***
factor(county)BROWN              1.99607    0.36498   5.469 5.99e-08 ***
factor(county)CARLTON            1.04568    0.22986   4.549 6.19e-06 ***
factor(county)CARVER             1.56601    0.29870   5.243 2.01e-07 ***
factor(county)CASS               1.42809    0.32492   4.395 1.25e-05 ***
factor(county)CHIPPEWA           1.75585    0.36327   4.833 1.60e-06 ***
factor(county)CHISAGO            1.08472    0.29661   3.657 0.000271 ***
factor(county)CLAY               2.00594    0.19522  10.275  &lt; 2e-16 ***
factor(county)CLEARWATER         1.36830    0.36498   3.749 0.000190 ***
factor(county)COOK               0.71754    0.51374   1.397 0.162876    
factor(county)COTTONWOOD         1.26701    0.36711   3.451 0.000586 ***
factor(county)CROW WING          1.16000    0.21048   5.511 4.75e-08 ***
factor(county)DAKOTA             1.37202    0.09165  14.971  &lt; 2e-16 ***
factor(county)DODGE              1.81683    0.41947   4.331 1.66e-05 ***
factor(county)DOUGLAS            1.75056    0.24231   7.225 1.14e-12 ***
factor(county)FARIBAULT          0.77847    0.29684   2.623 0.008888 ** 
factor(county)FILLMORE           1.41933    0.51495   2.756 0.005975 ** 
factor(county)FREEBORN           2.11291    0.24269   8.706  &lt; 2e-16 ***
factor(county)GOODHUE            1.96481    0.19444  10.105  &lt; 2e-16 ***
factor(county)HENNEPIN           1.39279    0.07129  19.538  &lt; 2e-16 ***
factor(county)HOUSTON            1.78696    0.29754   6.006 2.84e-09 ***
factor(county)HUBBARD            1.27592    0.32767   3.894 0.000107 ***
factor(county)ISANTI             1.09088    0.41947   2.601 0.009470 ** 
factor(county)ITASCA             0.96989    0.21906   4.427 1.08e-05 ***
factor(county)JACKSON            2.03650    0.32492   6.268 5.87e-10 ***
factor(county)KANABEC            1.26888    0.36327   3.493 0.000503 ***
factor(county)KANDIYOHI          2.07583    0.36327   5.714 1.53e-08 ***
factor(county)KITTSON            1.61681    0.42210   3.830 0.000138 ***
factor(county)KOOCHICHING        0.86913    0.27756   3.131 0.001801 ** 
factor(county)LAC QUI PARLE      2.95083    0.51495   5.730 1.40e-08 ***
factor(county)LAKE               0.48666    0.24231   2.008 0.044918 *  
factor(county)LAKE OF THE WOODS  1.87621    0.36498   5.141 3.42e-07 ***
factor(county)LE SUEUR           1.76353    0.32523   5.422 7.70e-08 ***
factor(county)LINCOLN            2.32194    0.36370   6.384 2.86e-10 ***
factor(county)LYON               1.97906    0.25702   7.700 3.86e-14 ***
factor(county)MAHNOMEN           1.38629    0.72654   1.908 0.056725 .  
factor(county)MARSHALL           1.63869    0.24534   6.679 4.39e-11 ***
factor(county)MARTIN             1.10682    0.27479   4.028 6.14e-05 ***
factor(county)MCLEOD             1.31964    0.20267   6.511 1.29e-10 ***
factor(county)MEEKER             1.24640    0.32492   3.836 0.000134 ***
factor(county)MILLE LACS         0.96813    0.51495   1.880 0.060452 .  
factor(county)MORRISON           1.18075    0.24231   4.873 1.32e-06 ***
factor(county)MOWER              1.72680    0.20180   8.557  &lt; 2e-16 ***
factor(county)MURRAY             2.50144    0.72654   3.443 0.000604 ***
factor(county)NICOLLET           2.17788    0.36327   5.995 3.03e-09 ***
factor(county)NOBLES             1.94256    0.41947   4.631 4.22e-06 ***
factor(county)NORMAN             1.28487    0.42013   3.058 0.002297 ** 
factor(county)OLMSTED            1.34113    0.15177   8.836  &lt; 2e-16 ***
factor(county)OTTER TAIL         1.63955    0.25823   6.349 3.56e-10 ***
factor(county)PENNINGTON         1.19071    0.42210   2.821 0.004903 ** 
factor(county)PINE               0.81282    0.29684   2.738 0.006309 ** 
factor(county)PIPESTONE          1.87784    0.36370   5.163 3.04e-07 ***
factor(county)POLK               1.73937    0.36498   4.766 2.22e-06 ***
factor(county)POPE               1.30687    0.51374   2.544 0.011144 *  
factor(county)RAMSEY             1.19648    0.12861   9.303  &lt; 2e-16 ***
factor(county)REDWOOD            1.99809    0.32523   6.144 1.25e-09 ***
factor(county)RENVILLE           1.68698    0.42013   4.015 6.47e-05 ***
factor(county)RICE               1.86403    0.21915   8.506  &lt; 2e-16 ***
factor(county)ROCK               1.33535    0.51374   2.599 0.009508 ** 
factor(county)ROSEAU             1.68230    0.19832   8.483  &lt; 2e-16 ***
factor(county)SCOTT              1.82266    0.20267   8.993  &lt; 2e-16 ***
factor(county)SHERBURNE          1.12508    0.25687   4.380 1.34e-05 ***
factor(county)SIBLEY             1.27487    0.36327   3.509 0.000473 ***
factor(county)ST LOUIS           0.92306    0.06816  13.543  &lt; 2e-16 ***
factor(county)STEARNS            1.51813    0.14575  10.416  &lt; 2e-16 ***
factor(county)STEELE             1.60398    0.22975   6.981 5.97e-12 ***
factor(county)STEVENS            1.80896    0.51374   3.521 0.000453 ***
factor(county)SWIFT              1.02673    0.36327   2.826 0.004821 ** 
factor(county)TODD               1.73917    0.42013   4.140 3.83e-05 ***
factor(county)TRAVERSE           2.02026    0.36370   5.555 3.74e-08 ***
factor(county)WABASHA            1.84256    0.27479   6.705 3.71e-11 ***
factor(county)WADENA             1.32114    0.32614   4.051 5.58e-05 ***
factor(county)WASECA             0.70614    0.36370   1.942 0.052527 .  
factor(county)WASHINGTON         1.36338    0.10740  12.695  &lt; 2e-16 ***
factor(county)WATONWAN           2.70012    0.42210   6.397 2.64e-10 ***
factor(county)WILKIN             2.24071    0.72654   3.084 0.002109 ** 
factor(county)WINONA             1.65628    0.20216   8.193 9.58e-16 ***
factor(county)WRIGHT             1.66647    0.20158   8.267 5.40e-16 ***
factor(county)YELLOW MEDICINE    1.21681    0.51374   2.369 0.018087 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7265 on 833 degrees of freedom
Multiple R-squared:  0.7892,    Adjusted R-squared:  0.7675 
F-statistic: 36.27 on 86 and 833 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>
<p>OLS <span class="math inline">\(\beta_1\)</span>: -0.6892</p>
<ul>
<li>95% CI: (-0.7482, -0.6302)</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<p>What differences can you see compared to the previous LME?</p>
<ul>
<li>
<p>LME <span class="math inline">\(\beta_1\)</span>: -0.6629</p>
<ul>
<li><p>Model-based 95% CI: (-0.7194, -0.6064)</p></li>
<li><p>Robust 95% CI: (-0.7267, -0.5991)</p></li>
</ul>
</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-2_files/figure-revealjs/radon%20CI%20plot-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="marginal-effects-in-lmes" class="slide level2"><h2>Marginal effects in LMEs</h2>
<p>The default interpretation of LMEs is <span class="alert">conditional</span>… but we can sometimes extract <span class="alert">marginal</span> effects out of them</p>
<div class="fragment">
<ul>
<li>For continuous outcomes (like we’ve been talking about), or outcomes that we <strong>do not</strong> transform, <span class="alert">the conditional and marginal effects will be identical</span>
</li>
</ul>
<p><span class="math display">\[\begin{align*}E[\vec{Y}_i] &amp;= E\left\{E[\vec{Y}_i|\boldsymbol{X}_i, b_{0i}]\right\}\\
&amp;=E[\boldsymbol{X}_i\vec{\beta} + \vec{Z}_i b_{0i}]\\
&amp;=\boldsymbol{X}_i\vec{\beta} + \vec{Z}_i E[b_{0i}]\\
&amp;=\boldsymbol{X}_i\vec{\beta}\end{align*}\]</span></p>
</div>
<div class="fragment">
<ul>
<li>For non-continuous outcomes or outcomes we do need to transform, the above will not hold and the marginal and conditional effects with be different… more on this next week</li>
</ul>
</div>
</section><section id="a-note-on-terminology" class="slide level2"><h2>A note on terminology</h2>
<p>Throughout this lecture we’ve referred to <span class="math inline">\(\vec{\beta}\)</span> as “fixed effects” and <span class="math inline">\(b_{0i}\)</span> as “random effects”</p>
<ul>
<li>This is standard terminology within statistics</li>
</ul>
<div class="fragment">
<p>In parts of the social sciences (*cough* economics *cough*), “fixed effects” refer to adjusting for cluster membership as covariates (think back to the last lecture)</p>
<ul>
<li><p>These types of models are referred to in econ as “fixed effect models”</p></li>
<li><p>This is done to adjust for the (potentially) confounding effect of cluster membership, not so much to deal with correlated data</p></li>
</ul>
</div>
<div class="fragment">
<p>This terminology has lead to many an argument between researchers until everyone realizes there was a miscommunication</p>
<ul>
<li>Just an FYI in case you’re ever reading about random/fixed effects online</li>
</ul>
<p><img src="POPUHEALSMPH_color-flush.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="slides-2_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="slides-2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="slides-2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="slides-2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="slides-2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="slides-2_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="slides-2_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="slides-2_files/libs/revealjs/plugin/notes/notes.js"></script><script src="slides-2_files/libs/revealjs/plugin/search/search.js"></script><script src="slides-2_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="slides-2_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>