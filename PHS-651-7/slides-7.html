<!DOCTYPE html>
<html lang="en"><head>
<script src="slides-7_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides-7_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides-7_files/libs/quarto-html/popper.min.js"></script>
<script src="slides-7_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides-7_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides-7_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides-7_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="slides-7_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<title>slides-7</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="slides-7_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="slides-7_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
<link rel="stylesheet" href="slides-7_files/libs/revealjs/dist/theme/quarto.css">
<link href="slides-7_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="slides-7_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="slides-7_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="slides-7_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="slides-7_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="slides-7_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2"><h1>
Lecture 7: Modeling the mean and covariance with longitudinal data
</h1>
<h2>
PHS 651: Advanced regression methods
</h2>
<hr>
<h3>
Mary Ryan Baumann, PhD
</h3>
<h3>
October 22 &amp; 24, 2024
</h3>
<p><br></p>
<div style="font-size: 75%;">
<p><strong>Recording disclosure</strong></p>
<p><em>This class is being conducted in person, as well as over <span class="alert">Zoom</span>. As the instructor, I will be <span class="alert">recording</span> this session. I have disabled the recording feature for others so that no one else will be able to record this session. I will be posting this session to the course’s website.</em></p>
<p><em>If you have privacy concerns and do not wish to appear in the recording, you may turn video off (click “stop video”) so that Zoom does not record you.</em></p>
<p><em>The chat box is always open for discussion and questions to the entire class. You may also send messages privately to the instructor. Please note that Zoom saves all chat transcripts.</em></p>
</div>
<div class="absolute" style="left: 260px; bottom: 50px; width: 1500px; ">
<p>Slides found at: <a href="https://maryryan.github.io/PHS-651-slides/PHS-651-7/slides-7" class="uri">https://maryryan.github.io/PHS-651-slides/PHS-651-7/slides-7</a></p>
</div>
<div class="absolute" style="left: 100px; bottom: 0px; width: 150px; ">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="slides-7_files/figure-revealjs/qr%20code-1.png" width="192"></p>
</div>
</div>
</div>
</section><section id="recall-longitudinal-data" class="slide level2"><h2>Recall: longitudinal data</h2>
<p><span class="alert">Longitudinal data</span> occur when a research participant is observed repeatedly through time</p>
<ul>
<li>Primary goal of longitudinal data collection is to characterize <span class="alert">change in response over time</span> and how factors/exposures impact that change</li>
</ul>
<p>What’s wrong with a cross-sectional study?</p>
<ul>
<li><p>Just asking a different kind of question!</p></li>
<li><p>Only observe how exposure impacts outcome at a particular moment</p></li>
<li>
<p>No understanding of whether outcome changed while exposure was applied or whether it was always low/high</p>
<ul>
<li>Correlation vs causation</li>
</ul>
</li>
<li><p>Can maybe get at between-subject differences, but not within-subject change</p></li>
</ul></section><section id="modeling-the-mean-with-repeated-measures" class="slide level2"><h2>Modeling the mean with repeated measures</h2>
<p>When dealing with non-longitudinal data, we (usually) have one primary type of research question for our models: <em>“How does the outcome differ in exposure and non-exposure groups?”</em></p>
<ul>
<li>With longitudinal data, we may also be interested in a research question like this</li>
</ul>
<div class="fragment">
<p>However, we need to be more specific about <span class="alert">how we’re comparing the outcome in the exposure groups</span></p>
<ul>
<li><p>Differences in outcome at last measurement time?</p></li>
<li><p>Differences in the outcome change from baseline?</p></li>
<li><p>Differences in outcome trend over time?</p></li>
</ul>
</div>
<div class="fragment">
<p>Understanding how we want to compare outcomes between the exposure groups will help us understand what our reference groups are</p>
</div>
</section><section class="slide level2"><h3 id="longitudinal-hypotheses">Longitudinal hypotheses</h3>
<p><img data-src="long-hypotheses.png" style="width:45.0%"></p>
<div class="absolute" style="top: 200px; right: 100px; width: 35%; ">
<p>With longitudinal data, we are usually interested one of several types of hypotheses:</p>
<ol type="1">
<li><p>Presence/absence of time effect</p></li>
<li><p>Presence/absence of group/exposure effect</p></li>
<li><p>Presence/absence of exposure group-by-time interaction effect</p></li>
</ol>
<p><span class="alert">How do each of these 3 hypotheses match up to the 3 plots?</span></p>
<p><span class="fragment">How do create a mean model each of these hypotheses?</span></p>
</div>
</section><section id="hypothesis-1-time-effect" class="slide level2"><h2>Hypothesis 1: Time effect</h2>
<p>Longitudinal data repeatedly observes the outcome in an individual</p>
<ul>
<li><p>Along with the outcome measurements, we also observe the timing of these measurements</p></li>
<li><p>Timing can be measured categorically (e.g., “visit 1, visit 2…”) or numerically (e.g., number of days since study entry)</p></li>
</ul>
<div class="fragment">
<p>One of the most basic ways we might analyze longitudinal data is to try to model how the outcome changes over time across the entire study population (not looking at exposure groups)</p>
<p><span class="alert">How might we model this?</span></p>
</div>
</section><section id="hypothesis-1-categorical-time" class="slide level2"><h2>Hypothesis 1: Categorical time</h2>
<p>One of the most basic ways we might analyze longitudinal data is to try to model how the outcome changes over time across the entire study population (not looking at exposure groups)</p>
<p>Say we observe the outcome in an individual <em>i</em> across <em>J</em> measurement occasions: <span class="math inline">\(Y_{ij}\)</span></p>
<p>One representation:</p>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 I(\text{Baseline}_i) + \beta_1 I(\text{Visit 1}_i) + \beta_2 I(\text{Visit 2}_i) + \dots \beta_J I(\text{Visit J}_i),\]</span></p>
<p>where <span class="math inline">\(I(\cdot)\)</span> is an indicator function/dummy variable</p>
<div class="fragment">
<ul>
<li>
<p>Each <span class="math inline">\(\beta\)</span> represents the average outcome at a particular categorical time point</p>
<ul>
<li>If <span class="math inline">\(\beta_0 = \beta_1 = \dots = \beta_J\)</span>, the outcome is not changing across time</li>
</ul>
</li>
</ul>
</div>
</section><section id="hypothesis-1-categorical-time-1" class="slide level2"><h2>Hypothesis 1: Categorical time</h2>
<p>Say we observe the outcome in an individual <em>i</em> across <em>J</em> measurement occasions: <span class="math inline">\(Y_{ij}\)</span></p>
<p>An alternative representation:</p>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 I(\text{Visit 1}_i) + \beta_2 I(\text{Visit 2}_i) + \dots \beta_J I(\text{Visit J}_i)\]</span></p>
<div class="fragment">
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> represents the average outcome at baseline</p></li>
<li>
<p>All other regression coefficients represent the <span class="alert">difference</span> in average outcomes between a particular categorical time point and baseline</p>
<ul>
<li>If <span class="math inline">\(\beta_1 = \dots = \beta_J = 0\)</span>, the outcome is not changing across time</li>
</ul>
</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<p>Neither representation makes an assumption about how outcomes change (or don’t) from time point to time point</p>
<ul>
<li>Could increase, then decrease, then increase slightly, then increase even more, etc</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>Both representations assume that “visits” are happening at the same time for everyone (or are at least at comparable times)</p>
<ul>
<li><p>No sense of “distance” between visits</p></li>
<li><p>What if this is not true?</p></li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="hypothesis-1-numerical-time" class="slide level2"><h2>Hypothesis 1: Numerical time</h2>
<p>Say we observe the outcome in an individual <em>i</em> across <em>J</em> measurement occasions: <span class="math inline">\(Y_{ij}\)</span></p>
<p>If we let <span class="math inline">\(\text{Time}_{ij}\)</span> represent the exact time since study entry that participant <em>i</em> is observed for visit <em>j</em>, we could model as:</p>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 (\text{Time}_{ij})\]</span></p>
<div class="fragment">
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> represents the average outcome at baseline (0 time since study entry)</p></li>
<li>
<p><span class="math inline">\(\beta_1\)</span> represents average difference in outcomes comparing measurements <span class="alert">1 time unit apart</span></p>
<ul>
<li><p>If <span class="math inline">\(\beta_1 = 0\)</span>, the outcome is not changing across time</p></li>
<li><p>Like a weighted average of the categorical time effects we saw before</p></li>
</ul>
</li>
</ul>
</div>
</section><section id="hypothesis-1-numerical-time-1" class="slide level2"><h2>Hypothesis 1: Numerical time</h2>
<p>If we let <span class="math inline">\(\text{Time}_{ij}\)</span> represent the exact time since study entry that participant <em>i</em> is observed for visit <em>j</em>, could model as:</p>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 (\text{Time}_{ij})\]</span></p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> represents the average outcome at baseline (0 time since study entry)</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> represents average difference in outcomes comparing measurements 1 time unit apart</p></li>
</ul>
<div class="columns">
<div class="column" style="width:60%;">
<p>This makes strong assumption that the outcome is <span class="alert">linearly</span> associated with time</p>
<ul>
<li>Will see same change in outcome whether we’re comparing outcomes at Baseline vs week 1 or at week 10 vs week 11</li>
</ul>
<div class="fragment">
<ul>
<li>
<p>Could alter this assumption by adding polynomial time effects:</p>
<ul>
<li>e.g., Quadratic time effect: <span class="math inline">\(E[Y_{ij}] = \beta_0 + \beta_1 (\text{Time}_{ij}) + \beta_2 (\text{Time}_{ij})^2\)</span>
</li>
</ul>
</li>
</ul>
</div>
</div><div class="column" style="width:40%;">
<div class="fragment">
<p>Makes no assumption about timing of observations across participants/clusters</p>
<ul>
<li>“Smooths out” timing irregularities</li>
</ul>
</div>
</div>
</div>
</section><section id="hypothesis-2-groupexposure-effect" class="slide level2"><h2>Hypothesis 2: Group/exposure effect</h2>
<p>Now we might want to compare outcomes between exposure groups</p>
<ul>
<li>Let <span class="math inline">\(U_{i0}\)</span> be an exposure indicator for participant <em>i</em>, collected at baseline</li>
</ul>
<p><span class="alert">How might we model this?</span></p>
</section><section id="hypothesis-2-groupexposure-effect-1" class="slide level2"><h2>Hypothesis 2: Group/exposure effect</h2>
<p>Now we might want to compare outcomes between exposure groups</p>
<ul>
<li>Let <span class="math inline">\(U_{i0}\)</span> be an exposure indicator for participant <em>i</em>, collected at baseline</li>
</ul>
<p>For illustration, assume we want to fit a linear effect for numerically-observed time:</p>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 (U_{i0}) + \beta_2 (\text{Time}_{ij})\]</span></p>
<div class="fragment">
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> represents the average outcome at baseline (0 time since study entry) in the unexposed group</p></li>
<li>
<p><span class="math inline">\(\beta_1\)</span> represents the average difference in outcomes between the exposed and unexposed groups, <span class="alert">conditional on measurement time</span></p>
<ul>
<li>If <span class="math inline">\(\beta_1 = 0\)</span>, there is no difference in (similarly-timed) outcomes between exposure groups</li>
</ul>
</li>
</ul>
</div>
</section><section id="hypothesis-2-groupexposure-effect-2" class="slide level2"><h2>Hypothesis 2: Group/exposure effect</h2>
<p>We could generalize this to let exposure group membership change with time: <span class="math inline">\(U_{ij}\)</span></p>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 (U_{ij}) + \beta_2 (\text{Time}_{ij})\]</span></p>
<div class="fragment">
<ul>
<li>
<p>We must be extra careful here with our interpretation of <span class="math inline">\(\beta_1\)</span></p>
<ul>
<li>
<span class="math inline">\(\beta_1\)</span> only maintains its causal interpretation if <span class="math inline">\(U_{i(j+1)}\)</span> is not predicted by <span class="math inline">\(Y_{ij}\)</span> give <span class="math inline">\(U_{ij}\)</span>; otherwise, we say that <span class="math inline">\(Y_{ij}\)</span> <span class="alert">confounds</span> the relationship between <span class="math inline">\(Y_{i(j+1)}\)</span> and <span class="math inline">\(U_{i(j+1)}\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<p>Both representations assume that the effect of exposure is constant across time</p>
<ul>
<li><p>Doesn’t matter if comparing exposed/unexposed at Week 1 or Week 24</p></li>
<li><p>What if this is not true?</p></li>
</ul>
</div>
</section><section id="hypothesis-3-exposure-group-times-time-effect" class="slide level2"><h2>Hypothesis 3: Exposure group <span class="math inline">\(\times\)</span> time effect</h2>
<p>Now we might want to compare change in outcomes over time between exposure groups</p>
<ul>
<li>Let <span class="math inline">\(U_{i0}\)</span> be an exposure indicator for participant <em>i</em> collected at baseline, and assume we want to fit a linear effect for numerically-observed time:</li>
</ul>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 (U_{i0}) + \beta_2 (\text{Time}_{ij}) + \beta_3 (U_{i0} \times\text{Time}_{ij})\]</span></p>
<div class="fragment">
<p><span class="alert">What do the regression coefficients represent?</span></p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span>:</p></li>
<li><p><span class="math inline">\(\beta_1\)</span>:</p></li>
<li><p><span class="math inline">\(\beta_2\)</span>:</p></li>
<li><p><span class="math inline">\((\beta_1 + \beta_3)\)</span>:</p></li>
<li><p><span class="math inline">\((\beta_2 + \beta_3)\)</span>:</p></li>
<li><p><span class="math inline">\(\beta_3\)</span>:</p></li>
</ul>
</div>
</section><section id="hypothesis-3-exposure-group-times-time-effect-1" class="slide level2"><h2>Hypothesis 3: Exposure group <span class="math inline">\(\times\)</span> time effect</h2>
<p>Now we might want to compare change in outcomes over time between exposure groups</p>
<ul>
<li>Let <span class="math inline">\(U_{i0}\)</span> be an exposure indicator for participant <em>i</em> collected at baseline, and assume we want to fit a linear effect for numerically-observed time:</li>
</ul>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 (U_{i0}) + \beta_2 (\text{Time}_{ij}) + \beta_3 (U_{i0} \times\text{Time}_{ij})\]</span></p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span>: average outcome at baseline (0 time since study entry) in the unexposed group</p></li>
<li><p><span class="math inline">\(\beta_1\)</span>: average difference in outcomes between the exposed and unexposed groups <span class="alert">at baseline</span></p></li>
<li><p><span class="math inline">\(\beta_2\)</span>: average difference in outcomes comparing unexposed measurements 1 time unit apart</p></li>
<li><p><span class="math inline">\((\beta_1 + \beta_3)\)</span>: difference in outcomes between exposed and unexposed groups <span class="alert">at the same measurement time</span></p></li>
<li><p><span class="math inline">\((\beta_2 + \beta_3)\)</span>: average difference in outcomes comparing exposed measurements 1 time unit apart</p></li>
<li><p><span class="math inline">\(\beta_3\)</span>: whether exposure effect changes with time</p></li>
</ul></section><section id="hypothesis-3-exposure-group-times-time-effect-2" class="slide level2"><h2>Hypothesis 3: Exposure group <span class="math inline">\(\times\)</span> time effect</h2>
<p>Now we might want to compare change in outcomes over time between exposure groups</p>
<ul>
<li>Let <span class="math inline">\(U_{i0}\)</span> be an exposure indicator for participant <em>i</em> collected at baseline, and assume we want to fit a linear effect for numerically-observed time:</li>
</ul>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 (U_{i0}) + \beta_2 (\text{Time}_{ij}) + \beta_3 (U_{i0} \times\text{Time}_{ij})\]</span></p>
<p>If we were dealing with categorical time, would need to interact exposure variable with <strong>each</strong> time point indicator</p>
</section><section id="adjusting-for-baseline-outcomes" class="slide level2"><h2>Adjusting for baseline outcomes</h2>
<p>But what do we do when there are differences in outcomes between exposure groups at baseline?</p>
<div class="fragment">
<p>There are 4 main methods for handling baseline outcome measurements in longitudinal data</p>
<ol type="1">
<li>Keep <span class="math inline">\(Y_{i0}\)</span> as part of the outcome vector, and use exposure group and time (and group-by-time interaction) as adjustment variables</li>
</ol>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_1 (\text{U}_{i0}) + \beta_2(\text{Time}_{ij}) + \beta_3(\text{U}_{i0} \times \text{Time}_{ij})\]</span></p>
<ul>
<li>
<span class="math inline">\(\beta_1\)</span> interpreted as expected difference in outcome between exposure groups <span class="alert">at baseline</span>
</li>
</ul>
</div>
</section><section id="adjusting-for-baseline-outcomes-1" class="slide level2"><h2>Adjusting for baseline outcomes</h2>
<ol start="2" type="1">
<li>Keep <span class="math inline">\(Y_{i0}\)</span> as part of the outcome vector, and use time and group-by-time interaction as adjustment variables (no group variable)</li>
</ol>
<p><span class="math display">\[E[Y_{ij}] = \beta_0 + \beta_2(\text{Time}_{ij}) + \beta_3(\text{U}_{i0} \times \text{Time}_{ij})\]</span></p>
<ul>
<li><p>Assumes group means at baseline are <span class="alert">equal</span> (<span class="math inline">\(\beta_1=0\)</span>)</p></li>
<li><p>This is a <span class="alert">bad assumption</span> for observational studies, but usually fine for randomized trials</p></li>
</ul></section><section id="adjusting-for-baseline-outcomes-2" class="slide level2"><h2>Adjusting for baseline outcomes</h2>
<ol start="3" type="1">
<li>Use change from baseline <span class="math inline">\((Y_{ij} - Y_{i0})\)</span> as outcome, and use exposure and time (and group-by-time interaction) as adjustment variables</li>
</ol>
<p><span class="math display">\[E[Y_{ij} - Y_{i0}] = \beta_0 + \beta_1 (\text{U}_{i0}) + \beta_2(\text{Time}_{ij}) + \beta_3(\text{U}_{i0} \times \text{Time}_{ij})\]</span></p>
<ul>
<li><p><span class="math inline">\((\beta_1 + \beta_3)\)</span> interpreted as expected difference in the change-from-baseline outcomes between exposure groups <span class="alert">at same follow-up time</span> (conditional on follow-up time)</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> only meaningful if choose another reference time besides baseline (because change from baseline at time 0 is 0 for everyone)</p></li>
</ul></section><section id="adjusting-for-baseline-outcomes-3" class="slide level2"><h2>Adjusting for baseline outcomes</h2>
<ol start="4" type="1">
<li>Use follow-up measurements <em>only</em> as outcome vector, and use <span class="math inline">\(Y_{i0}\)</span> as adjustment variable, along with exposure and time (and group-by-time interaction)</li>
</ol>
<p><span class="math display">\[E[Y^*_{ij}] = \beta_0 + \beta_{\text{baseline}}(Y_{i0}) + \beta_1 (\text{U}_{i0}) + \beta_2(\text{Time}_{ij}) + \beta_3(\text{U}_{i0} \times \text{Time}_{ij})\]</span></p>
<ul>
<li><p><span class="math inline">\((\beta_1 + \beta_3)\)</span> interpreted as expected difference in outcome between exposure groups at same follow-up time, <span class="alert">who had the same baseline outcomes</span></p></li>
<li><p><span class="math inline">\(\beta_0\)</span> only meaningful if choose another reference time besides baseline</p></li>
<li><p>Assumes group means at baseline are equal (no baseline-by-group effect) <span class="math inline">\(\rightarrow\)</span> <span class="alert">bad assumption</span> for observational studies</p></li>
</ul></section><section id="longitudinal-covariancecorrelation-structures" class="slide level2"><h2>Longitudinal covariance/correlation structures</h2>
<p>Now that we have time handled in the mean model, we can think about how longitudinal data affects covariance/correlation structures</p>
<p>Previously we touched on some basic correlation structures for clustered, non-longitudinal data</p>
<ul>
<li>Remember: independence, exchangeable, unstructured from Lectures 4 and 5.1</li>
</ul>
<div class="fragment">
<p>With longitudinal data, there are a much wider range of potential structures</p>
<ul>
<li>We’ll explore some of those today</li>
</ul>
</div>
</section><section id="longitudinal-covariancecorrelation-structures-1" class="slide level2"><h2>Longitudinal covariance/correlation structures</h2>
<p>As an illustration, we’ll use data are from a study of dental growth measurements</p>
<ul>
<li>Distance (mm) from the center of the pituitary gland to the pteryomaxillary fissure were obtained on 11 girls and 16 boys at ages 8, 10, 12, and 14</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 27
Columns: 6
$ ID     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, …
$ Gender &lt;chr&gt; "F", "F", "F", "F", "F", "F", "F", "F", "F", "F", "F", "M", "M"…
$ age8   &lt;dbl&gt; 21.0, 21.0, 20.5, 23.5, 21.5, 20.0, 21.5, 23.0, 20.0, 16.5, 24.…
$ age10  &lt;dbl&gt; 20.0, 21.5, 24.0, 24.5, 23.0, 21.0, 22.5, 23.0, 21.0, 19.0, 25.…
$ age12  &lt;dbl&gt; 21.5, 24.0, 24.5, 25.0, 22.5, 21.0, 23.0, 23.5, 22.0, 19.0, 28.…
$ age14  &lt;dbl&gt; 23.0, 25.5, 26.0, 26.5, 23.5, 22.5, 25.0, 24.0, 21.5, 19.5, 28.…</code></pre>
</div>
</div>
</section><section id="unstructured-covariancecorrelation" class="slide level2"><h2>Unstructured covariance/correlation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Let’s look at what the “raw” covariance matrix for this data looks like:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          age8    age10    age14
age8  5.925926 3.285256 4.039886
age10 3.285256 4.653846 4.532051
age14 4.039886 4.532051 7.654558</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>and the “raw” correlation matrix:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  term   age8 age10 age14
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 age8  1     0.626 0.600
2 age10 0.626 1     0.759
3 age14 0.600 0.759 1    </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><span class="alert">What do we see?</span></p>
</div>
</section><section id="unstructured-covariancecorrelation-1" class="slide level2"><h2>Unstructured covariance/correlation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Let’s look at what the “raw” covariance matrix for this data looks like:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          age8    age10    age14
age8  5.925926 3.285256 4.039886
age10 3.285256 4.653846 4.532051
age14 4.039886 4.532051 7.654558</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>and the “raw” correlation matrix:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  term   age8 age10 age14
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 age8  1     0.626 0.600
2 age10 0.626 1     0.759
3 age14 0.600 0.759 1    </code></pre>
</div>
</div>
</div>
</div>
<p>Using an unstructured correlation/covariance structure gives us the most flexibility/robustness because we make no assumptions about what patterns we should be seeing</p>
<div class="fragment">
<p>But…</p>
<ul>
<li>
<p>only appropriate when data is <span class="alert">balanced</span></p>
<ul>
<li>How would we event create the covariance matrix if measurement times aren’t standardized?</li>
</ul>
</li>
<li><p>hard to estimate when there are lots of measurement visits/occasions</p></li>
</ul>
</div>
<div class="fragment">
<p>In these cases, it is often helpful to impose a <span class="alert">structure</span> on the covariance/correlation</p>
</div>
</section><section id="covariance-pattern-models" class="slide level2"><h2>Covariance Pattern Models</h2>
<p>When attempting to impose some structure on the covariance, a subtle balance needs to be struck</p>
<ul>
<li><p>Too little structure means too many parameters to estimate, which means imprecise point estimate (large variance)</p></li>
<li>
<p>Too much structure means more opportunity for mis-specification, which means inaccurate point estimate (large bias)</p>
<ul>
<li>Classic trade-off between bias and variance</li>
</ul>
</li>
</ul>
<p>Covariance pattern models have their basis in models for serial correlation originally developed for time series data</p>
</section><section id="exchangeable-correlationcompound-symmetry" class="slide level2"><h2>Exchangeable correlation/compound symmetry</h2>
<p><span class="alert">Compound symmetry/exchangeable correlation</span> assumes:</p>
<ul>
<li><p>Correlation is the same across all observations in the cluster</p></li>
<li><p><span class="alert">We saw this one before in lectures 2, 4, and 5.1!</span></p></li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; \alpha &amp; \dots &amp; \alpha\\
\alpha &amp; \ddots &amp; \dots &amp; \alpha\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha &amp; \dots &amp; \alpha &amp; 1
\end{bmatrix}\]</span></p>
<p>You’ll always be estimating a single correlation <span class="math inline">\(\alpha\)</span>, regardless of cluster size <span class="math inline">\(n\)</span></p>
<div class="fragment">
<p>This pattern has strong assumptions (measurements are exchangeable)</p>
<ul>
<li><span class="alert">This may not be valid with longitudinal data</span></li>
</ul>
</div>
</section><section id="toeplitz-correlation" class="slide level2"><h2>Toeplitz correlation</h2>
<p><span class="alert">Toeplitz</span> assumes:</p>
<ul>
<li>
<p>Correlation is different between each observation</p>
<ul>
<li>The correlation between two observations depends only on the <span class="alert">number of time points</span> separating them</li>
</ul>
</li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; \alpha_1 &amp; \dots &amp; \alpha_{n-1}\\
\alpha_1 &amp; \ddots &amp; \dots &amp; \alpha_{n-2}\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha_{n-1} &amp; \dots &amp; \alpha_1 &amp; 1
\end{bmatrix}\]</span></p>
<p>You’ll be estimating <span class="math inline">\((n-1)\)</span> correlation paramteres</p>
<div class="fragment">
<p><span class="alert">Only appropriate when measurements are (approximately) equally spaced!!</span></p>
</div>
</section><section id="autoregressive-correlation" class="slide level2"><h2>Autoregressive correlation</h2>
<p>An <span class="alert">autoregressive</span> structure assumes:</p>
<ul>
<li>Correlation gradually decreases as the distance between observations grows</li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; \alpha^1 &amp; \dots &amp; \alpha^{n-1}\\
\alpha^1 &amp; \ddots &amp; \dots &amp; \alpha^{n-2}\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha^{n-1} &amp; \dots &amp; \alpha^1 &amp; 1
\end{bmatrix}\]</span></p>
<p>You’ll always be estimating a single correlation <span class="math inline">\(\alpha\)</span>, regardless of <span class="math inline">\(n\)</span></p>
<div class="fragment">
<p>Means less correlation for measurements taken farther apart; but <span class="alert">only appropriate when the measurements are (approximately) equally spaced</span></p>
</div>
</section><section id="covariance-matrices" class="slide level2"><h2>Covariance matrices</h2>
<p>To get the covariance matrix under any of these patters, we multiply them by the outcome variance, <span class="math inline">\(\sigma^2\)</span>:</p>
<p><span class="math display">\[\sigma^2\begin{bmatrix}
1 &amp; \alpha &amp; \dots &amp; \alpha\\
\alpha &amp; \ddots &amp; \dots &amp; \alpha\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha &amp; \dots &amp; \alpha &amp; 1
\end{bmatrix}
~~~~~~\sigma^2 \begin{bmatrix}
1 &amp; \alpha_1 &amp; \dots &amp; \alpha_{n-1}\\
\alpha_1 &amp; \ddots &amp; \dots &amp; \alpha_{n-2}\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha_{n-1} &amp; \dots &amp; \alpha_1 &amp; 1
\end{bmatrix}
~~~~~~\sigma^2 \begin{bmatrix}
1 &amp; \alpha^1 &amp; \dots &amp; \alpha^{n-1}\\
\alpha^1 &amp; \ddots &amp; \dots &amp; \alpha^{n-2}\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha^{n-1} &amp; \dots &amp; \alpha^1 &amp; 1
\end{bmatrix}\]</span></p>
<div class="fragment">
<p>If we wanted to consider variances that vary across time, <span class="math inline">\(Var[Y_{ij}] = \sigma^2_j\)</span>, we could do that as well</p>
<ul>
<li><p>These are called <span class="alert">heterogeneous</span> covariance patterns</p></li>
<li><p>Example - heterogeneous compound symmetry covariance pattern:</p></li>
</ul>
<p><span class="math display">\[\begin{bmatrix}
\sigma^2_1 &amp; \alpha\sigma_1\sigma_2 &amp; \dots &amp; \alpha\sigma_1\sigma_n\\
\alpha\sigma_1\sigma_2 &amp; \ddots &amp; \dots &amp; \alpha\sigma_2\sigma_n\\
\vdots &amp; \dots &amp; \ddots &amp; \vdots\\
\alpha\sigma_1\sigma_n &amp; \dots &amp; \alpha\sigma_n\sigma_{n-1} &amp; \sigma^2_n
\end{bmatrix}\]</span></p>
</div>
</section><section id="unevenly-timed-observations" class="slide level2"><h2>Unevenly timed observations</h2>
<p>All the structures we’ve looked at so far have assumed that our observed times points are approximately equally spaced</p>
<ul>
<li>This is appropriate when we have a lot of control in observation timing…</li>
</ul>
<div class="fragment">
<p>… But it’s not uncommon to have observation time points that <strong>aren’t</strong> always evenly spaced!</p>
<ul>
<li>Think of a study where you start out with weekly observations, then move to monthly, then annual</li>
</ul>
</div>
<div class="fragment">
<p>How do we handle this?</p>
</div>
</section><section id="exponential-correlation" class="slide level2"><h2>Exponential correlation</h2>
<p>When measurement occasions are not equally-spaced over time, we can the autoregressive model can be generalized</p>
<ul>
<li>Let <span class="math inline">\(\{t_{i1}, t_{i2}, \dots, t_{in_i}\}\)</span> denote the observation times for the <em>i</em>th individual</li>
</ul>
<div class="fragment">
<ul>
<li>
<p>The correlations are given by: <span class="math display">\[Corr(Y_{ij}, Y_{ik}) = \alpha^{|t_{ij} - t_{ik}|}\]</span></p>
<ul>
<li>Instead of looking at the how far apart the observation numbers are (e.g., visit 1 vs visit 2), it <span class="alert">looks at the actual distance between the observation times</span>
</li>
</ul>
</li>
</ul>
<p>This structure is invariant under linear transformation of the time scale</p>
<p>Unlike the Toeplitz and autoregression structures, the exponential structure can easily handle unbalanced data because it is based on <span class="alert">time as a continuum</span></p>
</div>
</section><section id="banded-correlation" class="slide level2"><h2>Banded correlation</h2>
<p>All of the previous structures have have required us to estimate some parameter for the off-diagonal matrix elements</p>
<ul>
<li>What if we know at some point the correlation between observations will go to 0? <span class="alert fragment">Enter the banded structure!</span>
</li>
</ul>
<div class="fragment">
<p>The banded structure assumes correlation is 0 beyond some specified interval</p>
<p>It is possible to apply a banded pattern to any of the correlation pattern models considered so far</p>
</div>
<div class="fragment">
<p>A banded Toeplitz structure with a band size of 3 looks like:</p>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; \alpha_1 &amp; \alpha_2 &amp; 0 &amp; \dots &amp; 0\\
\alpha_1 &amp; 1 &amp; \alpha_1 &amp; \ddots &amp; \dots &amp; 0\\
\alpha_2 &amp; \alpha_1 &amp; 1 &amp;\ddots &amp; \dots &amp; 0\\
0 &amp; \alpha_2 &amp; \alpha_1&amp; \ddots &amp; \dots &amp; 0\\
\vdots &amp;&amp; \dots &amp;&amp; \ddots &amp; \vdots\\
0 &amp;&amp; \dots &amp;\alpha_2 &amp; \alpha_1 &amp; 1
\end{bmatrix}\]</span></p>
</div>
</section><section id="banded-correlation-1" class="slide level2"><h2>Banded correlation</h2>
<p>All of the previous structures have have required us to estimate some parameter for the off-diagonal matrix elements</p>
<ul>
<li>What if we know at some point the correlation between observations will go to 0? <span class="alert">Enter the banded structure!</span>
</li>
</ul>
<p>The banded structure assumes correlation is 0 beyond some specified interval</p>
<p>It is possible to apply a banded pattern to any of the correlation pattern models considered so far</p>
<p>A banded autoregression structure with a band size of 4 looks like: <span class="math display">\[\begin{bmatrix}
1 &amp; \alpha^1 &amp; \alpha^2 &amp; \alpha^3 &amp; 0 &amp; \dots &amp; 0\\
\alpha^1 &amp; 1 &amp; \alpha^1 &amp; \alpha^2&amp; \ddots &amp; \dots &amp; 0\\
\alpha^2 &amp; \alpha^1 &amp; 1 &amp; \alpha^1&amp;\ddots &amp; \dots &amp; 0\\
\alpha^3 &amp; \alpha^2 &amp; \alpha^1 &amp; 1&amp; \ddots &amp; \dots &amp; 0\\
\vdots &amp;&amp; \dots &amp;&amp; \ddots &amp;&amp; \vdots\\
0 &amp;&amp; \dots &amp; \alpha^3&amp;\alpha^2 &amp; \alpha^1 &amp; 1
\end{bmatrix}\]</span></p>
</section><section id="banded-correlation-2" class="slide level2"><h2>Banded correlation</h2>
<p>All of the previous structures have have required us to estimate some parameter for the off-diagonal matrix elements</p>
<ul>
<li>What if we know at some point the correlation between observations will go to 0? <span class="alert">Enter the banded structure!</span>
</li>
</ul>
<p>The banded structure assumes correlation is 0 beyond some specified interval</p>
<p>It is possible to apply a banded pattern to any of the correlation pattern models considered so far</p>
<p>A banded exponential structure with a band size of 4 looks like: <span class="math display">\[\begin{bmatrix}
1 &amp; \alpha^{|t_{i1}-t_{i2}|} &amp; \alpha^{|t_{i1}-t_{i3}|} &amp; \alpha^{|t_{i1}-t_{i4}|} &amp; 0 &amp; \dots &amp; 0\\
\alpha^{|t_{i1}-t_{i2}|} &amp; 1 &amp; \alpha^{|t_{i1}-t_{i2}|} &amp; \alpha^2&amp; \ddots &amp; \dots &amp; 0\\
\alpha^{|t_{i1}-t_{i3}|} &amp; \alpha^{|t_{i1}-t_{i2}|} &amp; 1 &amp; \alpha^{|t_{i1}-t_{i2}|} &amp;\ddots &amp; \dots &amp; 0\\
\alpha^{|t_{i1}-t_{i4}|} &amp; \alpha^{|t_{i1}-t_{i3}|} &amp; \alpha^{|t_{i1}-t_{i2}|} &amp; 1&amp; \ddots &amp; \dots &amp; 0\\
\vdots &amp;&amp; \dots &amp;&amp; \ddots &amp;&amp; \vdots\\
0 &amp;&amp; \dots &amp; \alpha^{|t_{i1}-t_{i4}|}&amp;\alpha^{|t_{i1}-t_{i3}|} &amp; \alpha^{|t_{i1}-t_{i2}|} &amp; 1
\end{bmatrix}\]</span></p>
</section><section id="choices-choices" class="slide level2"><h2>Choices, choices</h2>
<p>With way more structures to choose from, it may be more difficult to make a decision than it was with non-longitudinal data</p>
<ul>
<li><p>Choice of model for covariance should be based on a <span class="alert">“maximal” model</span> for the mean that minimizes any potential misspecification</p></li>
<li><p>Maximal mean model should be in a certain sense the most elaborate model for the mean response that we would consider from a subject-matter point of view</p></li>
</ul>
<p>Once maximal model has been chosen, residual variation and covariation can be used to select appropriate model for covariance</p>
<ul>
<li>For nested covariance pattern models, a likelihood ratio test statistic can be constructed that compares “full” and “reduced” models</li>
</ul></section><section id="covariance-pattern-likelihood-ratio-test" class="slide level2"><h2>Covariance pattern likelihood ratio test</h2>
<p>For example, compound symmetry model is special case of the Toeplitz model with <span class="math display">\[\rho_1 = \rho_2 =\dots =\rho_{n-1}\]</span></p>
<p><span class="alert">Likelihood ratio test</span> is obtained by taking twice the difference in the respective maximized REML log-likelihoods, <span class="math display">\[G^2 = 2(\hat{l}_{full} - \hat{l}_{reduced})\]</span> and comparing statistic to a chi-squared distribution with degrees-of-freedom equal to difference between the number of covariance parameters in full and reduced models</p>
<ul>
<li>“Full” here would be the most complicated covariance structure, while reduced would be a simpler one</li>
</ul></section><section id="covariance-pattern-aic" class="slide level2"><h2>Covariance pattern AIC</h2>
<p>To compare non-nested model, an alternative approach is the Akaike Information Criterion (AIC)</p>
<ul>
<li>According to the AIC, given a set of competing models for the covariance, one should select the model that <span class="alert">minimizes</span>
</li>
</ul>
<p><span class="math display">\[AIC = -2(\text{maximized log-likelihood}) + 2(\text{number of parameters})\]</span></p>
<p>Note that models receive a pentality for having a larger number of parameters</p>
</section><section id="example-exercise-therapy-trial" class="slide level2"><h2>Example: Exercise Therapy Trial</h2>
<p>Subjects were assigned to one of two weightlifting programs to increase muscle strength</p>
<ul>
<li><p>Treatment 1: number of repetitions of the exercises was increased as subjects became stronger</p></li>
<li><p>Treatment 2: number of repetitions was held constant but amount of weight was increased as subjects became stronger</p></li>
</ul>
<p>Measurements of body strength were taken at baseline and on days 2, 4, 6, 8, 10, and 12</p>
<ul>
<li>We’ll focus only on measures of strength obtained at baseline (or day 0) and on days 4, 6, 8, and 12</li>
</ul></section><section id="example-exercise-therapy-trial-1" class="slide level2"><h2>Example: Exercise Therapy Trial</h2>
<p>What do we observe?</p>
<ul>
<li>Covariance matrix:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           day0     day4      day6     day8     day12
day0   9.866366 10.47857  9.154762 10.21747  9.441379
day4  10.478571 12.70714 11.072269 12.54451 11.227586
day6   9.154762 11.07227 10.478571 10.69318 10.357143
day8  10.217469 12.54451 10.693182 13.74332 12.317460
day12  9.441379 11.22759 10.357143 12.31746 13.613793</code></pre>
</div>
</div>
<ul>
<li>Correlation matrix:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  term   day0  day4  day6  day8 day12
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 day0  1     0.926 0.896 0.865 0.821
2 day4  0.926 1     0.959 0.953 0.904
3 day6  0.896 0.959 1     0.957 0.905
4 day8  0.865 0.953 0.957 1     0.944
5 day12 0.821 0.904 0.905 0.944 1    </code></pre>
</div>
</div>
</section><section id="example-exercise-therapy-trial-2" class="slide level2"><h2>Example: Exercise Therapy Trial</h2>
<p>Let’s compare what model fit would look like using an unstructured, autoregressive, and exponential covariance model for the mean model:</p>
<p><span class="math display">\[E[\text{body strength}_{ij}] = \beta_0 + \beta_1(\text{Program}_i) + \beta_2(\text{Time}_{ij}) + \beta_3(\text{Program}_i \times \text{Time}_{ij})\]</span></p>
<p><img data-src="compare-covar.png" style="width:55.0%"></p>
<ul>
<li><p>There is a hierarchy among the models: autoregressive and exponential are both nested within unstructured</p></li>
<li><p>The autoregressive and exponential models are not nested but have the same number of parameters</p></li>
</ul></section><section id="example-exercise-therapy-trial-3" class="slide level2"><h2>Example: Exercise Therapy Trial</h2>
<p>LRT comparing autoregressive vs unstructured covariance:</p>
<p><img data-src="autoreg.png" style="width:55.0%"></p>
<ul>
<li>There is evidence that the autoregressive model does not provide an adequate fit to the covariance</li>
</ul></section><section id="example-exercise-therapy-trial-4" class="slide level2"><h2>Example: Exercise Therapy Trial</h2>
<p>LRT comparing exponential vs unstructured covariance:</p>
<p><img data-src="exponential.png" style="width:65.0%"></p>
<ul>
<li><p>Exponential covariance provides an adequate fit to the data</p></li>
<li><p>Also, in terms of AIC, the exponential model minimizes this criterion</p></li>
</ul>
<p><img data-src="compare-covar.png" style="width:55.0%"></p>
<p><img src="POPUHEALSMPH_color-flush.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="slides-7_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="slides-7_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="slides-7_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="slides-7_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="slides-7_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="slides-7_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="slides-7_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="slides-7_files/libs/revealjs/plugin/notes/notes.js"></script><script src="slides-7_files/libs/revealjs/plugin/search/search.js"></script><script src="slides-7_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="slides-7_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>